{
  "hash": "e1b0f0833d69e423d40d2831c27e1a8b",
  "result": {
    "markdown": "::: {.content-hidden unless-format=\"html\"}\n$$\n\\newcommand{\\tr}{\\mathrm{tr}}\n\\newcommand{\\rank}{\\mathrm{rank}}\n\\newcommand{\\plim}{\\operatornamewithlimits{plim}}\n\\newcommand{\\diag}{\\mathrm{diag}}\n\\newcommand{\\bm}[1]{\\boldsymbol{\\mathbf{#1}}}\n\\newcommand{\\Var}{\\mathrm{Var}}\n\\newcommand{\\Exp}{\\mathrm{E}}\n\\newcommand{\\Cov}{\\mathrm{Cov}}\n\\newcommand\\given[1][]{\\:#1\\vert\\:}\n\\newcommand{\\irow}[1]{%\n\\begin{pmatrix}#1\\end{pmatrix}\n}\n$$\n:::\n\n# Comparing and Selecting Models \n\n### Required packages {.unnumbered}\n\n\n\n::: {.cell hash='08_comparison_cache/pdf/unnamed-chunk-1_12cafead711c7dd7bfdd9ffba88c0bbc'}\n\n```{.r .cell-code}\npkgs <- c(\"sf\", \"mapview\", \"spdep\", \"spatialreg\", \"tmap\", \"viridisLite\") # note: load spdep first, then spatialreg\nlapply(pkgs, require, character.only = TRUE)\n```\n:::\n\n\n\n### Session info {.unnumbered}\n\n\n\n::: {.cell hash='08_comparison_cache/pdf/unnamed-chunk-2_094fe0409cf5b0fd78db24133cd11d12'}\n\n```{.r .cell-code}\nsessionInfo()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nR version 4.4.1 (2024-06-14 ucrt)\nPlatform: x86_64-w64-mingw32/x64\nRunning under: Windows 11 x64 (build 22631)\n\nMatrix products: default\n\n\nlocale:\n[1] LC_COLLATE=English_United Kingdom.utf8 \n[2] LC_CTYPE=English_United Kingdom.utf8   \n[3] LC_MONETARY=English_United Kingdom.utf8\n[4] LC_NUMERIC=C                           \n[5] LC_TIME=English_United Kingdom.utf8    \n\ntime zone: Europe/Berlin\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n[1] viridisLite_0.4.2 tmap_3.3-4        spatialreg_1.3-4  Matrix_1.7-0     \n[5] spdep_1.3-5       spData_2.3.1      mapview_2.11.2    sf_1.0-16        \n\nloaded via a namespace (and not attached):\n [1] xfun_0.45          raster_3.6-26      htmlwidgets_1.6.4  lattice_0.22-6    \n [5] tools_4.4.1        crosstalk_1.2.1    LearnBayes_2.15.1  parallel_4.4.1    \n [9] stats4_4.4.1       sandwich_3.1-0     proxy_0.4-27       KernSmooth_2.23-24\n[13] satellite_1.0.5    RColorBrewer_1.1-3 leaflet_2.2.2      lifecycle_1.0.4   \n[17] compiler_4.4.1     deldir_2.0-4       munsell_0.5.1      terra_1.7-78      \n[21] codetools_0.2-20   leafsync_0.1.0     stars_0.6-5        htmltools_0.5.8.1 \n[25] class_7.3-22       MASS_7.3-60.2      classInt_0.4-10    lwgeom_0.2-14     \n[29] wk_0.9.1           abind_1.4-5        boot_1.3-30        multcomp_1.4-25   \n[33] nlme_3.1-164       digest_0.6.35      mvtnorm_1.2-5      splines_4.4.1     \n[37] fastmap_1.2.0      grid_4.4.1         colorspace_2.1-0   cli_3.6.2         \n[41] magrittr_2.0.3     base64enc_0.1-3    dichromat_2.0-0.1  XML_3.99-0.16.1   \n[45] survival_3.6-4     leafem_0.2.3       TH.data_1.1-2      e1071_1.7-14      \n[49] scales_1.3.0       sp_2.1-4           rmarkdown_2.27     zoo_1.8-12        \n[53] png_0.1-8          coda_0.19-4.1      evaluate_0.24.0    knitr_1.47        \n[57] tmaptools_3.1-1    s2_1.1.6           rlang_1.1.4        Rcpp_1.0.12       \n[61] glue_1.7.0         DBI_1.2.3          rstudioapi_0.16.0  jsonlite_1.8.8    \n[65] R6_2.5.1           units_0.8-5       \n```\n:::\n:::\n\n\n\n### Reload data from pervious session {.unnumbered}\n\n\n\n::: {.cell hash='08_comparison_cache/pdf/unnamed-chunk-3_5fa4928fed7b8f800ac61d6c8f357652'}\n\n```{.r .cell-code}\nload(\"_data/msoa2_spatial.RData\")\n```\n:::\n\n\n\nAs we have seen, a variety of spatial model specifications exist that can be used to account for the spatial structure of the data. Thus, selecting the correct model specification remains a crucial task in applied research. For some helpful literature on the issue of model selection see @Anselin.2024, @HalleckVega.2015, @Ruttenauer.2022a\n\nOne way of selecting the model specification is the application of empirical specification tests. In general, there are two different strategies: a specific-to-general or a general-to-specific approach [@Florax.2003; @Mur.2009].\n\n## Specific-to-general\n\nThe specific-to-general approach is more common in spatial econometrics. This approach starts with the most basic non-spatial model and tests for possible misspecification due to omitted autocorrelation in the error term or the dependent variable.\n\n@Anselin.1996 proposed to use Lagrange multiplier (LM) tests for the hypotheses $H_0$: $\\lambda=0$ and $H_0$: $\\rho=0$, which are robust against the alternative source of spatial dependence.\n\n### Lagrange Multiplier Test\n\nWe have earlier talked about methods to detect auto-correlation -- visualisation and Moran's I. Both methods can tell us that there is spatial autocorrelation. However, both method do not provide any information on why there is autocorrelation. Possible reasons:\n\n-  Interdependence ($\\rho$)\n-  Clustering on unobservables ($\\lambda$)\n-  Spillovers in covariates ($\\bm \\theta$)\n\t\t\nLagrange Multiplier test [@Anselin.1996]:\n\n- (Robust) test for spatial lag dependence $LM_\\rho^*$\n\n- (Robust) test for spatial error dependence $LM_\\lambda^*$\n\t\t\nRobust test for lag dependence: $H_0$: $\\rho=0$ \n$$\n\t\tLM_\\rho^* = G^{-1} \\hat{\\sigma}_\\epsilon^2\n\t\t\\big(\\frac{ \\hat{\\bm\\epsilon}^\\intercal \\bm{Wy}}{\\hat{\\sigma}_\\epsilon^2}\n\t\t- \\frac{\\hat{\\bm \\epsilon}^\\intercal \\bm{W\\hat{\\epsilon}}}{\\hat{\\sigma}_\\epsilon^2} \\big)^2 \\sim \\chi^2 \n$$\n\t\t\t<!-- %\\\\ \\text{where } G = (\\bm{WX\\hat{\\beta}})^\\intercal (\\bm I - \\bm X (\\bm X^\\intercal\\bm X)^{-1} \\bm X^\\intercal) (\\bm{WX\\hat{\\beta}}) -->\n\nRobust test for error dependence: $H_0$: $\\lambda=0$ \n\n$$\n\t\tLM_\\lambda^* = \\frac{\n\t\t\\big( \\hat{\\bm\\epsilon}^\\intercal \\bm{W\\hat{\\epsilon}} / \\hat{\\sigma}_\\epsilon^2\t\t\n\t\t- [T\\hat{\\sigma}_\\epsilon^2(G + T\\hat{\\sigma}_\\epsilon^2)^{-1}]\n\t\t \\hat{\\bm\\epsilon}^\\intercal \\bm{Wy} / \\hat{\\sigma}_\\epsilon^2 \\big)^2\n\t\t}{\n\t\tT[1 - \\frac{\\hat{\\sigma}_\\epsilon^2}{G + \\hat{\\sigma}_\\epsilon^2}]\n\t\t} \\sim \\chi^2\n$$\nwith\n$$\n\\begin{split}\n\t G &= (\\bm{WX\\hat{\\beta}})^\\intercal (\\bm I - \\bm X (\\bm X^\\intercal\\bm X)^{-1} \\bm X^\\intercal) (\\bm{WX\\hat{\\beta}})   \\\\\n\t T &= \\tr[(\\bm W^\\intercal + \\bm W)\\bm W], \n\\end{split}\t\t\n$$\nwhere $\\tr(\\bm A)$ is the sum of the main diagonal of any square matrix $\\bm A$.\n\nTo perform the test, we first need to run a conventional OLS model. We take yesterdays example.\n\n\n\n::: {.cell hash='08_comparison_cache/pdf/unnamed-chunk-4_70ca0187f7a71297d118c83f12d58579'}\n\n```{.r .cell-code}\n### Load data\n\nload(\"_data/msoa2_spatial.RData\")\n\n### Generate weights\ncoords <- st_centroid(msoa.spdf)\n\n# Neighbours within 3km distance\ndist_15.nb <- dnearneigh(coords, d1 = 0, d2 = 2500)\n\nsummary(dist_15.nb)\n\n# There are some empty neighbour sets. Lets impute those with the nearest neighbour.\nk2.nb <- knearneigh(coords, k = 1)\n\n# Replace zero\nnolink_ids <- which(card(dist_15.nb) == 0)\ndist_15.nb[card(dist_15.nb) == 0] <- k2.nb$nn[nolink_ids, ]\n\nsummary(dist_15.nb)\n\n# listw object with row-normalization\ndist_15.lw <- nb2listw(dist_15.nb, style = \"W\")\n```\n:::\n\n::: {.cell hash='08_comparison_cache/pdf/unnamed-chunk-5_1840ce2770262a7f35f52483702b6854'}\n\n```{.r .cell-code}\nmod_1.lm <- lm(log(no2) ~ per_mixed + per_asian + per_black + per_other\n                      + per_nonUK_EU + per_nonEU  + log(POPDEN),  \n                      data = msoa.spdf)\nsummary(mod_1.lm)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = log(no2) ~ per_mixed + per_asian + per_black + per_other + \n    per_nonUK_EU + per_nonEU + log(POPDEN), data = msoa.spdf)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.46035 -0.09063 -0.01010  0.07484  0.90401 \n\nCoefficients:\n               Estimate Std. Error t value Pr(>|t|)    \n(Intercept)   2.5188244  0.0313089  80.451  < 2e-16 ***\nper_mixed     0.0050636  0.0044498   1.138   0.2554    \nper_asian     0.0006251  0.0003459   1.807   0.0711 .  \nper_black    -0.0009929  0.0007100  -1.398   0.1623    \nper_other     0.0141322  0.0022477   6.288 4.86e-10 ***\nper_nonUK_EU  0.0132176  0.0011520  11.473  < 2e-16 ***\nper_nonEU     0.0026836  0.0010643   2.522   0.0118 *  \nlog(POPDEN)   0.1391236  0.0079044  17.601  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.1373 on 975 degrees of freedom\nMultiple R-squared:  0.6162,\tAdjusted R-squared:  0.6134 \nF-statistic: 223.6 on 7 and 975 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\n\nSubsequently, we run the robust LM test for Lag dependence:\n\n\n\n::: {.cell hash='08_comparison_cache/pdf/unnamed-chunk-6_489d7375648bd6d31b924966db3575f2'}\n\n```{.r .cell-code}\ntest.lag <- lm.RStests(mod_1.lm, \n                       listw = dist_15.lw, \n                       test = \"adjRSlag\")\nsummary(test.lag)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\tRao's score (a.k.a Lagrange multiplier) diagnostics for spatial\n\tdependence\ndata:  \nmodel: lm(formula = log(no2) ~ per_mixed + per_asian + per_black +\nper_other + per_nonUK_EU + per_nonEU + log(POPDEN), data = msoa.spdf)\ntest weights: dist_15.lw\n \n         statistic parameter   p.value    \nadjRSlag    365.69         1 < 2.2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n\nFor the robust LM test on spatial error dependence, we run:\n\n\n\n::: {.cell hash='08_comparison_cache/pdf/unnamed-chunk-7_d5687369f4f9c83306f274ea9b87ff20'}\n\n```{.r .cell-code}\ntest.err <- lm.RStests(mod_1.lm, \n                       listw = dist_15.lw, \n                       test = \"adjRSerr\")\nsummary(test.err)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\tRao's score (a.k.a Lagrange multiplier) diagnostics for spatial\n\tdependence\ndata:  \nmodel: lm(formula = log(no2) ~ per_mixed + per_asian + per_black +\nper_other + per_nonUK_EU + per_nonEU + log(POPDEN), data = msoa.spdf)\ntest weights: dist_15.lw\n \n         statistic parameter   p.value    \nadjRSerr    324.32         1 < 2.2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n\nIn fact, you can compare them all at once:\n\n\n\n::: {.cell hash='08_comparison_cache/pdf/unnamed-chunk-8_7a1f120dd97f8d07a2c25ea8ffd64634'}\n\n```{.r .cell-code}\ntest.all <- lm.RStests(mod_1.lm, \n                       listw = dist_15.lw, \n                       test = \"all\")\nsummary(test.all)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\tRao's score (a.k.a Lagrange multiplier) diagnostics for spatial\n\tdependence\ndata:  \nmodel: lm(formula = log(no2) ~ per_mixed + per_asian + per_black +\nper_other + per_nonUK_EU + per_nonEU + log(POPDEN), data = msoa.spdf)\ntest weights: dist_15.lw\n \n         statistic parameter   p.value    \nRSerr      1850.70         1 < 2.2e-16 ***\nRSlag      1892.06         1 < 2.2e-16 ***\nadjRSerr    324.32         1 < 2.2e-16 ***\nadjRSlag    365.69         1 < 2.2e-16 ***\nSARMA      2216.38         2 < 2.2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n\n\nIn both cases, the LM test indicates the presence of significance lag dependence and significance error dependence. \n\n::: callout-warning\n### Take the LM test with a grain of salt\n\n**DO NOT** use the above results as a reason to say: \"well, there is Lag dependence and there is Error dependence. So, I will use a SAC-like specification\". This would usually be a bad choice, as the LM tests assume the absence od any SLX terms.\n:::\n\t\t\n### Problem\n\nThe specific-to-general approach based on the robust LM test offers a good performance in distinguishing between SAR, SEM, and non-spatial OLS [@Florax.2003]. \n\nStill, in their original paper, @Anselin.1996 already note the declining power of the robust LM$_\\lambda$ test for spatial error dependence with increasing autocorrelation in the dependent variable (indicating some uncertainty under a SAC-like DGP).\n\n@Mur.2009 demonstrate strong drawbacks of the specific-to-general approach under non-optimal conditions like heteroscedasticity or endogeneity.\n\nMoreover, the test disregard the presence of spatial dependence from local spillover effects ($\\theta$ is assumed to be zero), as resulting from an SLX-like process. @Cook.2020, for instance, show theoretically that an SLX-like dependence structure leads to the rejection of both hypotheses $H_0$: $\\lambda=0$ and $H_0$: $\\rho=0$, though no autocorrelation is present [@Elhorst.2017; @Ruttenauer.2022a].\n\n::: {.callout-tip}\n### Potential solution?\n\nIn a recent preprint, @Anselin.2024 proposed a two-step test approach (\"STGE-Pre\"). First, we need to test the presence of any SLX ($\\bm W \\bm X$) term. If we can omit those terms, we proceed with the robust LM lag test and the robust LM error test.\n\n:::\n\n## General-to-specific approach\n\nThe general-to-specific approach depicts the opposite method of specification search. This approach starts with the most general model and stepwise imposes restrictions on the parameters of this general model. \n\n![@HalleckVega.2015: Nesting of different Spatial Econometric Model Specifications](fig/Vega.png)\n\nIn theory, we would \n\n1) start with a GNS specification and \n\n2) subsequently restrict the model to simplified specifications based on the significance of parameters in the GNS. \n\nThe problem with this strategy is that the GNS is only weakly identified and, thus, is of little help in selecting the correct restrictions [@Burridge.2016]. \n\nThe most intuitive alternative would be to start with one of the two-source models SDM, SDEM, or SAC. This, however, bears the risk of imposing the wrong restriction in the first place [@Cook.2020]. Furthermore, @Cook.2020 show that more complicated restrictions are necessary to derive all single-source models from SDEM or SAC specifications. @Anselin.2024 argue that the Ge\n\n## General advice?\n\n@LeSage.2009, @LeSage.2014, @Elhorst.2014 argue that there are strong analytical reasons to restrict the model specifications to a subset, as the SDM subsumes the SLX and SAR model, and the SDEM subsumes SLX and SEM. \n\nIt is easily observed that SDM reduces to SLX if $\\rho=0$ and to SAR if ${\\bm \\theta}=0$, while the SDEM reduces to SLX if $\\lambda=0$ and to SEM if ${\\bm \\theta}=0$. Less intuitively, [@Anselin.1988] has also shown that the SDM subsumes the SEM. Therefore, we can express the reduced form and rearrange terms:\n\n$$\n\\begin{split}\n{\\bm y}&= {\\bm X}{\\bm \\beta} + ({\\bm I_N}-\\lambda {\\bm W})^{-1}{\\bm \\varepsilon} \\\\\n({\\bm I_N}-\\lambda {\\bm W}){\\bm y}&= ({\\bm I_N}-\\lambda {\\bm W}){\\bm X}{\\bm \\beta} + {\\bm \\varepsilon} \\\\\n({\\bm I_N}-\\lambda {\\bm W}){\\bm y}&={\\bm X}{\\bm \\beta} -\\lambda{\\bm W}{\\bm X}{\\bm \\beta} + {\\bm \\varepsilon} \\\\\n{\\bm y}&=({\\bm I_N}-\\lambda {\\bm W})^{-1}({\\bm X}{\\bm \\beta} + {\\bm W}{\\bm X}{\\bm \\theta} + {\\bm \\varepsilon}). \n\\end{split}\n$$\n\nThus, the SEM constitutes a special case of an SDM with the relative simple restriction ${\\bm \\theta}=-\\lambda{\\bm \\beta}$, meaning direct and indirect effects are constrained to a common factor [@Anselin.1988; @Anselin.2003]. \n\nThe fact that SDM subsumes SAR, SLX, and SEM leads to the conclusion that applied research should only consider SDM and SDEM as model specifications [@LeSage.2014]. Especially in the case of a likely omitted variable bias, [@LeSage.2009, p.~68] argue in favour of using the SDM.\n\nNonetheless, others propose to use the SLX specification as point of departure [@Gibbons.2012; @HalleckVega.2015]. First, scholars have argued that SAC and SDM models are only weakly identified in practice [@Gibbons.2012; @Pinkse.2010]. Second, the global spillover specification in SAR, SAC, and SDM often seems to be theoretically implausible.\n\nAnd finally:  \n\n![\"I will use spatial lags of X, not spatial lags of Y\", J. [Wooldridge on twitter]( https://twitter.com/jmwooldridge/status/1369460526770753537)](fig/wooldridge_tweet.png)\n\n## Design and Theory\n\nSome argue that the best way of choosing the appropriate model specification is to exclude one or more sources of spatial dependence -- autocorrelation in the dependent variable, autocorrelation in the disturbances, or spatial spillover effects of the covariates -- by design [@Gibbons.2012, @Gibbons.2015]. \n\n**Natural experiments** are probably the best way of making one or more sources of spatial dependence unlikely, thereby restricting the model alternatives to a subset of all available models. However, the opportunities to use natural experiments are restricted in social sciences, making it a favourable but often impractical way of model selection.\n\n@Cook.2020 and @Ruttenauer.2022a argue that theoretical considerations should guide the model selection.\n\n1) Rule out some sources of spatial dependence by theory, and thus restrict the specifications to a subset ( _Where does the spatial dependence come from?_ ),\n  \n2) Theoretical mechanisms may guide the choice of either global or local spillover effects.\n\n\n## Monte Carlo simulation\n\nThis section discusses results from @Ruttenauer.2022a. The aim: how do different spatial models perform under different scenarios?\n\nThe DGP of the Monte Carlo simulation follows a GNS, where ${\\bm \\upsilon}_k$ and ${\\bm \\varepsilon}$ are independent and randomly distributed $\\mathcal{N}(0,\\sigma^{2}_\\upsilon)$ and $\\mathcal{N}(0,\\sigma^{2}_\\varepsilon)$ with a mean of zero, and ${\\bm x}_k$ is the $k$th column-vector of ${\\bm X}$ for $k=1,...,K$ covariates ($K$ is fixed at $2$ in the simulations). The parameter $\\rho$ represents the autocorrelation in the dependent variable, $\\lambda$ the autocorrelation in the disturbances, and $\\delta_k$ the autocorrelation in covariate $k$.\n\n$$\n\\begin{split}\n{\\bm y}&=\\rho{\\bm W}{\\bm y}+{\\bm X}{\\bm \\beta}+{\\bm W}{\\bm X}{\\bm \\theta}+ {\\bm u},\\\\ \n{\\bm u}&=\\lambda{\\bm W}{\\bm u}+{\\bm X}{\\bm\\gamma}+{\\bm \\varepsilon},\\\\\n{\\bm x}_k&=\\delta_k{\\bm W}{\\bm x}_k+{\\bm \\upsilon}_k.\n\\end{split}\n$$\nThe parameter-vector ${\\bm \\gamma}$ specifies the correlation between ${\\bm x}$ and the disturbance vector ${\\bm u}$, thereby defining the strength of an omitted variable bias. In reduced form, this DGP can be written as\n$$\n\\begin{split}\n{\\bm y}=&({\\bm I_N}-\\rho {\\bm W})^{-1}\\big[({\\bm I_N}-\\delta_k {\\bm W})^{-1}{\\bm \\upsilon_k}\\beta_k \\\\\n&+{\\bm W}({\\bm I_N}-\\delta_k {\\bm W})^{-1}{\\bm \\upsilon_k}\\theta_k \\\\\n&+({\\bm I_N}-\\lambda {\\bm W})^{-1}(({\\bm I_N}-\\delta_k {\\bm W})^{-1}{\\bm \\upsilon_k}\\gamma_k+{\\bm \\varepsilon})\\big].\n\\end{split}\n$$\n\nThe parameter vector ${\\bm \\beta}$ was fixed at ${\\bm \\beta}=\\irow{0.2&0.5}^\\intercal$, and the noise parameters were fixed at $\\sigma^{2}_\\upsilon$, $\\sigma^{2}_\\varepsilon=1$ for all trials. All other parameters vary between the following two options for each parameter (vector):\n\n- $\\rho \\in \\left\\{ 0, 0.5\\right\\}$,\n- $\\lambda \\in \\{0, 0.5\\}$,\n- ${\\bm \\delta} \\in \\left\\{ \\irow{0&0}^\\intercal, \\irow{0.4&0.7}^\\intercal\\right\\}$,\n- ${\\bm \\theta} \\in \\left\\{\\irow{0&0}^\\intercal, \\irow{0.1&0.8}^\\intercal\\right\\}$,\n- ${\\bm \\gamma} \\in \\left\\{\\irow{0&0}^\\intercal, \\irow{0.3&0}^\\intercal\\right\\}$,\n\nleading to a total of 32 distinct combinations. Note that this selection of parameters intentionally violates the common ratio assumption between direct and indirect effects, as this should be a more common case in practical research. All combinations were simulated in 1000 trials, with the same starting seed for each combination. If youre, interested in the simulations, see [replication code on Github](https://github.com/ruettenauer/Reproduction-Material-Spatial-Monte-Carlo-Experiments).\n\n\n### Without omitted variable bias\n\n![Bias of impacts and 95\\% confidence interval of empirical standard deviation without omv: ${\\bm \\beta}=(0.2, 0.5)^\\intercal$, ${\\bm \\gamma}=(0, 0)^\\intercal$. $\\rho=$ autocorrelation in the dependent variable ($\\bm W \\bm y$); $\\bm \\delta=$ autocorrelation in the covariates ($\\bm x_k = f(\\bm W \\bm  x_k)$); $\\lambda=$ autocorrelation in the disturbances ($\\bm W \\bm u$); $\\bm \\theta=$ spatial spillover effects of covariates ($\\bm W \\bm X$); $\\bm\\gamma=$ strength of omv.](fig/sim4_combined_1.png)\n\nSLX, SDM, and SDEM all provide quite accurate estimates of the direct impacts (most visible in column 2). SAR, SEM, and SAC, in contrast, yield some drawbacks: especially in the presence of local spillover effects, these three specifications are biased (see lower part). Furthermore, SAR and SEM suffer from bias if autocorrelation in the disturbance and autocorrelation in the dependent variable are present simultaneously (see line 6 and 8). Though SLX is downwardly biased in case of autocorrelation in the dependent variable and the covariates (e.g. line 12 and 16), and SDM as well as SDEM yield some bias in case of a GNS-like process (line 14 and 16), those biases are rather moderate. This indicates that SLX, SDM, and SDEM are most robust against misspecification regarding the direct impacts.\n\nSeveral differences exist regarding the indirect impacts. Most obviously, the often used SAR specification suffers from considerable bias: it overestimates indirect impacts in case of autocorrelation in the disturbances, and offers biased estimates if local spillover effects exist (which are not restricted to a common ratio). The latter also applies to SAC: though SAC offers relatively accurate estimates for ${\\bm x}_2$, it overestimates indirect impacts for ${\\bm x}_1$. \n\nRegarding the remaining three specifications -- SLX, SDM, and SDEM -- conclusions are less obvious. SDM and SDEM suffer from large bias for high values of ${\\bm \\theta}$ (see $\\bm{x}_2$) if the DGP follows a GNS-like process (line 14 and 16): SDM overestimates the indirect impacts, while SDEM underestimates the indirect impacts. In addition, SDM performs badly if the true DGP is SDEM (line 13), and SDEM performs badly if the true DGP is SDM (line 10), whereas the bias increases with higher values of $\\theta_k$ in both cases. Similar to SDEM, SLX underestimates the indirect impacts in presence of global spillovers / autocorrelation in the dependent variable.\n\n### With omitted variable bias\n\n![Bias of impacts and 95\\% confidence interval of empirical standard deviation with omv: ${\\bm \\beta}=(0.2, 0.5)^\\intercal$, ${\\bm \\gamma}=(0.3, 0)^\\intercal$. $\\rho=$ autocorrelation in the dependent variable ($\\bm W \\bm y$); $\\bm \\delta=$ autocorrelation in the covariates ($\\bm x_k = f(\\bm W \\bm  x_k)$); $\\lambda=$ autocorrelation in the disturbances ($\\bm W \\bm u$); $\\bm \\theta=$ spatial spillover effects of covariates ($\\bm W \\bm X$); $\\bm\\gamma=$ strength of omv.](fig/sim4_combined_2.png)\n\n\n### Indirect impacts if DGP = GNS\n\nBelow an illustration about the indirect impacts, if the spatial process is a combination of\n\n1) Clustering on Unobservables\n\n2) Interdependence (in the outcome)\n\n3) Spillovers in Covariates\n\n![Bias of indirect impacts and 95\\% confidence interval of empirical standard deviation for different strengths of autocorrelation: ${\\bm \\beta}=(0.2, 0.5)^\\intercal$, ${\\bm \\gamma}=(0, 0)^\\intercal$, ${\\bm\\delta}=(0, 0)^\\intercal$, ${\\bm\\theta}=(0.1, 0.8)^\\intercal$. $\\rho=$ autocorrelation in the dependent variable ($\\bm W \\bm y$); $\\bm \\delta=$ autocorrelation in the covariates ($\\bm x_k = f(\\bm W \\bm  x_k)$); $\\lambda=$ autocorrelation in the disturbances ($\\bm W \\bm u$); $\\bm \\theta=$ spatial spillover effects of covariates ($\\bm W \\bm X$); $\\bm\\gamma=$ strength of omv.](fig/sim11_combined_1.png)\n\n\nFirst, in a GNS-like situation, the bias in SDM grows with increasing autocorrelation in ${\\bm y}$ ($\\rho$) and increasing autocorrelation in the disturbances ($\\lambda$). \n\nSecond, the bias in SLX and SDEM increases with higher values of $\\rho$, but is unaffected from the strength of $\\lambda$. \n\nThird, though SLX and SDEM suffer from the same problem, the bias from omitting global autocorrelation is less severe in SLX than in SDEM. \n\nThus, the SLX outperforms SDEM. Furthermore, SLX outperforms SDM in most situations; only if the autocorrelation in the dependent variable is much stronger than the autocorrelation in the disturbances ($\\rho=0.9$, $\\lambda=0.3$), SDM yields lower bias than SLX. Note that the SAC yields relatively low biases for the indirect impacts in GNS-like processes, but at the same time produces relative large biases in the direct impacts.\n\n\n\n## Example: House prices in London\n\nThe example is taken from @Ruttenauer.2024b.\n\nAs an example to compare the different spatial model specifications, we estimate the effect of local characteristics such as green space and public transport connectivity on the median house price. The relation between environmental characteristics and housing choice and prices has been investigated in several studies [@Anselin.2008; @Kley.2021; @Liebe.2023]. The data for the current example was retrieved from the London Datastore[^03_article-4], the 2011 Census[^03_article-5] and OpenStreetMaps and combined at the Middle Layer Super Output Areas (MSOA). There are 983 MSOAs in London with an average population size of around 8,000 residents. The script for compiling and preparing the data can be found in the Supplementary Materials. All data preparation and analysis were performed with the statistical software R. For a comprehensive overview of spatial software see @Bivand.2021 or @Pebesma.2023.\n\n[^03_article-4]: For house prices, see: <https://data.london.gov.uk/dataset/average-house-prices>. For London accessibility scores see: <https://data.london.gov.uk/dataset/public-transport-accessibility-levels>\n\n[^03_article-5]: For UK demographics, see: <https://www.nomisweb.co.uk/sources/census_2011>\n\n\n\n::: {.cell hash='08_comparison_cache/pdf/unnamed-chunk-9_f81874e7a25cf4245f8cc750c9e00dfa'}\n\n```{.r .cell-code}\n# Load the packages\npkgs <- c(\"sf\", \"mapview\", \"spdep\", \"spatialreg\", \"texreg\", \"extrafont\",\n          \"ggplot2\", \"ggthemes\", \"rmapshaper\", \"viridis\", \"gridExtra\") # note: load spdep first, then spatialreg\nlapply(pkgs, require, character.only = TRUE)\n\n# Load the data\nload(\"_data/msoa3_spatial.RData\")\n\nloadfonts()\n\n# Create Contiguity (Queens) neighbours weights\nqueens.nb <- poly2nb(msoa.spdf, \n                     queen = TRUE, \n                     snap = 1) # we consider points in 1m distance as 'touching'\nqueens.lw <- nb2listw(queens.nb,\n                      style = \"W\")\n```\n:::\n\n::: {.cell hash='08_comparison_cache/pdf/unnamed-chunk-10_c90a05cf204dafbb5f0c2fbd093df3cb'}\n\n```{.r .cell-code}\n### Plot house prices\n\n# Get some larger scale boundaries\nborough.spdf <- st_read(dsn = paste0(\"_data\", \"/statistical-gis-boundaries-london/ESRI\"),\n                     layer = \"London_Borough_Excluding_MHW\" # Note: no file ending\n                     )\n# transform to only inner lines\nborough_inner <- rmapshaper::ms_innerlines(borough.spdf)\nborough_inner <- borough.spdf\n\n\n# Plot with inner lines\nmsoa.spdf$med_house_price_ln <- log(msoa.spdf$med_house_price)\nmsoa.spdf$pt_access_index_ln <- log(msoa.spdf$pt_access_index)\n\ngp <- ggplot(msoa.spdf)+\n  geom_sf(aes(fill = med_house_price_ln))+\n  scale_fill_viridis_c(option = \"A\")+\n  geom_sf(data = borough_inner, color = \"gray92\", fill = NA)+\n  coord_sf(datum = NA)+\n  theme_map()+\n  labs(fill = \"log price\")+\n  theme(plot.title = element_text(hjust = 0.5))+\n  ggtitle(\"Median house price\")\n\ngp2 <- ggplot(msoa.spdf)+\n  geom_sf(aes(fill = pt_access_index_ln))+\n  scale_fill_viridis_c(option = \"D\")+\n  geom_sf(data = borough_inner, color = \"gray92\", fill = NA)+\n  coord_sf(datum = NA)+\n  theme_map()+\n  labs(fill = \"log index\")+\n  theme(plot.title = element_text(hjust = 0.5))+\n  ggtitle(\"Public transport access\")\n```\n:::\n\n::: {.cell hash='08_comparison_cache/pdf/unnamed-chunk-11_2bad7cbb0950444bd6f9636ad72983f9'}\n\n```{.r .cell-code}\ncairo_ps(file = paste(\"fig/\", \"Maps.eps\", sep=\"\"), width = 10, height = 4, \n          bg = \"white\", family = \"Times New Roman\")\npar(mar = c(0, 0, 0, 0))\npar(mfrow = c(1, 1), oma = c(0, 0, 0, 0))\ngrid.arrange(gp, gp2, ncol = 2)\ndev.off()\n\njpeg(file = paste(\"fig/\", \"Maps.jpeg\", sep=\"\"), width = 10, height = 4, \n    units = \"in\", res = 300, type = \"cairo\",\n          bg = \"white\", family = \"Times New Roman\")\npar(mar = c(0, 0, 0, 0))\npar(mfrow = c(1, 1), oma = c(0, 0, 0, 0))\ngrid.arrange(gp, gp2, ncol = 2)\ndev.off()\n```\n:::\n\n\n\n![Spatial distribution of log-transformed median house prices and transport accessibility across London.](fig/Maps.jpeg){#fig-map}\n\n\nFigure @fig-map shows an unclassified choropleth map of house prices and public transport access across London, both log-scaled for mapping. As we would expect, both indicators follow a relatively strong spatial of positive autocorrelation: house prices first decrease with increasing distance to the centre, and then seem to increase again in suburban areas. Moreover, there seems to be a pattern of higher prices towards the west and particularly high prices around Hyde Park. Public transport accessibility steadily decreases with distance to the city centre. Spatial regression models thus seem to be important here for two reasons: a) observations are not independent of each other but follow clear spatial patterns, and b) surrounding / adjacent urban characteristics likely play a role for housing demand and prices in the focal unit as well.\n\nIn Table 1, we regress the median house price in 2011 on the area (in km\\^2) covered by green space according to OpenStreetMaps, an index of public transport access (ranging from 0-low accessibility to 100-high accessibility), and several population characteristics from the 2011 census such as population density, the percent of non-UK residents and the percent of social housing. Reported are results form (1) non-spatial OLS, (2) Spatial Autoregressive (SAR), (3) Spatial Error Model (SEM), (4) Spatial Lag of X (SLX), (5) Spatial Durbin Model (SDM), (6) and Spatial Durbin Error Model (SDEM). All variables were standardized before estimation, and we thus interpret coefficients in standard deviations. Note that we do not estimate results for Spatial Autoregressive Combined (SAC) models because of its severe drawbacks for applied research [@LeSage.2014].\n\n\n\n::: {.cell hash='08_comparison_cache/pdf/unnamed-chunk-12_5376127bb731c1a604c8039e7d9dd703'}\n\n```{.r .cell-code}\n# Specifcy variables and formula\nfm <- med_house_price ~ park_kmsq + pt_access_index + POPDEN + per_nonUK + per_social\n\n# Standardize variables\nvars <- all.vars(fm)\nmsoa_sd.spdf <- msoa.spdf\nfor(v in vars){\n  msoa_sd.spdf[, v] <- as.numeric(scale(msoa_sd.spdf[, v, drop = TRUE]))\n}\n```\n:::\n\n::: {.cell hash='08_comparison_cache/pdf/unnamed-chunk-13_e9011b5bb45f7fe5c1deebdd234040e8'}\n\n```{.r .cell-code}\n# Estimate the models\nmod_1.ols <- lm(fm, data = msoa_sd.spdf)\n\n# Spatial autoregressive model\nmod_1.sar <- lagsarlm(fm,  \n                      data = msoa_sd.spdf, \n                      listw = queens.lw,\n                      Durbin = FALSE) # we could here extend to SDM\n\n# Spatial error model\nmod_1.sem <- errorsarlm(fm,  \n                        data = msoa_sd.spdf, \n                        listw = queens.lw,\n                        Durbin = FALSE) # we could here extend to SDEM\n\n# SLX\nmod_1.slx <- lmSLX(fm,  \n                   data = msoa_sd.spdf, \n                   listw = queens.lw, \n                   Durbin = TRUE) # use a formula to lag only specific covariates\n\n# Spatial Durbin\nmod_1.sdm <- lagsarlm(fm,  \n                      data = msoa_sd.spdf, \n                      listw = queens.lw,\n                      Durbin = TRUE) # we could here extend to SDM\n\n# Spatial Durbun Error\nmod_1.sdem <- errorsarlm(fm,  \n                        data = msoa_sd.spdf, \n                        listw = queens.lw,\n                        Durbin = TRUE) # we could here extend to SDEM\n\n\n### Coefficient Output\n# Get AIC and N for all models to get common gof stats\naic.l <- sapply(list(mod_1.ols, mod_1.sar, mod_1.sem, mod_1.slx, mod_1.sdm, mod_1.sdem),\n       FUN = function(x) AIC(x))\n\nn.l <- sapply(list(mod_1.ols, mod_1.sar, mod_1.sem, mod_1.slx, mod_1.sdm, mod_1.sdem),\n       FUN = function(x) length(residuals(x)))\n\n# Create table\nmod_1.slx.lm <- mod_1.slx\nclass(mod_1.slx.lm) <- \"lm\" # only for gofs\n# screenreg(list(mod_1.ols, mod_1.sar, mod_1.sem, mod_1.slx.lm, mod_1.sdm, mod_1.sdem),\n#           custom.coef.map = list('(Intercept)' =  '(Intercept)',\n#                                  'park_kmsq' =  'Green space',\n#                                  'pt_access_index' =  'Public transport access',\n#                                  'POPDEN' =  'Population density',\n#                                  'per_nonUK' =  '% non-UK',\n#                                  'per_social' = '% social housing',\n#                                  'lag.park_kmsq' =  'W Green space',\n#                                  'lag.pt_access_index' =  'W Public transport access',\n#                                  'lag.POPDEN' =  'W Population density',\n#                                  'lag.per_nonUK' =  'W % non-UK',\n#                                  'lag.per_social' = 'W % social housing',\n#                                  'rho' = 'rho',\n#                                  'lambda' = 'lambda'),\n#           custom.model.names = c(\"OLS\", \"SAR\", \"SEM\", \"SLX\", \"SDM\", \"SDEM\"),\n#           dcolumn = TRUE, caption.above = TRUE, digits = 3,\n#           caption = \"Spatial regression models. Outcome variable: median house price.\",\n#           include.nobs = FALSE,\n#   include.loglik = FALSE,\n#   include.aic = FALSE,\n#   include.lr = TRUE,\n#   include.wald = FALSE,\n#   include.fstatistic = FALSE,\n#   include.rmse = FALSE,\n#   custom.gof.rows = list('Num. obs.' = n.l, \n#                          'AIC' = aic.l), \n#   reorder.gof = c(1, 3:6, 2))\n```\n:::\n\n::: {.cell hash='08_comparison_cache/pdf/unnamed-chunk-14_1c132ab08e7f4c1c064db95605799739'}\n\n```{.r .cell-code}\nwordreg(list(mod_1.ols, mod_1.sar, mod_1.sem, mod_1.slx.lm, mod_1.sdm, mod_1.sdem),\n        file = \"fig/Regression.doc\",\n          custom.coef.map = list('(Intercept)' =  '(Intercept)',\n                                 'park_kmsq' =  'Green space',\n                                 'pt_access_index' =  'Public transport access',\n                                 'POPDEN' =  'Population density',\n                                 'per_nonUK' =  'Percent non-UK',\n                                 'per_social' = 'Percent social housing',\n                                 'lag.park_kmsq' =  'W Green space',\n                                 'lag.pt_access_index' =  'W Public transport access',\n                                 'lag.POPDEN' =  'W Population density',\n                                 'lag.per_nonUK' =  'W Percent non-UK',\n                                 'lag.per_social' = 'W Percent social housing',\n                                 'rho' = 'rho',\n                                 'lambda' = 'lambda'),\n          custom.model.names = c(\"OLS\", \"SAR\", \"SEM\", \"SLX\", \"SDM\", \"SDEM\"),\n          dcolumn = TRUE, caption.above = TRUE, digits = 3,\n          caption = \"Spatial regression models. Outcome variable: median house price.\",\n          include.nobs = FALSE,\n  include.loglik = FALSE,\n  include.aic = FALSE,\n  include.lr = TRUE,\n  include.wald = FALSE,\n  include.fstatistic = FALSE,\n  include.rmse = FALSE,\n  custom.gof.rows = list('Num. obs.' = n.l, \n                         'AIC' = aic.l), \n  reorder.gof = c(1, 3:6, 2))\n\ntexreg(list(mod_1.ols, mod_1.sar, mod_1.sem, mod_1.slx.lm, mod_1.sdm, mod_1.sdem),\n        file = \"fig/Regression.tex\",\n          custom.coef.map = list('(Intercept)' =  '(Intercept)',\n                                 'park_kmsq' =  'Green space',\n                                 'pt_access_index' =  'Public transport access',\n                                 'POPDEN' =  'Population density',\n                                 'per_nonUK' =  'Percent non-UK',\n                                 'per_social' = 'Percent social housing',\n                                 'lag.park_kmsq' =  'W Green space',\n                                 'lag.pt_access_index' =  'W Public transport access',\n                                 'lag.POPDEN' =  'W Population density',\n                                 'lag.per_nonUK' =  'W Percent non-UK',\n                                 'lag.per_social' = 'W Percent social housing',\n                                 'rho' = 'rho',\n                                 'lambda' = 'lambda'),\n          custom.model.names = c(\"OLS\", \"SAR\", \"SEM\", \"SLX\", \"SDM\", \"SDEM\"),\n          dcolumn = TRUE, caption.above = TRUE, digits = 3, use.packages = FALSE,\n          caption = \"Spatial regression models. Outcome variable: median house price.\",\n          include.nobs = FALSE, fontsize = \"scriptsize\",\n  include.loglik = FALSE,\n  include.aic = FALSE,\n  include.lr = TRUE,\n  include.wald = FALSE,\n  include.fstatistic = FALSE,\n  include.rmse = FALSE,\n  custom.gof.rows = list('Num. obs.' = n.l, \n                         'AIC' = aic.l), \n  reorder.gof = c(1, 3:6, 2))\n```\n:::\n\n```{=latex}\n\\input{fig/Regression.tex}\n```\n\n\n\nCompared to results from conventional non-spatial models, Table 1 comes with several additions: First, variables starting with a \"W\" (or \"lag\") indicate the spatially lagged variable or in the case of row-normalized weights matrices the average value of the respective variable across the local neighbours. Moreover, there are two auto-regressive parameters: \"rho\" for the estimated auto-correlation in the dependent variable and \"lambda\" for the estimated auto-correlation in the error term. In case of the SAR, a highly significant $\\hat\\rho$ coefficient of 0.786 indicates strong positive spatial auto-correlation in the median house price: the house price in adjacent areas positively impacts the focal house prices. A $\\hat\\lambda$ of 0.89 in the SEM however indicates that there is very strong spatial auto-correlation among the (remaining) error variance. The likelihood ratio test in the goodness-of-fit statistics are highly significant in both cases, rejecting the NULL of no spatial auto-autocorrelation.\n\nGiven the strong positive auto-correlation in the dependent variable in SAR and SDM, we cannot directly interpret the coefficients as marginal effects. Similar to auto-regressive temporal models, we need to account for the spatial multiplier effect. For SEM, SLX and SDEM, we could directly interpret the coefficients of Table 1. However, we plot the impacts of all five models in Figure @fig-coefs for reasons of comparison. Note that SEM only has direct and no indirect impacts.\n\n\n\n::: {.cell hash='08_comparison_cache/pdf/unnamed-chunk-15_0802a7ec1d115597895299271b0fe110'}\n\n```{.r .cell-code}\n# Get direct and indirect impacts\nmod.l <- list(mod_1.sar, mod_1.slx, mod_1.sdm, mod_1.sdem)\nimp.l <- vector(mode = \"list\", length = length(mod.l))\n\nfor(i in 1:length(mod.l)){\n  imp.l[[i]] <- spatialreg::impacts(mod.l[[i]], listw = queens.lw, R = 600)\n}\n\n# Add SEM\n\n\n# Extract summary measures\nextract.imp <- function(x){\n  s <- summary(x, zstats = TRUE, short = TRUE)\n  names <- attr(x, \"bnames\")\n  l <- length(names)\n  effs <- c(\"Direct\", \"Indirect\", \"Total\")\n  if(attr(x, \"type\") == \"lag\" | attr(x, \"type\") == \"mixed\"){\n    coefs = c(s$res$direct, s$res$indirect, s$res$total)\n  }else{\n    coefs = c(s$impacts$direct, s$impacts$indirect, s$impacts$total)\n  }\n  df <-  data.frame(var = rep(names, 3), \n                    eff = rep(effs, each = l),\n                    coef = coefs,\n                    se = c(s$semat[, 1], s$semat[, 2], s$semat[, 3]),\n                    pval = c(s$pzmat[, 1], s$pzmat[, 2], s$pzmat[, 3])\n  )\n}\n\nmods <- c(\"SAR\", \"SLX\", \"SDM\", \"SDEM\")\nfor(i in 1:length(imp.l)){\n  tmp <- extract.imp(imp.l[[i]])\n  tmp$mod <- mods[i]\n  if(i == 1){\n    imp.res <- tmp\n  }else{\n    imp.res <- rbind(imp.res, tmp)\n  }\n  \n} \n\n# Add SEM\nsem.coefs <- summary(mod_1.sem)$Coef[,-3]\ncolnames(sem.coefs) <- c(\"coef\", \"se\", \"pval\")\nsem.df <- data.frame(var = rownames(sem.coefs),\n                     eff = \"Direct\",\n                     sem.coefs,\n                     mod = \"SEM\")\n\nimp.res <- rbind(imp.res, sem.df[-1, ])\n```\n:::\n\n::: {.cell hash='08_comparison_cache/pdf/unnamed-chunk-16_4347e00d23386772bd4b433bc7e2c20d'}\n\n```{.r .cell-code}\n### Plot the effects\n\n# Coef Labels\nimp.res$lab <- as.character(sprintf(\"%.3f\", round(imp.res$coef, 3)))\n\n# # Add stars\n# imp.res$lab[imp.res$pval <= 0.1 & imp.res$pval > 0.05] <- paste0(imp.res$lab[imp.res$pval <= 0.1 & imp.res$pval > 0.05], expression(\"\\u2020\"))\n# imp.res$lab[imp.res$pval <= 0.05 & imp.res$pval > 0.01] <- paste0(imp.res$lab[imp.res$pval <= 0.05 & imp.res$pval > 0.01], \"*\")\n# imp.res$lab[imp.res$pval <= 0.01 & imp.res$pval > 0.001] <- paste0(imp.res$lab[imp.res$pval <= 0.01 & imp.res$pval > 0.001], \"**\")\n# imp.res$lab[imp.res$pval <= 0.001] <- paste0(imp.res$lab[imp.res$pval <= 0.001], \"***\")\n\n# # Get rid of leading zero\n# imp.res$lab <- gsub(\"0\\\\.\", \" \\\\.\", imp.res$lab)\n\n# Confidence intervals\ninterval2 <- -qnorm((1-0.95)/2)  # 95% multiplier\nimp.res$lb <- imp.res$coef - imp.res$se * interval2\nimp.res$ub <- imp.res$coef + imp.res$se * interval2\n\n# Rename variables\nnames <- list('park_kmsq' =  'Green space',\n               'pt_access_index' =  'Public transport access',\n               'POPDEN' =  'Population density',\n               'per_nonUK' =  'Percent non-UK',\n               'per_social' = 'Percent social housing')\n\nimp.res$var <- factor(imp.res$var, levels = rev(names(names)), labels = rev(names))\nimp.res$mod <- factor(imp.res$mod, levels = rev(c(\"SAR\", \"SEM\", \"SLX\", \"SDM\", \"SDEM\")))\n\n# Plot\nzp_all <- ggplot(imp.res[imp.res$eff != \"Total\", ], aes(colour = mod, shape = mod, fill = mod)) +\n  facet_grid(. ~ eff, scales = \"free_x\") +\n  geom_hline(yintercept = 0, colour = scales::alpha(\"black\", 0.3), lty = 2) +\n  geom_pointrange(aes(x = var, y = coef, ymin = lb, ymax = ub),\n                                   lwd = 0.7, position = position_dodge(width = 1/1.4),\n                                   fill = \"black\") +\n  geom_text(aes(label = lab,\n                x = var, \n                y = coef), \n            size = 3.0, show.legend  = FALSE, \n            vjust = -0.35, hjust = -0.035, position = position_dodge(width = 1/1.4)) +\n  coord_flip() + theme_bw() +\n  scale_x_discrete(expand = c(0.1,0.1) ) +\n  theme(legend.title = element_blank()) +\n  labs(y = \"Impacts on house price\", x = \"\") +\n  scale_shape_manual(values = rev(c(18, 19, 17, 15, 25))) +\n  scale_color_viridis_d() +\n  scale_fill_viridis_d() +\n  theme(text = element_text(size = 13),\n                         legend.position = \"bottom\",\n                         legend.background = element_blank(),\n                         legend.box.background = element_rect(colour = \"black\"),\n                         legend.key = element_blank(),\n                         axis.text.y = element_text(colour=\"black\", size = 13),\n                         axis.title.x = element_text(colour=\"black\"),\n                         axis.text.x = element_text(colour=\"black\"),\n                         strip.background = element_blank(),\n                         strip.text = element_text(size = 13, colour = \"black\"),\n) +\n  ggtitle(element_blank()) +\n  guides(colour = guide_legend(override.aes = list(linetype = 0), reverse = T),\n                          shape = guide_legend(reverse = T))\n```\n:::\n\n::: {.cell hash='08_comparison_cache/pdf/unnamed-chunk-17_0f34e549c1556421c135e747a08a8c74'}\n\n```{.r .cell-code}\ncairo_ps(file = paste(\"fig/\", \"Coefplot.eps\", sep=\"\"), width = 8, height = 6, \n          bg = \"white\", family = \"Times New Roman\")\npar(mar = c(0, 0, 0, 0))\npar(mfrow = c(1, 1), oma = c(0, 0, 0, 0))\nzp_all\ndev.off()\n\njpeg(file = paste(\"fig/\", \"Coefplot.jpeg\", sep=\"\"), width = 8, height = 6, \n    units = \"in\", res = 300, type = \"cairo\",\n          bg = \"white\", family = \"Times New Roman\")\npar(mar = c(0, 0, 0, 0))\npar(mfrow = c(1, 1), oma = c(0, 0, 0, 0))\nzp_all\ndev.off()\n```\n:::\n\n\n\n![Direct and indirect impacts from spatial regression models. Dependent variable: mean house prices. All vairables are standardised.](fig/Coefplot.jpeg){#fig-coefs}\n\nWe start with the results of the SAR model in Figure @fig-coefs. A one standard-deviation increase of green space in the focal unit is associated with a 0.161 standard deviation increase in house prices within the same spatial unit. However, there are also highly significant diffusion processes. This increase in green space in the focal unit will also increase house prices in neighbouring units and the neighbours of these neighbours. This indirect impact will add up to a 0.458 standard deviation increase in house prices across neighbouring units connected through the spatial weights system. Similarly, an increase in public transport accessibility is associated with a 0.118 standard-deviation higher median house price in the unit itself and an additional 0.458 deviation increase diffusing though the neighbouring regions. Note that direct and indirect effects are bound to a common ration, as SAR only estimates one single spatial parameter $\\hat\\rho$. In our case, every indirect impact equals approximately 2.83 times the direct impact. This is a very restrictive conditions and a severe drawback of the SAR model.\n\nThe SLX - similar to SAR - estimates a positive impact of green space in the focal but also in adjacent neighbourhoods on house prices in the focal unit. A one standard deviation in the focal unit is associated with 0.136 standard-deviations higher house price in the focal unit. If green spaces in adjacent neighbourhoods increase on average by one standard deviation, this would increase house prices in the focal unit by 0.249 standard deviations. Note that the SLX tells a different story about the effect of public transport access than SAR: there is a negative direct and a very strong and positive indirect effect. A one standard deviation increase in public transport access in the focal unit is associated with -0.152 standard deviations lower house prices. In contrast, more public transport in the local surrounding (the average neighbours) is associated with 0.696 standard deviations higher prices. This is in line with the idea that public transport facilities are usually not particularly attractive: it is good to have them close but not too close. The same is true for population density: it is good to live in a broader area with high population density as indicated by the indirect impacts (probability indicating high centrality), but the local neighbourhood should have a low population density as indicated by the negative direct impact.\n\nWe could go further with the other models. However, interpretation in SDM follows the same logic as SAR, and interpretation in SDEM aligns to SLX. Interpretation in SEM is analogous to non-spatial OLS, as there are no indirect impacts. Moreover, it is important to keep in mind that the indirect impacts are summary measures which sum over all impacts from or onto neighbouring regions. The indirect public transport effect of 0.696 in SLX would occur if the average public transport access across neighbours would increase by one standard deviation. This only occurs if all neighbours would simultaneously increase public transport access by one standard deviation.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {
      "knitr": [
        "{\"type\":\"list\",\"attributes\":{},\"value\":[]}"
      ]
    },
    "preserve": null,
    "postProcess": false
  }
}