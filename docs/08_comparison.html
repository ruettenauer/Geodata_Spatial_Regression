<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Geodata &amp; Spatial Regression - 12&nbsp; Comparing and Selecting Models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./08_exercise3b.html" rel="next">
<link href="./08_exercise3.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./08_comparison.html"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Comparing and Selecting Models</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Geodata &amp; Spatial Regression</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/ruettenauer/Geodata_Spatial_Regression/" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_refresher.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Refresher</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_spatial-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data Manipulation &amp; Visualization</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_exercise1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Exercises I</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_weights.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Spatial Relationships W</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_dependence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Detecting Spatial Dependence</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_exercise1b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Exercises Ib</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_regression-theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Spatial Regression Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_regression-estimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Spatial Regression Models: Estimation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_exercise2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Exercises II</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07_impacts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Spatial Impacts</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08_exercise3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Exercises III</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08_comparison.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Comparing and Selecting Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08_exercise3b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Exercises IIIb</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09_spatiotemporal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Spatio-temporal models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10_other.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Other Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#required-packages" id="toc-required-packages" class="nav-link active" data-scroll-target="#required-packages">Required packages</a></li>
  <li><a href="#session-info" id="toc-session-info" class="nav-link" data-scroll-target="#session-info">Session info</a></li>
  <li><a href="#reload-data-from-pervious-session" id="toc-reload-data-from-pervious-session" class="nav-link" data-scroll-target="#reload-data-from-pervious-session">Reload data from pervious session</a></li>
  <li>
<a href="#specific-to-general" id="toc-specific-to-general" class="nav-link" data-scroll-target="#specific-to-general"><span class="header-section-number">12.1</span> Specific-to-general</a>
  <ul class="collapse">
<li><a href="#lagrange-multiplier-test" id="toc-lagrange-multiplier-test" class="nav-link" data-scroll-target="#lagrange-multiplier-test"><span class="header-section-number">12.1.1</span> Lagrange Multiplier Test</a></li>
  <li><a href="#problem" id="toc-problem" class="nav-link" data-scroll-target="#problem"><span class="header-section-number">12.1.2</span> Problem</a></li>
  </ul>
</li>
  <li><a href="#general-to-specific-approach" id="toc-general-to-specific-approach" class="nav-link" data-scroll-target="#general-to-specific-approach"><span class="header-section-number">12.2</span> General-to-specific approach</a></li>
  <li><a href="#general-advice" id="toc-general-advice" class="nav-link" data-scroll-target="#general-advice"><span class="header-section-number">12.3</span> General advice?</a></li>
  <li><a href="#design-and-theory" id="toc-design-and-theory" class="nav-link" data-scroll-target="#design-and-theory"><span class="header-section-number">12.4</span> Design and Theory</a></li>
  <li>
<a href="#monte-carlo-simulation" id="toc-monte-carlo-simulation" class="nav-link" data-scroll-target="#monte-carlo-simulation"><span class="header-section-number">12.5</span> Monte Carlo simulation</a>
  <ul class="collapse">
<li><a href="#without-omitted-variable-bias" id="toc-without-omitted-variable-bias" class="nav-link" data-scroll-target="#without-omitted-variable-bias"><span class="header-section-number">12.5.1</span> Without omitted variable bias</a></li>
  <li><a href="#with-omitted-variable-bias" id="toc-with-omitted-variable-bias" class="nav-link" data-scroll-target="#with-omitted-variable-bias"><span class="header-section-number">12.5.2</span> With omitted variable bias</a></li>
  <li><a href="#indirect-impacts-if-dgp-gns" id="toc-indirect-impacts-if-dgp-gns" class="nav-link" data-scroll-target="#indirect-impacts-if-dgp-gns"><span class="header-section-number">12.5.3</span> Indirect impacts if DGP = GNS</a></li>
  </ul>
</li>
  <li><a href="#example-house-prices-in-london" id="toc-example-house-prices-in-london" class="nav-link" data-scroll-target="#example-house-prices-in-london"><span class="header-section-number">12.6</span> Example: House prices in London</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">
<span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Comparing and Selecting Models</span>
</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><p><span class="math display">\[
\newcommand{\tr}{\mathrm{tr}}
\newcommand{\rank}{\mathrm{rank}}
\newcommand{\plim}{\operatornamewithlimits{plim}}
\newcommand{\diag}{\mathrm{diag}}
\newcommand{\bm}[1]{\boldsymbol{\mathbf{#1}}}
\newcommand{\Var}{\mathrm{Var}}
\newcommand{\Exp}{\mathrm{E}}
\newcommand{\Cov}{\mathrm{Cov}}
\newcommand\given[1][]{\:#1\vert\:}
\newcommand{\irow}[1]{%
\begin{pmatrix}#1\end{pmatrix}
}
\]</span></p>
<section id="required-packages" class="level3 unnumbered"><h3 class="unnumbered anchored" data-anchor-id="required-packages">Required packages</h3>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pkgs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"sf"</span>, <span class="st">"mapview"</span>, <span class="st">"spdep"</span>, <span class="st">"spatialreg"</span>, <span class="st">"tmap"</span>, <span class="st">"viridisLite"</span><span class="op">)</span> <span class="co"># note: load spdep first, then spatialreg</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">pkgs</span>, <span class="va">require</span>, character.only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="session-info" class="level3 unnumbered"><h3 class="unnumbered anchored" data-anchor-id="session-info">Session info</h3>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.5.1 (2025-06-13 ucrt)
Platform: x86_64-w64-mingw32/x64
Running under: Windows 11 x64 (build 22631)

Matrix products: default
  LAPACK version 3.12.1

locale:
[1] LC_COLLATE=English_United Kingdom.utf8 
[2] LC_CTYPE=English_United Kingdom.utf8   
[3] LC_MONETARY=English_United Kingdom.utf8
[4] LC_NUMERIC=C                           
[5] LC_TIME=English_United Kingdom.utf8    

time zone: Europe/Berlin
tzcode source: internal

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods  
[7] base     

other attached packages:
[1] viridisLite_0.4.2 tmap_4.1          spatialreg_1.3-6 
[4] Matrix_1.7-3      spdep_1.3-13      spData_2.3.4     
[7] mapview_2.11.2    sf_1.0-21        

loaded via a namespace (and not attached):
 [1] xfun_0.52               raster_3.6-32          
 [3] htmlwidgets_1.6.4       lattice_0.22-7         
 [5] leaflet.providers_2.0.0 tools_4.5.1            
 [7] crosstalk_1.2.1         LearnBayes_2.15.1      
 [9] parallel_4.5.1          stats4_4.5.1           
[11] sandwich_3.1-1          proxy_0.4-27           
[13] KernSmooth_2.23-26      data.table_1.17.6      
[15] satellite_1.0.5         RColorBrewer_1.1-3     
[17] leaflet_2.2.2           lifecycle_1.0.4        
[19] compiler_4.5.1          farver_2.1.2           
[21] deldir_2.0-4            microbenchmark_1.5.0   
[23] terra_1.8-54            leafsync_0.1.0         
[25] codetools_0.2-20        leaflegend_1.2.1       
[27] stars_0.6-8             htmltools_0.5.8.1      
[29] class_7.3-23            yaml_2.3.10            
[31] MASS_7.3-65             classInt_0.4-11        
[33] lwgeom_0.2-14           wk_0.9.4               
[35] boot_1.3-31             abind_1.4-8            
[37] multcomp_1.4-28         nlme_3.1-168           
[39] digest_0.6.37           mvtnorm_1.3-3          
[41] splines_4.5.1           fastmap_1.2.0          
[43] grid_4.5.1              colorspace_2.1-1       
[45] cli_3.6.5               logger_0.4.0           
[47] magrittr_2.0.3          maptiles_0.10.0        
[49] base64enc_0.1-3         XML_3.99-0.18          
[51] dichromat_2.0-0.1       cols4all_0.8           
[53] survival_3.8-3          leafem_0.2.4           
[55] TH.data_1.1-3           e1071_1.7-16           
[57] scales_1.4.0            sp_2.2-0               
[59] rmarkdown_2.29          zoo_1.8-14             
[61] png_0.1-8               coda_0.19-4.1          
[63] evaluate_1.0.4          knitr_1.50             
[65] tmaptools_3.2           s2_1.1.9               
[67] rlang_1.1.6             Rcpp_1.0.14            
[69] glue_1.8.0              DBI_1.2.3              
[71] rstudioapi_0.17.1       jsonlite_2.0.0         
[73] R6_2.6.1                spacesXYZ_1.6-0        
[75] units_0.8-7            </code></pre>
</div>
</div>
</section><section id="reload-data-from-pervious-session" class="level3 unnumbered"><h3 class="unnumbered anchored" data-anchor-id="reload-data-from-pervious-session">Reload data from pervious session</h3>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="st">"_data/msoa2_spatial.RData"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>As we have seen, a variety of spatial model specifications exist that can be used to account for the spatial structure of the data. Thus, selecting the correct model specification remains a crucial task in applied research. For some helpful literature on the issue of model selection see <span class="citation" data-cites="Anselin.2024">Anselin, Serenini, and Amaral (<a href="references.html#ref-Anselin.2024" role="doc-biblioref">2024</a>)</span>, <span class="citation" data-cites="HalleckVega.2015">Halleck Vega and Elhorst (<a href="references.html#ref-HalleckVega.2015" role="doc-biblioref">2015</a>)</span>, <span class="citation" data-cites="Ruttenauer.2022a">Rüttenauer (<a href="references.html#ref-Ruttenauer.2022a" role="doc-biblioref">2022</a>)</span></p>
<p>One way of selecting the model specification is the application of empirical specification tests. In general, there are two different strategies: a specific-to-general or a general-to-specific approach <span class="citation" data-cites="Florax.2003 Mur.2009">(<a href="references.html#ref-Florax.2003" role="doc-biblioref">Florax, Folmer, and Rey 2003</a>; <a href="references.html#ref-Mur.2009" role="doc-biblioref">Mur and Angulo 2009</a>)</span>.</p>
</section><section id="specific-to-general" class="level2" data-number="12.1"><h2 data-number="12.1" class="anchored" data-anchor-id="specific-to-general">
<span class="header-section-number">12.1</span> Specific-to-general</h2>
<p>The specific-to-general approach is more common in spatial econometrics. This approach starts with the most basic non-spatial model and tests for possible misspecification due to omitted autocorrelation in the error term or the dependent variable.</p>
<p><span class="citation" data-cites="Anselin.1996">Anselin et al. (<a href="references.html#ref-Anselin.1996" role="doc-biblioref">1996</a>)</span> proposed to use Lagrange multiplier (LM) tests for the hypotheses <span class="math inline">\(H_0\)</span>: <span class="math inline">\(\lambda=0\)</span> and <span class="math inline">\(H_0\)</span>: <span class="math inline">\(\rho=0\)</span>, which are robust against the alternative source of spatial dependence.</p>
<section id="lagrange-multiplier-test" class="level3" data-number="12.1.1"><h3 data-number="12.1.1" class="anchored" data-anchor-id="lagrange-multiplier-test">
<span class="header-section-number">12.1.1</span> Lagrange Multiplier Test</h3>
<p>We have earlier talked about methods to detect auto-correlation – visualisation and Moran’s I. Both methods can tell us that there is spatial autocorrelation. However, both method do not provide any information on why there is autocorrelation. Possible reasons:</p>
<ul>
<li>Interdependence (<span class="math inline">\(\rho\)</span>)</li>
<li>Clustering on unobservables (<span class="math inline">\(\lambda\)</span>)</li>
<li>Spillovers in covariates (<span class="math inline">\(\bm \theta\)</span>)</li>
</ul>
<p>Lagrange Multiplier test <span class="citation" data-cites="Anselin.1996">(<a href="references.html#ref-Anselin.1996" role="doc-biblioref">Anselin et al. 1996</a>)</span>:</p>
<ul>
<li><p>(Robust) test for spatial lag dependence <span class="math inline">\(LM_\rho^*\)</span></p></li>
<li><p>(Robust) test for spatial error dependence <span class="math inline">\(LM_\lambda^*\)</span></p></li>
</ul>
<p>Robust test for lag dependence: <span class="math inline">\(H_0\)</span>: <span class="math inline">\(\rho=0\)</span> <span class="math display">\[
        LM_\rho^* = G^{-1} \hat{\sigma}_\epsilon^2
        \big(\frac{ \hat{\bm\epsilon}^\intercal \bm{Wy}}{\hat{\sigma}_\epsilon^2}
        - \frac{\hat{\bm \epsilon}^\intercal \bm{W\hat{\epsilon}}}{\hat{\sigma}_\epsilon^2} \big)^2 \sim \chi^2
\]</span> <!-- %\\ \text{where } G = (\bm{WX\hat{\beta}})^\intercal (\bm I - \bm X (\bm X^\intercal\bm X)^{-1} \bm X^\intercal) (\bm{WX\hat{\beta}}) --></p>
<p>Robust test for error dependence: <span class="math inline">\(H_0\)</span>: <span class="math inline">\(\lambda=0\)</span></p>
<p><span class="math display">\[
        LM_\lambda^* = \frac{
        \big( \hat{\bm\epsilon}^\intercal \bm{W\hat{\epsilon}} / \hat{\sigma}_\epsilon^2        
        - [T\hat{\sigma}_\epsilon^2(G + T\hat{\sigma}_\epsilon^2)^{-1}]
         \hat{\bm\epsilon}^\intercal \bm{Wy} / \hat{\sigma}_\epsilon^2 \big)^2
        }{
        T[1 - \frac{\hat{\sigma}_\epsilon^2}{G + \hat{\sigma}_\epsilon^2}]
        } \sim \chi^2
\]</span> with <span class="math display">\[
\begin{split}
     G &amp;= (\bm{WX\hat{\beta}})^\intercal (\bm I - \bm X (\bm X^\intercal\bm X)^{-1} \bm X^\intercal) (\bm{WX\hat{\beta}})   \\
     T &amp;= \tr[(\bm W^\intercal + \bm W)\bm W],
\end{split}     
\]</span> where <span class="math inline">\(\tr(\bm A)\)</span> is the sum of the main diagonal of any square matrix <span class="math inline">\(\bm A\)</span>.</p>
<p>To perform the test, we first need to run a conventional OLS model. We take yesterdays example.</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">### Load data</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="st">"_data/msoa2_spatial.RData"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">### Generate weights</span></span>
<span><span class="va">coords</span> <span class="op">&lt;-</span> <span class="fu">st_centroid</span><span class="op">(</span><span class="va">msoa.spdf</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Neighbours within 3km distance</span></span>
<span><span class="va">dist_15.nb</span> <span class="op">&lt;-</span> <span class="fu">dnearneigh</span><span class="op">(</span><span class="va">coords</span>, d1 <span class="op">=</span> <span class="fl">0</span>, d2 <span class="op">=</span> <span class="fl">2500</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">dist_15.nb</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># There are some empty neighbour sets. Lets impute those with the nearest neighbour.</span></span>
<span><span class="va">k2.nb</span> <span class="op">&lt;-</span> <span class="fu">knearneigh</span><span class="op">(</span><span class="va">coords</span>, k <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Replace zero</span></span>
<span><span class="va">nolink_ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="fu">card</span><span class="op">(</span><span class="va">dist_15.nb</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">dist_15.nb</span><span class="op">[</span><span class="fu">card</span><span class="op">(</span><span class="va">dist_15.nb</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">k2.nb</span><span class="op">$</span><span class="va">nn</span><span class="op">[</span><span class="va">nolink_ids</span>, <span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">dist_15.nb</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># listw object with row-normalization</span></span>
<span><span class="va">dist_15.lw</span> <span class="op">&lt;-</span> <span class="fu">nb2listw</span><span class="op">(</span><span class="va">dist_15.nb</span>, style <span class="op">=</span> <span class="st">"W"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mod_1.lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">no2</span><span class="op">)</span> <span class="op">~</span> <span class="va">per_mixed</span> <span class="op">+</span> <span class="va">per_asian</span> <span class="op">+</span> <span class="va">per_black</span> <span class="op">+</span> <span class="va">per_other</span></span>
<span>                      <span class="op">+</span> <span class="va">per_nonUK_EU</span> <span class="op">+</span> <span class="va">per_nonEU</span>  <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">POPDEN</span><span class="op">)</span>,  </span>
<span>                      data <span class="op">=</span> <span class="va">msoa.spdf</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod_1.lm</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log(no2) ~ per_mixed + per_asian + per_black + per_other + 
    per_nonUK_EU + per_nonEU + log(POPDEN), data = msoa.spdf)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.46035 -0.09063 -0.01010  0.07484  0.90401 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   2.5188244  0.0313089  80.451  &lt; 2e-16 ***
per_mixed     0.0050636  0.0044498   1.138   0.2554    
per_asian     0.0006251  0.0003459   1.807   0.0711 .  
per_black    -0.0009929  0.0007100  -1.398   0.1623    
per_other     0.0141322  0.0022477   6.288 4.86e-10 ***
per_nonUK_EU  0.0132176  0.0011520  11.473  &lt; 2e-16 ***
per_nonEU     0.0026836  0.0010643   2.522   0.0118 *  
log(POPDEN)   0.1391236  0.0079044  17.601  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1373 on 975 degrees of freedom
Multiple R-squared:  0.6162,    Adjusted R-squared:  0.6134 
F-statistic: 223.6 on 7 and 975 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Subsequently, we run the robust LM test for Lag dependence:</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">test.lag</span> <span class="op">&lt;-</span> <span class="fu">lm.RStests</span><span class="op">(</span><span class="va">mod_1.lm</span>, </span>
<span>                       listw <span class="op">=</span> <span class="va">dist_15.lw</span>, </span>
<span>                       test <span class="op">=</span> <span class="st">"adjRSlag"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">test.lag</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Rao's score (a.k.a Lagrange multiplier) diagnostics for
    spatial dependence
data:  
model: lm(formula = log(no2) ~ per_mixed + per_asian +
per_black + per_other + per_nonUK_EU + per_nonEU +
log(POPDEN), data = msoa.spdf)
test weights: dist_15.lw
 
         statistic parameter   p.value    
adjRSlag    365.69         1 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>For the robust LM test on spatial error dependence, we run:</p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">test.err</span> <span class="op">&lt;-</span> <span class="fu">lm.RStests</span><span class="op">(</span><span class="va">mod_1.lm</span>, </span>
<span>                       listw <span class="op">=</span> <span class="va">dist_15.lw</span>, </span>
<span>                       test <span class="op">=</span> <span class="st">"adjRSerr"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">test.err</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Rao's score (a.k.a Lagrange multiplier) diagnostics for
    spatial dependence
data:  
model: lm(formula = log(no2) ~ per_mixed + per_asian +
per_black + per_other + per_nonUK_EU + per_nonEU +
log(POPDEN), data = msoa.spdf)
test weights: dist_15.lw
 
         statistic parameter   p.value    
adjRSerr    324.32         1 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>In fact, you can compare them all at once:</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">test.all</span> <span class="op">&lt;-</span> <span class="fu">lm.RStests</span><span class="op">(</span><span class="va">mod_1.lm</span>, </span>
<span>                       listw <span class="op">=</span> <span class="va">dist_15.lw</span>, </span>
<span>                       test <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">test.all</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Rao's score (a.k.a Lagrange multiplier) diagnostics for
    spatial dependence
data:  
model: lm(formula = log(no2) ~ per_mixed + per_asian +
per_black + per_other + per_nonUK_EU + per_nonEU +
log(POPDEN), data = msoa.spdf)
test weights: dist_15.lw
 
         statistic parameter   p.value    
RSerr      1850.70         1 &lt; 2.2e-16 ***
RSlag      1892.06         1 &lt; 2.2e-16 ***
adjRSerr    324.32         1 &lt; 2.2e-16 ***
adjRSlag    365.69         1 &lt; 2.2e-16 ***
SARMA      2216.38         2 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>In both cases, the LM test indicates the presence of significance lag dependence and significance error dependence.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Take the LM test with a grain of salt
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>DO NOT</strong> use the above results as a reason to say: “well, there is Lag dependence and there is Error dependence. So, I will use a SAC-like specification”. This would usually be a bad choice, as the LM tests assume the absence od any SLX terms.</p>
</div>
</div>
</section><section id="problem" class="level3" data-number="12.1.2"><h3 data-number="12.1.2" class="anchored" data-anchor-id="problem">
<span class="header-section-number">12.1.2</span> Problem</h3>
<p>The specific-to-general approach based on the robust LM test offers a good performance in distinguishing between SAR, SEM, and non-spatial OLS <span class="citation" data-cites="Florax.2003">(<a href="references.html#ref-Florax.2003" role="doc-biblioref">Florax, Folmer, and Rey 2003</a>)</span>.</p>
<p>Still, in their original paper, <span class="citation" data-cites="Anselin.1996">Anselin et al. (<a href="references.html#ref-Anselin.1996" role="doc-biblioref">1996</a>)</span> already note the declining power of the robust LM<span class="math inline">\(_\lambda\)</span> test for spatial error dependence with increasing autocorrelation in the dependent variable (indicating some uncertainty under a SAC-like DGP).</p>
<p><span class="citation" data-cites="Mur.2009">Mur and Angulo (<a href="references.html#ref-Mur.2009" role="doc-biblioref">2009</a>)</span> demonstrate strong drawbacks of the specific-to-general approach under non-optimal conditions like heteroscedasticity or endogeneity.</p>
<p>Moreover, the test disregard the presence of spatial dependence from local spillover effects (<span class="math inline">\(\theta\)</span> is assumed to be zero), as resulting from an SLX-like process. <span class="citation" data-cites="Cook.2020">Cook, Hays, and Franzese (<a href="references.html#ref-Cook.2020" role="doc-biblioref">2020</a>)</span>, for instance, show theoretically that an SLX-like dependence structure leads to the rejection of both hypotheses <span class="math inline">\(H_0\)</span>: <span class="math inline">\(\lambda=0\)</span> and <span class="math inline">\(H_0\)</span>: <span class="math inline">\(\rho=0\)</span>, though no autocorrelation is present <span class="citation" data-cites="Elhorst.2017 Ruttenauer.2022a">(<a href="references.html#ref-Elhorst.2017" role="doc-biblioref">Elhorst and Halleck Vega 2017</a>; <a href="references.html#ref-Ruttenauer.2022a" role="doc-biblioref">Rüttenauer 2022</a>)</span>.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Potential solution?
</div>
</div>
<div class="callout-body-container callout-body">
<p>In a recent preprint, <span class="citation" data-cites="Anselin.2024">Anselin, Serenini, and Amaral (<a href="references.html#ref-Anselin.2024" role="doc-biblioref">2024</a>)</span> proposed a two-step test approach (“STGE-Pre”). First, we need to test the presence of any SLX (<span class="math inline">\(\bm W \bm X\)</span>) term. If we can omit those terms, we proceed with the robust LM lag test and the robust LM error test.</p>
</div>
</div>
</section></section><section id="general-to-specific-approach" class="level2" data-number="12.2"><h2 data-number="12.2" class="anchored" data-anchor-id="general-to-specific-approach">
<span class="header-section-number">12.2</span> General-to-specific approach</h2>
<p>The general-to-specific approach depicts the opposite method of specification search. This approach starts with the most general model and stepwise imposes restrictions on the parameters of this general model.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="fig/Vega.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption"><span class="citation" data-cites="HalleckVega.2015">Halleck Vega and Elhorst (<a href="references.html#ref-HalleckVega.2015" role="doc-biblioref">2015</a>)</span>: Nesting of different Spatial Econometric Model Specifications</figcaption></figure>
</div>
<p>In theory, we would</p>
<ol type="1">
<li><p>start with a GNS specification and</p></li>
<li><p>subsequently restrict the model to simplified specifications based on the significance of parameters in the GNS.</p></li>
</ol>
<p>The problem with this strategy is that the GNS is only weakly identified and, thus, is of little help in selecting the correct restrictions <span class="citation" data-cites="Burridge.2016">(<a href="references.html#ref-Burridge.2016" role="doc-biblioref">Burridge, Elhorst, and Zigova 2016</a>)</span>.</p>
<p>The most intuitive alternative would be to start with one of the two-source models SDM, SDEM, or SAC. This, however, bears the risk of imposing the wrong restriction in the first place <span class="citation" data-cites="Cook.2020">(<a href="references.html#ref-Cook.2020" role="doc-biblioref">Cook, Hays, and Franzese 2020</a>)</span>. Furthermore, <span class="citation" data-cites="Cook.2020">Cook, Hays, and Franzese (<a href="references.html#ref-Cook.2020" role="doc-biblioref">2020</a>)</span> show that more complicated restrictions are necessary to derive all single-source models from SDEM or SAC specifications. <span class="citation" data-cites="Anselin.2024">Anselin, Serenini, and Amaral (<a href="references.html#ref-Anselin.2024" role="doc-biblioref">2024</a>)</span> argue that the Ge</p>
</section><section id="general-advice" class="level2" data-number="12.3"><h2 data-number="12.3" class="anchored" data-anchor-id="general-advice">
<span class="header-section-number">12.3</span> General advice?</h2>
<p><span class="citation" data-cites="LeSage.2009">LeSage and Pace (<a href="references.html#ref-LeSage.2009" role="doc-biblioref">2009</a>)</span>, <span class="citation" data-cites="LeSage.2014">LeSage (<a href="references.html#ref-LeSage.2014" role="doc-biblioref">2014</a>)</span>, <span class="citation" data-cites="Elhorst.2014">Elhorst (<a href="references.html#ref-Elhorst.2014" role="doc-biblioref">2014</a>)</span> argue that there are strong analytical reasons to restrict the model specifications to a subset, as the SDM subsumes the SLX and SAR model, and the SDEM subsumes SLX and SEM.</p>
<p>It is easily observed that SDM reduces to SLX if <span class="math inline">\(\rho=0\)</span> and to SAR if <span class="math inline">\({\bm \theta}=0\)</span>, while the SDEM reduces to SLX if <span class="math inline">\(\lambda=0\)</span> and to SEM if <span class="math inline">\({\bm \theta}=0\)</span>. Less intuitively, <span class="citation" data-cites="Anselin.1988">(<a href="references.html#ref-Anselin.1988" role="doc-biblioref">Anselin 1988</a>)</span> has also shown that the SDM subsumes the SEM. Therefore, we can express the reduced form and rearrange terms:</p>
<p><span class="math display">\[
\begin{split}
{\bm y}&amp;= {\bm X}{\bm \beta} + ({\bm I_N}-\lambda {\bm W})^{-1}{\bm \varepsilon} \\
({\bm I_N}-\lambda {\bm W}){\bm y}&amp;= ({\bm I_N}-\lambda {\bm W}){\bm X}{\bm \beta} + {\bm \varepsilon} \\
({\bm I_N}-\lambda {\bm W}){\bm y}&amp;={\bm X}{\bm \beta} -\lambda{\bm W}{\bm X}{\bm \beta} + {\bm \varepsilon} \\
{\bm y}&amp;=({\bm I_N}-\lambda {\bm W})^{-1}({\bm X}{\bm \beta} + {\bm W}{\bm X}{\bm \theta} + {\bm \varepsilon}).
\end{split}
\]</span></p>
<p>Thus, the SEM constitutes a special case of an SDM with the relative simple restriction <span class="math inline">\({\bm \theta}=-\lambda{\bm \beta}\)</span>, meaning direct and indirect effects are constrained to a common factor <span class="citation" data-cites="Anselin.1988 Anselin.2003">(<a href="references.html#ref-Anselin.1988" role="doc-biblioref">Anselin 1988</a>, <a href="references.html#ref-Anselin.2003" role="doc-biblioref">2003</a>)</span>.</p>
<p>The fact that SDM subsumes SAR, SLX, and SEM leads to the conclusion that applied research should only consider SDM and SDEM as model specifications <span class="citation" data-cites="LeSage.2014">(<a href="references.html#ref-LeSage.2014" role="doc-biblioref">LeSage 2014</a>)</span>. Especially in the case of a likely omitted variable bias, <span class="citation" data-cites="LeSage.2009">(<a href="references.html#ref-LeSage.2009" role="doc-biblioref">LeSage and Pace 2009, ~68</a>)</span> argue in favour of using the SDM.</p>
<p>Nonetheless, others propose to use the SLX specification as point of departure <span class="citation" data-cites="Gibbons.2012 HalleckVega.2015">(<a href="references.html#ref-Gibbons.2012" role="doc-biblioref">Gibbons and Overman 2012</a>; <a href="references.html#ref-HalleckVega.2015" role="doc-biblioref">Halleck Vega and Elhorst 2015</a>)</span>. First, scholars have argued that SAC and SDM models are only weakly identified in practice <span class="citation" data-cites="Gibbons.2012 Pinkse.2010">(<a href="references.html#ref-Gibbons.2012" role="doc-biblioref">Gibbons and Overman 2012</a>; <a href="references.html#ref-Pinkse.2010" role="doc-biblioref">Pinkse and Slade 2010</a>)</span>. Second, the global spillover specification in SAR, SAC, and SDM often seems to be theoretically implausible.</p>
<p>And finally:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="fig/wooldridge_tweet.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">“I will use spatial lags of X, not spatial lags of Y”, J. <a href="https://twitter.com/jmwooldridge/status/1369460526770753537">Wooldridge on twitter</a></figcaption></figure>
</div>
</section><section id="design-and-theory" class="level2" data-number="12.4"><h2 data-number="12.4" class="anchored" data-anchor-id="design-and-theory">
<span class="header-section-number">12.4</span> Design and Theory</h2>
<p>Some argue that the best way of choosing the appropriate model specification is to exclude one or more sources of spatial dependence – autocorrelation in the dependent variable, autocorrelation in the disturbances, or spatial spillover effects of the covariates – by design <span class="citation" data-cites="Gibbons.2012">Gibbons, Overman, and Patacchini (<a href="references.html#ref-Gibbons.2015" role="doc-biblioref">2015</a>)</span>.</p>
<p><strong>Natural experiments</strong> are probably the best way of making one or more sources of spatial dependence unlikely, thereby restricting the model alternatives to a subset of all available models. However, the opportunities to use natural experiments are restricted in social sciences, making it a favourable but often impractical way of model selection.</p>
<p><span class="citation" data-cites="Cook.2020">Cook, Hays, and Franzese (<a href="references.html#ref-Cook.2020" role="doc-biblioref">2020</a>)</span> and <span class="citation" data-cites="Ruttenauer.2022a">Rüttenauer (<a href="references.html#ref-Ruttenauer.2022a" role="doc-biblioref">2022</a>)</span> argue that theoretical considerations should guide the model selection.</p>
<ol type="1">
<li><p>Rule out some sources of spatial dependence by theory, and thus restrict the specifications to a subset ( <em>Where does the spatial dependence come from?</em> ),</p></li>
<li><p>Theoretical mechanisms may guide the choice of either global or local spillover effects.</p></li>
</ol></section><section id="monte-carlo-simulation" class="level2" data-number="12.5"><h2 data-number="12.5" class="anchored" data-anchor-id="monte-carlo-simulation">
<span class="header-section-number">12.5</span> Monte Carlo simulation</h2>
<p>This section discusses results from <span class="citation" data-cites="Ruttenauer.2022a">Rüttenauer (<a href="references.html#ref-Ruttenauer.2022a" role="doc-biblioref">2022</a>)</span>. The aim: how do different spatial models perform under different scenarios?</p>
<p>The DGP of the Monte Carlo simulation follows a GNS, where <span class="math inline">\({\bm \upsilon}_k\)</span> and <span class="math inline">\({\bm \varepsilon}\)</span> are independent and randomly distributed <span class="math inline">\(\mathcal{N}(0,\sigma^{2}_\upsilon)\)</span> and <span class="math inline">\(\mathcal{N}(0,\sigma^{2}_\varepsilon)\)</span> with a mean of zero, and <span class="math inline">\({\bm x}_k\)</span> is the <span class="math inline">\(k\)</span>th column-vector of <span class="math inline">\({\bm X}\)</span> for <span class="math inline">\(k=1,...,K\)</span> covariates (<span class="math inline">\(K\)</span> is fixed at <span class="math inline">\(2\)</span> in the simulations). The parameter <span class="math inline">\(\rho\)</span> represents the autocorrelation in the dependent variable, <span class="math inline">\(\lambda\)</span> the autocorrelation in the disturbances, and <span class="math inline">\(\delta_k\)</span> the autocorrelation in covariate <span class="math inline">\(k\)</span>.</p>
<p><span class="math display">\[
\begin{split}
{\bm y}&amp;=\rho{\bm W}{\bm y}+{\bm X}{\bm \beta}+{\bm W}{\bm X}{\bm \theta}+ {\bm u},\\
{\bm u}&amp;=\lambda{\bm W}{\bm u}+{\bm X}{\bm\gamma}+{\bm \varepsilon},\\
{\bm x}_k&amp;=\delta_k{\bm W}{\bm x}_k+{\bm \upsilon}_k.
\end{split}
\]</span> The parameter-vector <span class="math inline">\({\bm \gamma}\)</span> specifies the correlation between <span class="math inline">\({\bm x}\)</span> and the disturbance vector <span class="math inline">\({\bm u}\)</span>, thereby defining the strength of an omitted variable bias. In reduced form, this DGP can be written as <span class="math display">\[
\begin{split}
{\bm y}=&amp;({\bm I_N}-\rho {\bm W})^{-1}\big[({\bm I_N}-\delta_k {\bm W})^{-1}{\bm \upsilon_k}\beta_k \\
&amp;+{\bm W}({\bm I_N}-\delta_k {\bm W})^{-1}{\bm \upsilon_k}\theta_k \\
&amp;+({\bm I_N}-\lambda {\bm W})^{-1}(({\bm I_N}-\delta_k {\bm W})^{-1}{\bm \upsilon_k}\gamma_k+{\bm \varepsilon})\big].
\end{split}
\]</span></p>
<p>The parameter vector <span class="math inline">\({\bm \beta}\)</span> was fixed at <span class="math inline">\({\bm \beta}=\irow{0.2&amp;0.5}^\intercal\)</span>, and the noise parameters were fixed at <span class="math inline">\(\sigma^{2}_\upsilon\)</span>, <span class="math inline">\(\sigma^{2}_\varepsilon=1\)</span> for all trials. All other parameters vary between the following two options for each parameter (vector):</p>
<ul>
<li>
<span class="math inline">\(\rho \in \left\{ 0, 0.5\right\}\)</span>,</li>
<li>
<span class="math inline">\(\lambda \in \{0, 0.5\}\)</span>,</li>
<li>
<span class="math inline">\({\bm \delta} \in \left\{ \irow{0&amp;0}^\intercal, \irow{0.4&amp;0.7}^\intercal\right\}\)</span>,</li>
<li>
<span class="math inline">\({\bm \theta} \in \left\{\irow{0&amp;0}^\intercal, \irow{0.1&amp;0.8}^\intercal\right\}\)</span>,</li>
<li>
<span class="math inline">\({\bm \gamma} \in \left\{\irow{0&amp;0}^\intercal, \irow{0.3&amp;0}^\intercal\right\}\)</span>,</li>
</ul>
<p>leading to a total of 32 distinct combinations. Note that this selection of parameters intentionally violates the common ratio assumption between direct and indirect effects, as this should be a more common case in practical research. All combinations were simulated in 1000 trials, with the same starting seed for each combination. If youre, interested in the simulations, see <a href="https://github.com/ruettenauer/Reproduction-Material-Spatial-Monte-Carlo-Experiments">replication code on Github</a>.</p>
<section id="without-omitted-variable-bias" class="level3" data-number="12.5.1"><h3 data-number="12.5.1" class="anchored" data-anchor-id="without-omitted-variable-bias">
<span class="header-section-number">12.5.1</span> Without omitted variable bias</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="fig/sim4_combined_1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Bias of impacts and 95% confidence interval of empirical standard deviation without omv: <span class="math inline">\({\bm \beta}=(0.2, 0.5)^\intercal\)</span>, <span class="math inline">\({\bm \gamma}=(0, 0)^\intercal\)</span>. <span class="math inline">\(\rho=\)</span> autocorrelation in the dependent variable (<span class="math inline">\(\bm W \bm y\)</span>); <span class="math inline">\(\bm \delta=\)</span> autocorrelation in the covariates (<span class="math inline">\(\bm x_k = f(\bm W \bm x_k)\)</span>); <span class="math inline">\(\lambda=\)</span> autocorrelation in the disturbances (<span class="math inline">\(\bm W \bm u\)</span>); <span class="math inline">\(\bm \theta=\)</span> spatial spillover effects of covariates (<span class="math inline">\(\bm W \bm X\)</span>); <span class="math inline">\(\bm\gamma=\)</span> strength of omv.</figcaption></figure>
</div>
<p>SLX, SDM, and SDEM all provide quite accurate estimates of the direct impacts (most visible in column 2). SAR, SEM, and SAC, in contrast, yield some drawbacks: especially in the presence of local spillover effects, these three specifications are biased (see lower part). Furthermore, SAR and SEM suffer from bias if autocorrelation in the disturbance and autocorrelation in the dependent variable are present simultaneously (see line 6 and 8). Though SLX is downwardly biased in case of autocorrelation in the dependent variable and the covariates (e.g.&nbsp;line 12 and 16), and SDM as well as SDEM yield some bias in case of a GNS-like process (line 14 and 16), those biases are rather moderate. This indicates that SLX, SDM, and SDEM are most robust against misspecification regarding the direct impacts.</p>
<p>Several differences exist regarding the indirect impacts. Most obviously, the often used SAR specification suffers from considerable bias: it overestimates indirect impacts in case of autocorrelation in the disturbances, and offers biased estimates if local spillover effects exist (which are not restricted to a common ratio). The latter also applies to SAC: though SAC offers relatively accurate estimates for <span class="math inline">\({\bm x}_2\)</span>, it overestimates indirect impacts for <span class="math inline">\({\bm x}_1\)</span>.</p>
<p>Regarding the remaining three specifications – SLX, SDM, and SDEM – conclusions are less obvious. SDM and SDEM suffer from large bias for high values of <span class="math inline">\({\bm \theta}\)</span> (see <span class="math inline">\(\bm{x}_2\)</span>) if the DGP follows a GNS-like process (line 14 and 16): SDM overestimates the indirect impacts, while SDEM underestimates the indirect impacts. In addition, SDM performs badly if the true DGP is SDEM (line 13), and SDEM performs badly if the true DGP is SDM (line 10), whereas the bias increases with higher values of <span class="math inline">\(\theta_k\)</span> in both cases. Similar to SDEM, SLX underestimates the indirect impacts in presence of global spillovers / autocorrelation in the dependent variable.</p>
</section><section id="with-omitted-variable-bias" class="level3" data-number="12.5.2"><h3 data-number="12.5.2" class="anchored" data-anchor-id="with-omitted-variable-bias">
<span class="header-section-number">12.5.2</span> With omitted variable bias</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="fig/sim4_combined_2.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Bias of impacts and 95% confidence interval of empirical standard deviation with omv: <span class="math inline">\({\bm \beta}=(0.2, 0.5)^\intercal\)</span>, <span class="math inline">\({\bm \gamma}=(0.3, 0)^\intercal\)</span>. <span class="math inline">\(\rho=\)</span> autocorrelation in the dependent variable (<span class="math inline">\(\bm W \bm y\)</span>); <span class="math inline">\(\bm \delta=\)</span> autocorrelation in the covariates (<span class="math inline">\(\bm x_k = f(\bm W \bm x_k)\)</span>); <span class="math inline">\(\lambda=\)</span> autocorrelation in the disturbances (<span class="math inline">\(\bm W \bm u\)</span>); <span class="math inline">\(\bm \theta=\)</span> spatial spillover effects of covariates (<span class="math inline">\(\bm W \bm X\)</span>); <span class="math inline">\(\bm\gamma=\)</span> strength of omv.</figcaption></figure>
</div>
</section><section id="indirect-impacts-if-dgp-gns" class="level3" data-number="12.5.3"><h3 data-number="12.5.3" class="anchored" data-anchor-id="indirect-impacts-if-dgp-gns">
<span class="header-section-number">12.5.3</span> Indirect impacts if DGP = GNS</h3>
<p>Below an illustration about the indirect impacts, if the spatial process is a combination of</p>
<ol type="1">
<li><p>Clustering on Unobservables</p></li>
<li><p>Interdependence (in the outcome)</p></li>
<li><p>Spillovers in Covariates</p></li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="fig/sim11_combined_1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Bias of indirect impacts and 95% confidence interval of empirical standard deviation for different strengths of autocorrelation: <span class="math inline">\({\bm \beta}=(0.2, 0.5)^\intercal\)</span>, <span class="math inline">\({\bm \gamma}=(0, 0)^\intercal\)</span>, <span class="math inline">\({\bm\delta}=(0, 0)^\intercal\)</span>, <span class="math inline">\({\bm\theta}=(0.1, 0.8)^\intercal\)</span>. <span class="math inline">\(\rho=\)</span> autocorrelation in the dependent variable (<span class="math inline">\(\bm W \bm y\)</span>); <span class="math inline">\(\bm \delta=\)</span> autocorrelation in the covariates (<span class="math inline">\(\bm x_k = f(\bm W \bm x_k)\)</span>); <span class="math inline">\(\lambda=\)</span> autocorrelation in the disturbances (<span class="math inline">\(\bm W \bm u\)</span>); <span class="math inline">\(\bm \theta=\)</span> spatial spillover effects of covariates (<span class="math inline">\(\bm W \bm X\)</span>); <span class="math inline">\(\bm\gamma=\)</span> strength of omv.</figcaption></figure>
</div>
<p>First, in a GNS-like situation, the bias in SDM grows with increasing autocorrelation in <span class="math inline">\({\bm y}\)</span> (<span class="math inline">\(\rho\)</span>) and increasing autocorrelation in the disturbances (<span class="math inline">\(\lambda\)</span>).</p>
<p>Second, the bias in SLX and SDEM increases with higher values of <span class="math inline">\(\rho\)</span>, but is unaffected from the strength of <span class="math inline">\(\lambda\)</span>.</p>
<p>Third, though SLX and SDEM suffer from the same problem, the bias from omitting global autocorrelation is less severe in SLX than in SDEM.</p>
<p>Thus, the SLX outperforms SDEM. Furthermore, SLX outperforms SDM in most situations; only if the autocorrelation in the dependent variable is much stronger than the autocorrelation in the disturbances (<span class="math inline">\(\rho=0.9\)</span>, <span class="math inline">\(\lambda=0.3\)</span>), SDM yields lower bias than SLX. Note that the SAC yields relatively low biases for the indirect impacts in GNS-like processes, but at the same time produces relative large biases in the direct impacts.</p>
</section></section><section id="example-house-prices-in-london" class="level2" data-number="12.6"><h2 data-number="12.6" class="anchored" data-anchor-id="example-house-prices-in-london">
<span class="header-section-number">12.6</span> Example: House prices in London</h2>
<p>The example is taken from <span class="citation" data-cites="Ruttenauer.2024b">Rüttenauer (<a href="references.html#ref-Ruttenauer.2024b" role="doc-biblioref">2024</a>)</span>.</p>
<p>As an example to compare the different spatial model specifications, we estimate the effect of local characteristics such as green space and public transport connectivity on the median house price. The relation between environmental characteristics and housing choice and prices has been investigated in several studies <span class="citation" data-cites="Anselin.2008 Kley.2021 Liebe.2023">(<a href="references.html#ref-Anselin.2008" role="doc-biblioref">Anselin and Lozano-Gracia 2008</a>; <a href="references.html#ref-Kley.2021" role="doc-biblioref">Kley and Dovbishchuk 2021</a>; <a href="references.html#ref-Liebe.2023" role="doc-biblioref">Liebe, van Cranenburgh, and Chorus 2023</a>)</span>. The data for the current example was retrieved from the London Datastore<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>, the 2011 Census<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> and OpenStreetMaps and combined at the Middle Layer Super Output Areas (MSOA). There are 983 MSOAs in London with an average population size of around 8,000 residents. The script for compiling and preparing the data can be found in the Supplementary Materials. All data preparation and analysis were performed with the statistical software R. For a comprehensive overview of spatial software see <span class="citation" data-cites="Bivand.2021">Bivand, Millo, and Piras (<a href="references.html#ref-Bivand.2021" role="doc-biblioref">2021</a>)</span> or <span class="citation" data-cites="Pebesma.2023">Pebesma and Bivand (<a href="references.html#ref-Pebesma.2023" role="doc-biblioref">2023</a>)</span>.</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Load the packages</span></span>
<span><span class="va">pkgs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"sf"</span>, <span class="st">"mapview"</span>, <span class="st">"spdep"</span>, <span class="st">"spatialreg"</span>, <span class="st">"texreg"</span>, </span>
<span>          <span class="st">"ggplot2"</span>, <span class="st">"ggthemes"</span>, <span class="st">"rmapshaper"</span>, <span class="st">"viridis"</span>, <span class="st">"gridExtra"</span><span class="op">)</span> <span class="co"># note: load spdep first, then spatialreg</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">pkgs</span>, <span class="va">require</span>, character.only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load the data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="st">"_data/msoa3_spatial.RData"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create Contiguity (Queens) neighbours weights</span></span>
<span><span class="va">queens.nb</span> <span class="op">&lt;-</span> <span class="fu">poly2nb</span><span class="op">(</span><span class="va">msoa.spdf</span>, </span>
<span>                     queen <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                     snap <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="co"># we consider points in 1m distance as 'touching'</span></span>
<span><span class="va">queens.lw</span> <span class="op">&lt;-</span> <span class="fu">nb2listw</span><span class="op">(</span><span class="va">queens.nb</span>,</span>
<span>                      style <span class="op">=</span> <span class="st">"W"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">### Plot house prices</span></span>
<span></span>
<span><span class="co"># Get some larger scale boundaries</span></span>
<span><span class="va">borough.spdf</span> <span class="op">&lt;-</span> <span class="fu">st_read</span><span class="op">(</span>dsn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"_data"</span>, <span class="st">"/statistical-gis-boundaries-london/ESRI"</span><span class="op">)</span>,</span>
<span>                     layer <span class="op">=</span> <span class="st">"London_Borough_Excluding_MHW"</span> <span class="co"># Note: no file ending</span></span>
<span>                     <span class="op">)</span></span>
<span><span class="co"># transform to only inner lines</span></span>
<span><span class="va">borough_inner</span> <span class="op">&lt;-</span> <span class="fu">rmapshaper</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rmapshaper/man/ms_innerlines.html">ms_innerlines</a></span><span class="op">(</span><span class="va">borough.spdf</span><span class="op">)</span></span>
<span><span class="va">borough_inner</span> <span class="op">&lt;-</span> <span class="va">borough.spdf</span></span>
<span></span>
<span></span>
<span><span class="co"># Plot with inner lines</span></span>
<span><span class="va">msoa.spdf</span><span class="op">$</span><span class="va">med_house_price_ln</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">msoa.spdf</span><span class="op">$</span><span class="va">med_house_price</span><span class="op">)</span></span>
<span><span class="va">msoa.spdf</span><span class="op">$</span><span class="va">pt_access_index_ln</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">msoa.spdf</span><span class="op">$</span><span class="va">pt_access_index</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gp</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">msoa.spdf</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_sf</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">med_house_price_ln</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">scale_fill_viridis_c</span><span class="op">(</span>option <span class="op">=</span> <span class="st">"A"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_sf</span><span class="op">(</span>data <span class="op">=</span> <span class="va">borough_inner</span>, color <span class="op">=</span> <span class="st">"gray92"</span>, fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">coord_sf</span><span class="op">(</span>datum <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_map</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"log price"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Median house price"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gp2</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">msoa.spdf</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_sf</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">pt_access_index_ln</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">scale_fill_viridis_c</span><span class="op">(</span>option <span class="op">=</span> <span class="st">"D"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_sf</span><span class="op">(</span>data <span class="op">=</span> <span class="va">borough_inner</span>, color <span class="op">=</span> <span class="st">"gray92"</span>, fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">coord_sf</span><span class="op">(</span>datum <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_map</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"log index"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Public transport access"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/cairo.html">cairo_ps</a></span><span class="op">(</span>file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"fig/"</span>, <span class="st">"Maps.eps"</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">10</span>, height <span class="op">=</span> <span class="fl">4</span>, </span>
<span>          bg <span class="op">=</span> <span class="st">"white"</span>, family <span class="op">=</span> <span class="st">"Times New Roman"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, oma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">grid.arrange</span><span class="op">(</span><span class="va">gp</span>, <span class="va">gp2</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/png.html">jpeg</a></span><span class="op">(</span>file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"fig/"</span>, <span class="st">"Maps.jpeg"</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">10</span>, height <span class="op">=</span> <span class="fl">4</span>, </span>
<span>    units <span class="op">=</span> <span class="st">"in"</span>, res <span class="op">=</span> <span class="fl">300</span>, type <span class="op">=</span> <span class="st">"cairo"</span>,</span>
<span>          bg <span class="op">=</span> <span class="st">"white"</span>, family <span class="op">=</span> <span class="st">"Times New Roman"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, oma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">grid.arrange</span><span class="op">(</span><span class="va">gp</span>, <span class="va">gp2</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="fig-map" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="fig/Maps.jpeg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;12.1: Spatial distribution of log-transformed median house prices and transport accessibility across London.</figcaption></figure>
</div>
<p>Figure <a href="#fig-map">Figure&nbsp;<span>12.1</span></a> shows an unclassified choropleth map of house prices and public transport access across London, both log-scaled for mapping. As we would expect, both indicators follow a relatively strong spatial of positive autocorrelation: house prices first decrease with increasing distance to the centre, and then seem to increase again in suburban areas. Moreover, there seems to be a pattern of higher prices towards the west and particularly high prices around Hyde Park. Public transport accessibility steadily decreases with distance to the city centre. Spatial regression models thus seem to be important here for two reasons: a) observations are not independent of each other but follow clear spatial patterns, and b) surrounding / adjacent urban characteristics likely play a role for housing demand and prices in the focal unit as well.</p>
<p>In Table 1, we regress the median house price in 2011 on the area (in km^2) covered by green space according to OpenStreetMaps, an index of public transport access (ranging from 0-low accessibility to 100-high accessibility), and several population characteristics from the 2011 census such as population density, the percent of non-UK residents and the percent of social housing. Reported are results form (1) non-spatial OLS, (2) Spatial Autoregressive (SAR), (3) Spatial Error Model (SEM), (4) Spatial Lag of X (SLX), (5) Spatial Durbin Model (SDM), (6) and Spatial Durbin Error Model (SDEM). All variables were standardized before estimation, and we thus interpret coefficients in standard deviations. Note that we do not estimate results for Spatial Autoregressive Combined (SAC) models because of its severe drawbacks for applied research <span class="citation" data-cites="LeSage.2014">(<a href="references.html#ref-LeSage.2014" role="doc-biblioref">LeSage 2014</a>)</span>.</p>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Specifcy variables and formula</span></span>
<span><span class="va">fm</span> <span class="op">&lt;-</span> <span class="va">med_house_price</span> <span class="op">~</span> <span class="va">park_kmsq</span> <span class="op">+</span> <span class="va">pt_access_index</span> <span class="op">+</span> <span class="va">POPDEN</span> <span class="op">+</span> <span class="va">per_nonUK</span> <span class="op">+</span> <span class="va">per_social</span></span>
<span></span>
<span><span class="co"># Standardize variables</span></span>
<span><span class="va">vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/allnames.html">all.vars</a></span><span class="op">(</span><span class="va">fm</span><span class="op">)</span></span>
<span><span class="va">msoa_sd.spdf</span> <span class="op">&lt;-</span> <span class="va">msoa.spdf</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">v</span> <span class="kw">in</span> <span class="va">vars</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">msoa_sd.spdf</span><span class="op">[</span>, <span class="va">v</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">msoa_sd.spdf</span><span class="op">[</span>, <span class="va">v</span>, drop <span class="op">=</span> <span class="cn">TRUE</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Estimate the models</span></span>
<span><span class="va">mod_1.ols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">fm</span>, data <span class="op">=</span> <span class="va">msoa_sd.spdf</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Spatial autoregressive model</span></span>
<span><span class="va">mod_1.sar</span> <span class="op">&lt;-</span> <span class="fu">lagsarlm</span><span class="op">(</span><span class="va">fm</span>,  </span>
<span>                      data <span class="op">=</span> <span class="va">msoa_sd.spdf</span>, </span>
<span>                      listw <span class="op">=</span> <span class="va">queens.lw</span>,</span>
<span>                      Durbin <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># we could here extend to SDM</span></span>
<span></span>
<span><span class="co"># Spatial error model</span></span>
<span><span class="va">mod_1.sem</span> <span class="op">&lt;-</span> <span class="fu">errorsarlm</span><span class="op">(</span><span class="va">fm</span>,  </span>
<span>                        data <span class="op">=</span> <span class="va">msoa_sd.spdf</span>, </span>
<span>                        listw <span class="op">=</span> <span class="va">queens.lw</span>,</span>
<span>                        Durbin <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># we could here extend to SDEM</span></span>
<span></span>
<span><span class="co"># SLX</span></span>
<span><span class="va">mod_1.slx</span> <span class="op">&lt;-</span> <span class="fu">lmSLX</span><span class="op">(</span><span class="va">fm</span>,  </span>
<span>                   data <span class="op">=</span> <span class="va">msoa_sd.spdf</span>, </span>
<span>                   listw <span class="op">=</span> <span class="va">queens.lw</span>, </span>
<span>                   Durbin <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># use a formula to lag only specific covariates</span></span>
<span></span>
<span><span class="co"># Spatial Durbin</span></span>
<span><span class="va">mod_1.sdm</span> <span class="op">&lt;-</span> <span class="fu">lagsarlm</span><span class="op">(</span><span class="va">fm</span>,  </span>
<span>                      data <span class="op">=</span> <span class="va">msoa_sd.spdf</span>, </span>
<span>                      listw <span class="op">=</span> <span class="va">queens.lw</span>,</span>
<span>                      Durbin <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># we could here extend to SDM</span></span>
<span></span>
<span><span class="co"># Spatial Durbun Error</span></span>
<span><span class="va">mod_1.sdem</span> <span class="op">&lt;-</span> <span class="fu">errorsarlm</span><span class="op">(</span><span class="va">fm</span>,  </span>
<span>                        data <span class="op">=</span> <span class="va">msoa_sd.spdf</span>, </span>
<span>                        listw <span class="op">=</span> <span class="va">queens.lw</span>,</span>
<span>                        Durbin <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># we could here extend to SDEM</span></span>
<span></span>
<span></span>
<span><span class="co">### Coefficient Output</span></span>
<span><span class="co"># Get AIC and N for all models to get common gof stats</span></span>
<span><span class="va">aic.l</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">mod_1.ols</span>, <span class="va">mod_1.sar</span>, <span class="va">mod_1.sem</span>, <span class="va">mod_1.slx</span>, <span class="va">mod_1.sdm</span>, <span class="va">mod_1.sdem</span><span class="op">)</span>,</span>
<span>       FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/AIC.html">AIC</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">n.l</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">mod_1.ols</span>, <span class="va">mod_1.sar</span>, <span class="va">mod_1.sem</span>, <span class="va">mod_1.slx</span>, <span class="va">mod_1.sdm</span>, <span class="va">mod_1.sdem</span><span class="op">)</span>,</span>
<span>       FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create table</span></span>
<span><span class="va">mod_1.slx.lm</span> <span class="op">&lt;-</span> <span class="va">mod_1.slx</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">mod_1.slx.lm</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"lm"</span> <span class="co"># only for gofs</span></span>
<span><span class="co"># screenreg(list(mod_1.ols, mod_1.sar, mod_1.sem, mod_1.slx.lm, mod_1.sdm, mod_1.sdem),</span></span>
<span><span class="co">#           custom.coef.map = list('(Intercept)' =  '(Intercept)',</span></span>
<span><span class="co">#                                  'park_kmsq' =  'Green space',</span></span>
<span><span class="co">#                                  'pt_access_index' =  'Public transport access',</span></span>
<span><span class="co">#                                  'POPDEN' =  'Population density',</span></span>
<span><span class="co">#                                  'per_nonUK' =  '% non-UK',</span></span>
<span><span class="co">#                                  'per_social' = '% social housing',</span></span>
<span><span class="co">#                                  'lag.park_kmsq' =  'W Green space',</span></span>
<span><span class="co">#                                  'lag.pt_access_index' =  'W Public transport access',</span></span>
<span><span class="co">#                                  'lag.POPDEN' =  'W Population density',</span></span>
<span><span class="co">#                                  'lag.per_nonUK' =  'W % non-UK',</span></span>
<span><span class="co">#                                  'lag.per_social' = 'W % social housing',</span></span>
<span><span class="co">#                                  'rho' = 'rho',</span></span>
<span><span class="co">#                                  'lambda' = 'lambda'),</span></span>
<span><span class="co">#           custom.model.names = c("OLS", "SAR", "SEM", "SLX", "SDM", "SDEM"),</span></span>
<span><span class="co">#           dcolumn = TRUE, caption.above = TRUE, digits = 3,</span></span>
<span><span class="co">#           caption = "Spatial regression models. Outcome variable: median house price.",</span></span>
<span><span class="co">#           include.nobs = FALSE,</span></span>
<span><span class="co">#   include.loglik = FALSE,</span></span>
<span><span class="co">#   include.aic = FALSE,</span></span>
<span><span class="co">#   include.lr = TRUE,</span></span>
<span><span class="co">#   include.wald = FALSE,</span></span>
<span><span class="co">#   include.fstatistic = FALSE,</span></span>
<span><span class="co">#   include.rmse = FALSE,</span></span>
<span><span class="co">#   custom.gof.rows = list('Num. obs.' = n.l, </span></span>
<span><span class="co">#                          'AIC' = aic.l), </span></span>
<span><span class="co">#   reorder.gof = c(1, 3:6, 2))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">wordreg</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">mod_1.ols</span>, <span class="va">mod_1.sar</span>, <span class="va">mod_1.sem</span>, <span class="va">mod_1.slx.lm</span>, <span class="va">mod_1.sdm</span>, <span class="va">mod_1.sdem</span><span class="op">)</span>,</span>
<span>        file <span class="op">=</span> <span class="st">"fig/Regression.doc"</span>,</span>
<span>          custom.coef.map <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">'(Intercept)'</span> <span class="op">=</span>  <span class="st">'(Intercept)'</span>,</span>
<span>                                 <span class="st">'park_kmsq'</span> <span class="op">=</span>  <span class="st">'Green space'</span>,</span>
<span>                                 <span class="st">'pt_access_index'</span> <span class="op">=</span>  <span class="st">'Public transport access'</span>,</span>
<span>                                 <span class="st">'POPDEN'</span> <span class="op">=</span>  <span class="st">'Population density'</span>,</span>
<span>                                 <span class="st">'per_nonUK'</span> <span class="op">=</span>  <span class="st">'Percent non-UK'</span>,</span>
<span>                                 <span class="st">'per_social'</span> <span class="op">=</span> <span class="st">'Percent social housing'</span>,</span>
<span>                                 <span class="st">'lag.park_kmsq'</span> <span class="op">=</span>  <span class="st">'W Green space'</span>,</span>
<span>                                 <span class="st">'lag.pt_access_index'</span> <span class="op">=</span>  <span class="st">'W Public transport access'</span>,</span>
<span>                                 <span class="st">'lag.POPDEN'</span> <span class="op">=</span>  <span class="st">'W Population density'</span>,</span>
<span>                                 <span class="st">'lag.per_nonUK'</span> <span class="op">=</span>  <span class="st">'W Percent non-UK'</span>,</span>
<span>                                 <span class="st">'lag.per_social'</span> <span class="op">=</span> <span class="st">'W Percent social housing'</span>,</span>
<span>                                 <span class="st">'rho'</span> <span class="op">=</span> <span class="st">'rho'</span>,</span>
<span>                                 <span class="st">'lambda'</span> <span class="op">=</span> <span class="st">'lambda'</span><span class="op">)</span>,</span>
<span>          custom.model.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"OLS"</span>, <span class="st">"SAR"</span>, <span class="st">"SEM"</span>, <span class="st">"SLX"</span>, <span class="st">"SDM"</span>, <span class="st">"SDEM"</span><span class="op">)</span>,</span>
<span>          dcolumn <span class="op">=</span> <span class="cn">TRUE</span>, caption.above <span class="op">=</span> <span class="cn">TRUE</span>, digits <span class="op">=</span> <span class="fl">3</span>,</span>
<span>          caption <span class="op">=</span> <span class="st">"Spatial regression models. Outcome variable: median house price."</span>,</span>
<span>          include.nobs <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  include.loglik <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  include.aic <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  include.lr <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  include.wald <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  include.fstatistic <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  include.rmse <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  custom.gof.rows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">'Num. obs.'</span> <span class="op">=</span> <span class="va">n.l</span>, </span>
<span>                         <span class="st">'AIC'</span> <span class="op">=</span> <span class="va">aic.l</span><span class="op">)</span>, </span>
<span>  reorder.gof <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">6</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">texreg</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">mod_1.ols</span>, <span class="va">mod_1.sar</span>, <span class="va">mod_1.sem</span>, <span class="va">mod_1.slx.lm</span>, <span class="va">mod_1.sdm</span>, <span class="va">mod_1.sdem</span><span class="op">)</span>,</span>
<span>        file <span class="op">=</span> <span class="st">"fig/Regression.tex"</span>,</span>
<span>          custom.coef.map <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">'(Intercept)'</span> <span class="op">=</span>  <span class="st">'(Intercept)'</span>,</span>
<span>                                 <span class="st">'park_kmsq'</span> <span class="op">=</span>  <span class="st">'Green space'</span>,</span>
<span>                                 <span class="st">'pt_access_index'</span> <span class="op">=</span>  <span class="st">'Public transport access'</span>,</span>
<span>                                 <span class="st">'POPDEN'</span> <span class="op">=</span>  <span class="st">'Population density'</span>,</span>
<span>                                 <span class="st">'per_nonUK'</span> <span class="op">=</span>  <span class="st">'Percent non-UK'</span>,</span>
<span>                                 <span class="st">'per_social'</span> <span class="op">=</span> <span class="st">'Percent social housing'</span>,</span>
<span>                                 <span class="st">'lag.park_kmsq'</span> <span class="op">=</span>  <span class="st">'W Green space'</span>,</span>
<span>                                 <span class="st">'lag.pt_access_index'</span> <span class="op">=</span>  <span class="st">'W Public transport access'</span>,</span>
<span>                                 <span class="st">'lag.POPDEN'</span> <span class="op">=</span>  <span class="st">'W Population density'</span>,</span>
<span>                                 <span class="st">'lag.per_nonUK'</span> <span class="op">=</span>  <span class="st">'W Percent non-UK'</span>,</span>
<span>                                 <span class="st">'lag.per_social'</span> <span class="op">=</span> <span class="st">'W Percent social housing'</span>,</span>
<span>                                 <span class="st">'rho'</span> <span class="op">=</span> <span class="st">'rho'</span>,</span>
<span>                                 <span class="st">'lambda'</span> <span class="op">=</span> <span class="st">'lambda'</span><span class="op">)</span>,</span>
<span>          custom.model.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"OLS"</span>, <span class="st">"SAR"</span>, <span class="st">"SEM"</span>, <span class="st">"SLX"</span>, <span class="st">"SDM"</span>, <span class="st">"SDEM"</span><span class="op">)</span>,</span>
<span>          dcolumn <span class="op">=</span> <span class="cn">TRUE</span>, caption.above <span class="op">=</span> <span class="cn">TRUE</span>, digits <span class="op">=</span> <span class="fl">3</span>, use.packages <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>          caption <span class="op">=</span> <span class="st">"Spatial regression models. Outcome variable: median house price."</span>,</span>
<span>          include.nobs <span class="op">=</span> <span class="cn">FALSE</span>, fontsize <span class="op">=</span> <span class="st">"scriptsize"</span>,</span>
<span>  include.loglik <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  include.aic <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  include.lr <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  include.wald <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  include.fstatistic <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  include.rmse <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  custom.gof.rows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">'Num. obs.'</span> <span class="op">=</span> <span class="va">n.l</span>, </span>
<span>                         <span class="st">'AIC'</span> <span class="op">=</span> <span class="va">aic.l</span><span class="op">)</span>, </span>
<span>  reorder.gof <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">6</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tbl-results" class="cell tbl-parent quarto-layout-panel anchored" data-tbl-cap="Regression Coefficients Dependent variable: Median house prices.">
<div class="panel-caption table-caption">
<p><strong>?(caption)</strong></p>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">

<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
Spatial regression models. Outcome variable: median house price.
</div>
</div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">

</div>
</div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div></div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">

</div>
</div><table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;color: #000000;border-top: 2px solid #000000;">
<caption>
</caption>




<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</th>


<th style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
OLS
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</th>


<th style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
SAR
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</th>


<th style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
SEM
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</th>


<th style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
SLX
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</th>


<th style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
SDM
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</th>


<th style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
SDEM
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</th>



</tr>



</thead>


<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
(Intercept)
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
0.000
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
-0.012
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
0.022
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
0.007
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
0.002
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
0.007
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>



</tr>


<tr>
<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
(0.027)
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
(0.017)
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
(0.139)
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
(0.024)
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
(0.015)
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
(0.103)
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>



</tr>


<tr>
<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
Green space
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
0.204<sup>***</sup>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
0.133<sup>***</sup>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
0.100<sup>***</sup>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
0.136<sup>***</sup>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
0.106<sup>***</sup>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
0.111<sup>***</sup>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>



</tr>


<tr>
<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
(0.029)
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
(0.018)
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
(0.015)
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
(0.026)
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
(0.016)
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
(0.020)
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>



</tr>


<tr>
<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
Public transport access
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
0.366<sup>***</sup>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
0.097<sup>***</sup>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
-0.054
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
-0.152<sup>**</sup>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
-0.100<sup>**</sup>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
-0.042
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>



</tr>


<tr>
<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
(0.033)
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
(0.021)
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
(0.033)
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
(0.054)
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
(0.034)
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
(0.033)
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>



</tr>


<tr>
<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
Population density
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
0.189<sup>***</sup>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
0.055<sup>*</sup>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
-0.094<sup>***</sup>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
-0.112<sup>*</sup>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
-0.111<sup>***</sup>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
-0.099<sup>***</sup>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>



</tr>


<tr>
<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
(0.037)
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
(0.023)
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
(0.027)
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
(0.044)
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
(0.028)
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
(0.029)
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>



</tr>


<tr>
<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
Percent non-UK
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
-0.033
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
-0.050<sup>*</sup>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
-0.250<sup>***</sup>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
-0.235<sup>***</sup>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
-0.262<sup>***</sup>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
-0.232<sup>***</sup>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>



</tr>


<tr>
<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
(0.033)
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
(0.020)
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
(0.033)
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
(0.053)
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
(0.033)
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
(0.032)
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>



</tr>


<tr>
<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
Percent social housing
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
-0.402<sup>***</sup>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
-0.202<sup>***</sup>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
-0.260<sup>***</sup>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
-0.306<sup>***</sup>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
-0.266<sup>***</sup>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
-0.282<sup>***</sup>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>



</tr>


<tr>
<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
(0.032)
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
(0.020)
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
(0.022)
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
(0.035)
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
(0.022)
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
(0.024)
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>



</tr>


<tr>
<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
W Green space
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
0.249<sup>***</sup>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
-0.029
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
0.050
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>



</tr>


<tr>
<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
(0.040)
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
(0.026)
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
(0.043)
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>



</tr>


<tr>
<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
W Public transport access
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
0.696<sup>***</sup>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
0.239<sup>***</sup>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
0.273<sup>***</sup>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>



</tr>


<tr>
<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
(0.069)
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
(0.045)
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
(0.073)
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>



</tr>


<tr>
<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
W Population density
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
0.455<sup>***</sup>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
0.136<sup>***</sup>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
-0.043
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>



</tr>


<tr>
<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
(0.065)
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
(0.041)
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
(0.075)
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>



</tr>


<tr>
<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
W Percent non-UK
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
0.304<sup>***</sup>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
0.300<sup>***</sup>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
0.242<sup>***</sup>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>



</tr>


<tr>
<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
(0.066)
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
(0.042)
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
(0.070)
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>



</tr>


<tr>
<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
W Percent social housing
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
-0.352<sup>***</sup>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
0.119<sup>***</sup>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
-0.135<sup>*</sup>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>



</tr>


<tr>
<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
(0.053)
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
(0.035)
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
(0.063)
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>



</tr>


<tr>
<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
rho
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
0.786<sup>***</sup>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
0.792<sup>***</sup>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>



</tr>


<tr>
<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
(0.020)
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
(0.022)
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>



</tr>


<tr>
<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
lambda
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
0.890<sup>***</sup>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
0.852<sup>***</sup>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>



</tr>


<tr>
<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
(0.015)
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
(0.019)
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>



</tr>


<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
Num. obs.
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
983
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
983
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
983
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
983
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
983
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
983
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>



</tr>


<tr>
<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
R<sup>2</sup>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
0.263
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
0.439
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>



</tr>


<tr>
<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
Adj. R<sup>2</sup>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
0.259
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
0.433
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>



</tr>


<tr>
<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
LR test: statistic
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
789.480
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
934.291
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
732.684
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
695.097
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>



</tr>


<tr>
<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
LR test: p-value
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
0.000
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
0.000
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
&nbsp;
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
0.000
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
0.000
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>



</tr>


<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
AIC
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
2502.492
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
1715.012
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
1570.201
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
2244.135
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
1513.451
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>


<td style="padding-left: 5px;padding-right: 5px;">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
1551.038
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>



</tr>



</tbody>


<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="7">


<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<sup>***</sup>p &lt; 0.001; <sup>**</sup>p &lt; 0.01; <sup>*</sup>p &lt; 0.05
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
</div>
</div>
</td>



</tr>



</tfoot>



</table>
</div>
</div>
</div>
<p>Compared to results from conventional non-spatial models, Table 1 comes with several additions: First, variables starting with a “W” (or “lag”) indicate the spatially lagged variable or in the case of row-normalized weights matrices the average value of the respective variable across the local neighbours. Moreover, there are two auto-regressive parameters: “rho” for the estimated auto-correlation in the dependent variable and “lambda” for the estimated auto-correlation in the error term. In case of the SAR, a highly significant <span class="math inline">\(\hat\rho\)</span> coefficient of 0.786 indicates strong positive spatial auto-correlation in the median house price: the house price in adjacent areas positively impacts the focal house prices. A <span class="math inline">\(\hat\lambda\)</span> of 0.89 in the SEM however indicates that there is very strong spatial auto-correlation among the (remaining) error variance. The likelihood ratio test in the goodness-of-fit statistics are highly significant in both cases, rejecting the NULL of no spatial auto-autocorrelation.</p>
<p>Given the strong positive auto-correlation in the dependent variable in SAR and SDM, we cannot directly interpret the coefficients as marginal effects. Similar to auto-regressive temporal models, we need to account for the spatial multiplier effect. For SEM, SLX and SDEM, we could directly interpret the coefficients of Table 1. However, we plot the impacts of all five models in Figure <a href="#fig-coefs">Figure&nbsp;<span>12.2</span></a> for reasons of comparison. Note that SEM only has direct and no indirect impacts.</p>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Get direct and indirect impacts</span></span>
<span><span class="va">mod.l</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">mod_1.sar</span>, <span class="va">mod_1.slx</span>, <span class="va">mod_1.sdm</span>, <span class="va">mod_1.sdem</span><span class="op">)</span></span>
<span><span class="va">imp.l</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">vector</a></span><span class="op">(</span>mode <span class="op">=</span> <span class="st">"list"</span>, length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">mod.l</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">mod.l</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">imp.l</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">spatialreg</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spatialreg/reference/impacts.html">impacts</a></span><span class="op">(</span><span class="va">mod.l</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, listw <span class="op">=</span> <span class="va">queens.lw</span>, R <span class="op">=</span> <span class="fl">600</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Add SEM</span></span>
<span></span>
<span></span>
<span><span class="co"># Extract summary measures</span></span>
<span><span class="va">extract.imp</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">x</span>, zstats <span class="op">=</span> <span class="cn">TRUE</span>, short <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="va">names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"bnames"</span><span class="op">)</span></span>
<span>  <span class="va">l</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">names</span><span class="op">)</span></span>
<span>  <span class="va">effs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Direct"</span>, <span class="st">"Indirect"</span>, <span class="st">"Total"</span><span class="op">)</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"type"</span><span class="op">)</span> <span class="op">==</span> <span class="st">"lag"</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"type"</span><span class="op">)</span> <span class="op">==</span> <span class="st">"mixed"</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">coefs</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">s</span><span class="op">$</span><span class="va">res</span><span class="op">$</span><span class="va">direct</span>, <span class="va">s</span><span class="op">$</span><span class="va">res</span><span class="op">$</span><span class="va">indirect</span>, <span class="va">s</span><span class="op">$</span><span class="va">res</span><span class="op">$</span><span class="va">total</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="kw">else</span><span class="op">{</span></span>
<span>    <span class="va">coefs</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">s</span><span class="op">$</span><span class="va">impacts</span><span class="op">$</span><span class="va">direct</span>, <span class="va">s</span><span class="op">$</span><span class="va">impacts</span><span class="op">$</span><span class="va">indirect</span>, <span class="va">s</span><span class="op">$</span><span class="va">impacts</span><span class="op">$</span><span class="va">total</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">names</span>, <span class="fl">3</span><span class="op">)</span>, </span>
<span>                    eff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">effs</span>, each <span class="op">=</span> <span class="va">l</span><span class="op">)</span>,</span>
<span>                    coef <span class="op">=</span> <span class="va">coefs</span>,</span>
<span>                    se <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">s</span><span class="op">$</span><span class="va">semat</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">s</span><span class="op">$</span><span class="va">semat</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, <span class="va">s</span><span class="op">$</span><span class="va">semat</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                    pval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">s</span><span class="op">$</span><span class="va">pzmat</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">s</span><span class="op">$</span><span class="va">pzmat</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, <span class="va">s</span><span class="op">$</span><span class="va">pzmat</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">mods</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"SAR"</span>, <span class="st">"SLX"</span>, <span class="st">"SDM"</span>, <span class="st">"SDEM"</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">imp.l</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu">extract.imp</span><span class="op">(</span><span class="va">imp.l</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">tmp</span><span class="op">$</span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="va">mods</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">i</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">imp.res</span> <span class="op">&lt;-</span> <span class="va">tmp</span></span>
<span>  <span class="op">}</span><span class="kw">else</span><span class="op">{</span></span>
<span>    <span class="va">imp.res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">imp.res</span>, <span class="va">tmp</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span><span class="op">}</span> </span>
<span></span>
<span><span class="co"># Add SEM</span></span>
<span><span class="va">sem.coefs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod_1.sem</span><span class="op">)</span><span class="op">$</span><span class="va">Coef</span><span class="op">[</span>,<span class="op">-</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">sem.coefs</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"coef"</span>, <span class="st">"se"</span>, <span class="st">"pval"</span><span class="op">)</span></span>
<span><span class="va">sem.df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">sem.coefs</span><span class="op">)</span>,</span>
<span>                     eff <span class="op">=</span> <span class="st">"Direct"</span>,</span>
<span>                     <span class="va">sem.coefs</span>,</span>
<span>                     mod <span class="op">=</span> <span class="st">"SEM"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">imp.res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">imp.res</span>, <span class="va">sem.df</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">### Plot the effects</span></span>
<span></span>
<span><span class="co"># Coef Labels</span></span>
<span><span class="va">imp.res</span><span class="op">$</span><span class="va">lab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%.3f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">imp.res</span><span class="op">$</span><span class="va">coef</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># # Add stars</span></span>
<span><span class="co"># imp.res$lab[imp.res$pval &lt;= 0.1 &amp; imp.res$pval &gt; 0.05] &lt;- paste0(imp.res$lab[imp.res$pval &lt;= 0.1 &amp; imp.res$pval &gt; 0.05], expression("\u2020"))</span></span>
<span><span class="co"># imp.res$lab[imp.res$pval &lt;= 0.05 &amp; imp.res$pval &gt; 0.01] &lt;- paste0(imp.res$lab[imp.res$pval &lt;= 0.05 &amp; imp.res$pval &gt; 0.01], "*")</span></span>
<span><span class="co"># imp.res$lab[imp.res$pval &lt;= 0.01 &amp; imp.res$pval &gt; 0.001] &lt;- paste0(imp.res$lab[imp.res$pval &lt;= 0.01 &amp; imp.res$pval &gt; 0.001], "**")</span></span>
<span><span class="co"># imp.res$lab[imp.res$pval &lt;= 0.001] &lt;- paste0(imp.res$lab[imp.res$pval &lt;= 0.001], "***")</span></span>
<span></span>
<span><span class="co"># # Get rid of leading zero</span></span>
<span><span class="co"># imp.res$lab &lt;- gsub("0\\.", " \\.", imp.res$lab)</span></span>
<span></span>
<span><span class="co"># Confidence intervals</span></span>
<span><span class="va">interval2</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="fl">0.95</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>  <span class="co"># 95% multiplier</span></span>
<span><span class="va">imp.res</span><span class="op">$</span><span class="va">lb</span> <span class="op">&lt;-</span> <span class="va">imp.res</span><span class="op">$</span><span class="va">coef</span> <span class="op">-</span> <span class="va">imp.res</span><span class="op">$</span><span class="va">se</span> <span class="op">*</span> <span class="va">interval2</span></span>
<span><span class="va">imp.res</span><span class="op">$</span><span class="va">ub</span> <span class="op">&lt;-</span> <span class="va">imp.res</span><span class="op">$</span><span class="va">coef</span> <span class="op">+</span> <span class="va">imp.res</span><span class="op">$</span><span class="va">se</span> <span class="op">*</span> <span class="va">interval2</span></span>
<span></span>
<span><span class="co"># Rename variables</span></span>
<span><span class="va">names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">'park_kmsq'</span> <span class="op">=</span>  <span class="st">'Green space'</span>,</span>
<span>               <span class="st">'pt_access_index'</span> <span class="op">=</span>  <span class="st">'Public transport access'</span>,</span>
<span>               <span class="st">'POPDEN'</span> <span class="op">=</span>  <span class="st">'Population density'</span>,</span>
<span>               <span class="st">'per_nonUK'</span> <span class="op">=</span>  <span class="st">'Percent non-UK'</span>,</span>
<span>               <span class="st">'per_social'</span> <span class="op">=</span> <span class="st">'Percent social housing'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">imp.res</span><span class="op">$</span><span class="va">var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">imp.res</span><span class="op">$</span><span class="va">var</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">names</span><span class="op">)</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="va">names</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">imp.res</span><span class="op">$</span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">imp.res</span><span class="op">$</span><span class="va">mod</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"SAR"</span>, <span class="st">"SEM"</span>, <span class="st">"SLX"</span>, <span class="st">"SDM"</span>, <span class="st">"SDEM"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot</span></span>
<span><span class="va">zp_all</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">imp.res</span><span class="op">[</span><span class="va">imp.res</span><span class="op">$</span><span class="va">eff</span> <span class="op">!=</span> <span class="st">"Total"</span>, <span class="op">]</span>, <span class="fu">aes</span><span class="op">(</span>colour <span class="op">=</span> <span class="va">mod</span>, shape <span class="op">=</span> <span class="va">mod</span>, fill <span class="op">=</span> <span class="va">mod</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">.</span> <span class="op">~</span> <span class="va">eff</span>, scales <span class="op">=</span> <span class="st">"free_x"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, colour <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/alpha.html">alpha</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="fl">0.3</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_pointrange</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">var</span>, y <span class="op">=</span> <span class="va">coef</span>, ymin <span class="op">=</span> <span class="va">lb</span>, ymax <span class="op">=</span> <span class="va">ub</span><span class="op">)</span>,</span>
<span>                                   lwd <span class="op">=</span> <span class="fl">0.7</span>, position <span class="op">=</span> <span class="fu">position_dodge</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">1.4</span><span class="op">)</span>,</span>
<span>                                   fill <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_text</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>label <span class="op">=</span> <span class="va">lab</span>,</span>
<span>                x <span class="op">=</span> <span class="va">var</span>, </span>
<span>                y <span class="op">=</span> <span class="va">coef</span><span class="op">)</span>, </span>
<span>            size <span class="op">=</span> <span class="fl">3.0</span>, show.legend  <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>            vjust <span class="op">=</span> <span class="op">-</span><span class="fl">0.35</span>, hjust <span class="op">=</span> <span class="op">-</span><span class="fl">0.035</span>, position <span class="op">=</span> <span class="fu">position_dodge</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">1.4</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_flip</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_discrete</span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.1</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Impacts on house price"</span>, x <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_shape_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">18</span>, <span class="fl">19</span>, <span class="fl">17</span>, <span class="fl">15</span>, <span class="fl">25</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_viridis_d</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_viridis_d</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">13</span><span class="op">)</span>,</span>
<span>                         legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>                         legend.background <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>                         legend.box.background <span class="op">=</span> <span class="fu">element_rect</span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>,</span>
<span>                         legend.key <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>                         axis.text.y <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>colour<span class="op">=</span><span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">13</span><span class="op">)</span>,</span>
<span>                         axis.title.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>colour<span class="op">=</span><span class="st">"black"</span><span class="op">)</span>,</span>
<span>                         axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>colour<span class="op">=</span><span class="st">"black"</span><span class="op">)</span>,</span>
<span>                         strip.background <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>                         strip.text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">13</span>, colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>,</span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">guides</span><span class="op">(</span>colour <span class="op">=</span> <span class="fu">guide_legend</span><span class="op">(</span>override.aes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>linetype <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>, reverse <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>                          shape <span class="op">=</span> <span class="fu">guide_legend</span><span class="op">(</span>reverse <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/cairo.html">cairo_ps</a></span><span class="op">(</span>file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"fig/"</span>, <span class="st">"Coefplot.eps"</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">8</span>, height <span class="op">=</span> <span class="fl">6</span>, </span>
<span>          bg <span class="op">=</span> <span class="st">"white"</span>, family <span class="op">=</span> <span class="st">"Times New Roman"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, oma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">zp_all</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/png.html">jpeg</a></span><span class="op">(</span>file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"fig/"</span>, <span class="st">"Coefplot.jpeg"</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">8</span>, height <span class="op">=</span> <span class="fl">6</span>, </span>
<span>    units <span class="op">=</span> <span class="st">"in"</span>, res <span class="op">=</span> <span class="fl">300</span>, type <span class="op">=</span> <span class="st">"cairo"</span>,</span>
<span>          bg <span class="op">=</span> <span class="st">"white"</span>, family <span class="op">=</span> <span class="st">"Times New Roman"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, oma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">zp_all</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="fig-coefs" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="fig/Coefplot.jpeg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;12.2: Direct and indirect impacts from spatial regression models. Dependent variable: mean house prices. All vairables are standardised.</figcaption></figure>
</div>
<p>We start with the results of the SAR model in Figure <a href="#fig-coefs">Figure&nbsp;<span>12.2</span></a>. A one standard-deviation increase of green space in the focal unit is associated with a 0.161 standard deviation increase in house prices within the same spatial unit. However, there are also highly significant diffusion processes. This increase in green space in the focal unit will also increase house prices in neighbouring units and the neighbours of these neighbours. This indirect impact will add up to a 0.458 standard deviation increase in house prices across neighbouring units connected through the spatial weights system. Similarly, an increase in public transport accessibility is associated with a 0.118 standard-deviation higher median house price in the unit itself and an additional 0.458 deviation increase diffusing though the neighbouring regions. Note that direct and indirect effects are bound to a common ration, as SAR only estimates one single spatial parameter <span class="math inline">\(\hat\rho\)</span>. In our case, every indirect impact equals approximately 2.83 times the direct impact. This is a very restrictive conditions and a severe drawback of the SAR model.</p>
<p>The SLX - similar to SAR - estimates a positive impact of green space in the focal but also in adjacent neighbourhoods on house prices in the focal unit. A one standard deviation in the focal unit is associated with 0.136 standard-deviations higher house price in the focal unit. If green spaces in adjacent neighbourhoods increase on average by one standard deviation, this would increase house prices in the focal unit by 0.249 standard deviations. Note that the SLX tells a different story about the effect of public transport access than SAR: there is a negative direct and a very strong and positive indirect effect. A one standard deviation increase in public transport access in the focal unit is associated with -0.152 standard deviations lower house prices. In contrast, more public transport in the local surrounding (the average neighbours) is associated with 0.696 standard deviations higher prices. This is in line with the idea that public transport facilities are usually not particularly attractive: it is good to have them close but not too close. The same is true for population density: it is good to live in a broader area with high population density as indicated by the indirect impacts (probability indicating high centrality), but the local neighbourhood should have a low population density as indicated by the negative direct impact.</p>
<p>We could go further with the other models. However, interpretation in SDM follows the same logic as SAR, and interpretation in SDEM aligns to SLX. Interpretation in SEM is analogous to non-spatial OLS, as there are no indirect impacts. Moreover, it is important to keep in mind that the indirect impacts are summary measures which sum over all impacts from or onto neighbouring regions. The indirect public transport effect of 0.696 in SLX would occur if the average public transport access across neighbours would increase by one standard deviation. This only occurs if all neighbours would simultaneously increase public transport access by one standard deviation.</p>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" role="list" style="display: none">
<div id="ref-Anselin.1988" class="csl-entry" role="listitem">
Anselin, Luc. 1988. <em>Spatial <span>Econometrics</span>: <span>Methods</span> and <span>Models</span></em>. Studies in <span>Operational Regional Science</span>. <span>Dordrecht</span>: <span>Kluwer</span>.
</div>
<div id="ref-Anselin.2003" class="csl-entry" role="listitem">
———. 2003. <span>“Spatial <span>Externalities</span>, <span>Spatial Multipliers</span>, and <span>Spatial Econometrics</span>.”</span> <em>International Regional Science Review</em> 26 (2): 153–66. <a href="https://doi.org/10.1177/0160017602250972">https://doi.org/10.1177/0160017602250972</a>.
</div>
<div id="ref-Anselin.1996" class="csl-entry" role="listitem">
Anselin, Luc, Anil K. Bera, Raymond Florax, and Mann J. Yoon. 1996. <span>“Simple <span>Diagnostic Tests</span> for <span>Spatial Dependence</span>.”</span> <em>Regional Science and Urban Economics</em> 26 (1): 77–104. <a href="https://doi.org/10.1016/0166-0462(95)02111-6">https://doi.org/10.1016/0166-0462(95)02111-6</a>.
</div>
<div id="ref-Anselin.2008" class="csl-entry" role="listitem">
Anselin, Luc, and Nancy Lozano-Gracia. 2008. <span>“Errors in <span>Variables</span> and <span>Spatial Effects</span> in <span>Hedonic House Price Models</span> of <span>Ambient Air Quality</span>.”</span> <em>Empirical Economics</em> 34 (1): 5–34. <a href="https://doi.org/10.1007/s00181-007-0152-3">https://doi.org/10.1007/s00181-007-0152-3</a>.
</div>
<div id="ref-Anselin.2024" class="csl-entry" role="listitem">
Anselin, Luc, Renan Serenini, and Pedro Amaral. 2024. <span>“Spatial <span>Econometric Model Specification Search</span>: <span>Another Look</span>.”</span> <a href="https://doi.org/10.13140/RG.2.2.10650.86721">https://doi.org/10.13140/RG.2.2.10650.86721</a>.
</div>
<div id="ref-Bivand.2021" class="csl-entry" role="listitem">
Bivand, Roger, Giovanni Millo, and Gianfranco Piras. 2021. <span>“A <span>Review</span> of <span>Software</span> for <span>Spatial Econometrics</span> in <span>R</span>.”</span> <em>Mathematics</em> 9 (11): 1276. <a href="https://doi.org/10.3390/math9111276">https://doi.org/10.3390/math9111276</a>.
</div>
<div id="ref-Burridge.2016" class="csl-entry" role="listitem">
Burridge, Peter, J. Paul Elhorst, and Katarina Zigova. 2016. <span>“Group <span>Interaction</span> in <span>Research</span> and the <span>Use</span> of <span>General Nesting Spatial Models</span>.”</span> In <em>Spatial <span>Econometrics</span>: <span>Qualitative</span> and <span>Limited Dependent Variables</span></em>, edited by Badi H. Baltagi, James P. LeSage, and R. Kelley Pace, 37:223–58. Advances in <span>Econometrics</span>. <span>Emerald Group Publishing Limited</span>. <a href="https://doi.org/10.1108/S0731-905320160000037016">https://doi.org/10.1108/S0731-905320160000037016</a>.
</div>
<div id="ref-Cook.2020" class="csl-entry" role="listitem">
Cook, Scott J., Jude C. Hays, and Robert J. Franzese. 2020. <span>“Model <span>Specification</span> and <span>Spatial Interdependence</span>.”</span> In <em>The <span>Sage</span> Handbook of Research Methods in Political Science and International Relations</em>, edited by Luigi Curini and Robert Franzese, 1st ed, 730–47. <span>Thousand Oaks</span>: <span>SAGE Inc</span>.
</div>
<div id="ref-Elhorst.2014" class="csl-entry" role="listitem">
Elhorst, J. Paul. 2014. <em>Spatial <span>Econometrics</span>: <span>From Cross-Sectional Data</span> to <span>Spatial Panels</span></em>. <span>SpringerBriefs</span> in <span>Regional Science</span>. <span>Berlin and Heidelberg</span>: <span>Springer</span>. <a href="https://doi.org/10.1007/978-3-642-40340-8">https://doi.org/10.1007/978-3-642-40340-8</a>.
</div>
<div id="ref-Elhorst.2017" class="csl-entry" role="listitem">
Elhorst, J. Paul, and S. Halleck Vega. 2017. <span>“The <span>SLX Model</span>: <span>Extensions</span> and the <span>Sensitivity</span> of <span>Spatial Spillovers</span> to <span>W</span>.”</span> <em>Papeles de Economía Española</em> 152: 34–50.
</div>
<div id="ref-Florax.2003" class="csl-entry" role="listitem">
Florax, Raymond, Hendrik Folmer, and Sergio J. Rey. 2003. <span>“Specification <span>Searches</span> in <span>Spatial Econometrics</span>: <span>The Relevance</span> of <span>Hendry</span>’s <span>Methodology</span>.”</span> <em>Regional Science and Urban Economics</em> 33 (5): 557–79. <a href="https://doi.org/10.1016/S0166-0462(03)00002-4">https://doi.org/10.1016/S0166-0462(03)00002-4</a>.
</div>
<div id="ref-Gibbons.2012" class="csl-entry" role="listitem">
Gibbons, Steve, and Henry G. Overman. 2012. <span>“Mostly <span>Pointless Spatial Econometrics</span>?”</span> <em>Journal of Regional Science</em> 52 (2): 172–91. <a href="https://doi.org/10.1111/j.1467-9787.2012.00760.x">https://doi.org/10.1111/j.1467-9787.2012.00760.x</a>.
</div>
<div id="ref-Gibbons.2015" class="csl-entry" role="listitem">
Gibbons, Steve, Henry G. Overman, and Eleonora Patacchini. 2015. <span>“Spatial <span>Methods</span>.”</span> In <em>Handbook of <span>Regional</span> and <span>Urban Economics</span></em>, edited by Gilles Duranton, J. Vernon Henderson, and William C. Strange, 5:115–68. <span>Amsterdam</span>: <span>Elsevier</span>. <a href="https://doi.org/10.1016/B978-0-444-59517-1.00003-9">https://doi.org/10.1016/B978-0-444-59517-1.00003-9</a>.
</div>
<div id="ref-HalleckVega.2015" class="csl-entry" role="listitem">
Halleck Vega, Solmaria, and J. Paul Elhorst. 2015. <span>“The <span>SLX Model</span>.”</span> <em>Journal of Regional Science</em> 55 (3): 339–63. <a href="https://doi.org/10.1111/jors.12188">https://doi.org/10.1111/jors.12188</a>.
</div>
<div id="ref-Kley.2021" class="csl-entry" role="listitem">
Kley, Stefanie, and Tetiana Dovbishchuk. 2021. <span>“How a <span>Lack</span> of <span>Green</span> in the <span>Residential Environment Lowers</span> the <span>Life Satisfaction</span> of <span>City Dwellers</span> and <span>Increases Their Willingness</span> to <span>Relocate</span>.”</span> <em>Sustainability</em> 13 (7): 3984. <a href="https://doi.org/10.3390/su13073984">https://doi.org/10.3390/su13073984</a>.
</div>
<div id="ref-LeSage.2014" class="csl-entry" role="listitem">
LeSage, James P. 2014. <span>“What <span>Regional Scientists Need</span> to <span>Know</span> about <span>Spatial Econometrics</span>.”</span> <em>The Review of Regional Studies</em> 44 (1): 13–32. https://doi.org/<a href="https://dx.doi.org/10.2139/ssrn.2420725">https://dx.doi.org/10.2139/ssrn.2420725</a>.
</div>
<div id="ref-LeSage.2009" class="csl-entry" role="listitem">
LeSage, James P., and R. Kelley Pace. 2009. <em>Introduction to <span>Spatial Econometrics</span></em>. Statistics, <span>Textbooks</span> and <span>Monographs</span>. <span>Boca Raton</span>: <span>CRC Press</span>.
</div>
<div id="ref-Liebe.2023" class="csl-entry" role="listitem">
Liebe, Ulf, Sander van Cranenburgh, and Caspar Chorus. 2023. <span>“Maximizing <span>Utility</span> or <span>Avoiding Losses</span>? <span>Uncovering Decision Rule-Heterogeneity</span> in <span>Sociological Research</span> with an <span>Application</span> to <span>Neighbourhood Choice</span>.”</span> <em>Sociological Methods &amp; Research</em>, July, 00491241231186657. <a href="https://doi.org/10.1177/00491241231186657">https://doi.org/10.1177/00491241231186657</a>.
</div>
<div id="ref-Mur.2009" class="csl-entry" role="listitem">
Mur, Jesús, and Ana Angulo. 2009. <span>“Model <span>Selection Strategies</span> in a <span>Spatial Setting</span>: <span>Some Additional Results</span>.”</span> <em>Regional Science and Urban Economics</em> 39 (2): 200–213. <a href="https://doi.org/10.1016/j.regsciurbeco.2008.05.018">https://doi.org/10.1016/j.regsciurbeco.2008.05.018</a>.
</div>
<div id="ref-Pebesma.2023" class="csl-entry" role="listitem">
Pebesma, Edzer, and Roger Bivand. 2023. <em>Spatial <span>Data Science</span>: <span>With Applications</span> in <span>R</span></em>. First. <span>Boca Raton</span>: <span>Chapman and Hall/CRC</span>. <a href="https://doi.org/10.1201/9780429459016">https://doi.org/10.1201/9780429459016</a>.
</div>
<div id="ref-Pinkse.2010" class="csl-entry" role="listitem">
Pinkse, Joris, and Margaret E. Slade. 2010. <span>“The <span>Future</span> of <span>Spatial Econometrics</span>.”</span> <em>Journal of Regional Science</em> 50 (1): 103–17. <a href="https://doi.org/10.1111/j.1467-9787.2009.00645.x">https://doi.org/10.1111/j.1467-9787.2009.00645.x</a>.
</div>
<div id="ref-Ruttenauer.2022a" class="csl-entry" role="listitem">
Rüttenauer, Tobias. 2022. <span>“Spatial <span>Regression Models</span>: <span>A Systematic Comparison</span> of <span>Different Model Specifications Using Monte Carlo Experiments</span>.”</span> <em>Sociological Methods &amp; Research</em> 51 (2): 728–59. <a href="https://doi.org/10.1177/0049124119882467">https://doi.org/10.1177/0049124119882467</a>.
</div>
<div id="ref-Ruttenauer.2024b" class="csl-entry" role="listitem">
———. 2024. <span>“More Talk, No Action? <span>The</span> Link Between Exposure to Extreme Weather Events, Climate Change Belief and Pro-Environmental Behaviour.”</span> <em>European Societies</em> 26 (4): 1046–70. <a href="https://doi.org/10.1080/14616696.2023.2277281">https://doi.org/10.1080/14616696.2023.2277281</a>.
</div>
</div>
</section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><hr>
<ol>
<li id="fn1"><p>For house prices, see: <a href="https://data.london.gov.uk/dataset/average-house-prices" class="uri">https://data.london.gov.uk/dataset/average-house-prices</a>. For London accessibility scores see: <a href="https://data.london.gov.uk/dataset/public-transport-accessibility-levels" class="uri">https://data.london.gov.uk/dataset/public-transport-accessibility-levels</a><a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>For UK demographics, see: <a href="https://www.nomisweb.co.uk/sources/census_2011" class="uri">https://www.nomisweb.co.uk/sources/census_2011</a><a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./08_exercise3.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Exercises III</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./08_exercise3b.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Exercises IIIb</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb23" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>::: {.content-hidden unless-format="html"}</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>\newcommand{\tr}{\mathrm{tr}}</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>\newcommand{\rank}{\mathrm{rank}}</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>\newcommand{\plim}{\operatornamewithlimits{plim}}</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>\newcommand{\diag}{\mathrm{diag}}</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>\newcommand{\bm}<span class="co">[</span><span class="ot">1</span><span class="co">]</span>{\boldsymbol{\mathbf{#1}}}</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>\newcommand{\Var}{\mathrm{Var}}</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>\newcommand{\Exp}{\mathrm{E}}</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>\newcommand{\Cov}{\mathrm{Cov}}</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>\newcommand\given<span class="co">[</span><span class="ot">1</span><span class="co">][]</span>{\:#1\vert\:}</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>\newcommand{\irow}<span class="co">[</span><span class="ot">1</span><span class="co">]</span>{%</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>\begin{pmatrix}#1\end{pmatrix}</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a><span class="fu"># Comparing and Selecting Models </span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a><span class="fu">### Required packages {.unnumbered}</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message = FALSE, warning = FALSE, results = 'hide'}</span></span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>pkgs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"sf"</span>, <span class="st">"mapview"</span>, <span class="st">"spdep"</span>, <span class="st">"spatialreg"</span>, <span class="st">"tmap"</span>, <span class="st">"viridisLite"</span>) <span class="co"># note: load spdep first, then spatialreg</span></span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(pkgs, require, <span class="at">character.only =</span> <span class="cn">TRUE</span>)</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a><span class="fu">### Session info {.unnumbered}</span></span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a><span class="fu">### Reload data from pervious session {.unnumbered}</span></span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"_data/msoa2_spatial.RData"</span>)</span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a>As we have seen, a variety of spatial model specifications exist that can be used to account for the spatial structure of the data. Thus, selecting the correct model specification remains a crucial task in applied research. For some helpful literature on the issue of model selection see @Anselin.2024, @HalleckVega.2015, @Ruttenauer.2022a</span>
<span id="cb23-46"><a href="#cb23-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-47"><a href="#cb23-47" aria-hidden="true" tabindex="-1"></a>One way of selecting the model specification is the application of empirical specification tests. In general, there are two different strategies: a specific-to-general or a general-to-specific approach <span class="co">[</span><span class="ot">@Florax.2003; @Mur.2009</span><span class="co">]</span>.</span>
<span id="cb23-48"><a href="#cb23-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-49"><a href="#cb23-49" aria-hidden="true" tabindex="-1"></a><span class="fu">## Specific-to-general</span></span>
<span id="cb23-50"><a href="#cb23-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-51"><a href="#cb23-51" aria-hidden="true" tabindex="-1"></a>The specific-to-general approach is more common in spatial econometrics. This approach starts with the most basic non-spatial model and tests for possible misspecification due to omitted autocorrelation in the error term or the dependent variable.</span>
<span id="cb23-52"><a href="#cb23-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-53"><a href="#cb23-53" aria-hidden="true" tabindex="-1"></a>@Anselin.1996 proposed to use Lagrange multiplier (LM) tests for the hypotheses $H_0$: $\lambda=0$ and $H_0$: $\rho=0$, which are robust against the alternative source of spatial dependence.</span>
<span id="cb23-54"><a href="#cb23-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-55"><a href="#cb23-55" aria-hidden="true" tabindex="-1"></a><span class="fu">### Lagrange Multiplier Test</span></span>
<span id="cb23-56"><a href="#cb23-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-57"><a href="#cb23-57" aria-hidden="true" tabindex="-1"></a>We have earlier talked about methods to detect auto-correlation -- visualisation and Moran's I. Both methods can tell us that there is spatial autocorrelation. However, both method do not provide any information on why there is autocorrelation. Possible reasons:</span>
<span id="cb23-58"><a href="#cb23-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-59"><a href="#cb23-59" aria-hidden="true" tabindex="-1"></a><span class="ss">-  </span>Interdependence ($\rho$)</span>
<span id="cb23-60"><a href="#cb23-60" aria-hidden="true" tabindex="-1"></a><span class="ss">-  </span>Clustering on unobservables ($\lambda$)</span>
<span id="cb23-61"><a href="#cb23-61" aria-hidden="true" tabindex="-1"></a><span class="ss">-  </span>Spillovers in covariates ($\bm \theta$)</span>
<span id="cb23-62"><a href="#cb23-62" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-63"><a href="#cb23-63" aria-hidden="true" tabindex="-1"></a>Lagrange Multiplier test <span class="co">[</span><span class="ot">@Anselin.1996</span><span class="co">]</span>:</span>
<span id="cb23-64"><a href="#cb23-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-65"><a href="#cb23-65" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>(Robust) test for spatial lag dependence $LM_\rho^*$</span>
<span id="cb23-66"><a href="#cb23-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-67"><a href="#cb23-67" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>(Robust) test for spatial error dependence $LM_\lambda^*$</span>
<span id="cb23-68"><a href="#cb23-68" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-69"><a href="#cb23-69" aria-hidden="true" tabindex="-1"></a>Robust test for lag dependence: $H_0$: $\rho=0$ </span>
<span id="cb23-70"><a href="#cb23-70" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb23-71"><a href="#cb23-71" aria-hidden="true" tabindex="-1"></a>        LM_\rho^* = G^{-1} \hat{\sigma}_\epsilon^2</span>
<span id="cb23-72"><a href="#cb23-72" aria-hidden="true" tabindex="-1"></a>        \big(\frac{ \hat{\bm\epsilon}^\intercal \bm{Wy}}{\hat{\sigma}_\epsilon^2}</span>
<span id="cb23-73"><a href="#cb23-73" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>\frac{\hat{\bm \epsilon}^\intercal \bm{W\hat{\epsilon}}}{\hat{\sigma}_\epsilon^2} \big)^2 \sim \chi^2 </span>
<span id="cb23-74"><a href="#cb23-74" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb23-75"><a href="#cb23-75" aria-hidden="true" tabindex="-1"></a>            <span class="co">&lt;!-- %\\ \text{where } G = (\bm{WX\hat{\beta}})^\intercal (\bm I - \bm X (\bm X^\intercal\bm X)^{-1} \bm X^\intercal) (\bm{WX\hat{\beta}}) --&gt;</span></span>
<span id="cb23-76"><a href="#cb23-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-77"><a href="#cb23-77" aria-hidden="true" tabindex="-1"></a>Robust test for error dependence: $H_0$: $\lambda=0$ </span>
<span id="cb23-78"><a href="#cb23-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-79"><a href="#cb23-79" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb23-80"><a href="#cb23-80" aria-hidden="true" tabindex="-1"></a>        LM_\lambda^* = \frac{</span>
<span id="cb23-81"><a href="#cb23-81" aria-hidden="true" tabindex="-1"></a>        \big( \hat{\bm\epsilon}^\intercal \bm{W\hat{\epsilon}} / \hat{\sigma}_\epsilon^2        </span>
<span id="cb23-82"><a href="#cb23-82" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span><span class="co">[</span><span class="ot">T\hat{\sigma}_\epsilon^2(G + T\hat{\sigma}_\epsilon^2)^{-1}</span><span class="co">]</span></span>
<span id="cb23-83"><a href="#cb23-83" aria-hidden="true" tabindex="-1"></a>         \hat{\bm\epsilon}^\intercal \bm{Wy} / \hat{\sigma}_\epsilon^2 \big)^2</span>
<span id="cb23-84"><a href="#cb23-84" aria-hidden="true" tabindex="-1"></a>        }{</span>
<span id="cb23-85"><a href="#cb23-85" aria-hidden="true" tabindex="-1"></a>        T<span class="co">[</span><span class="ot">1 - \frac{\hat{\sigma}_\epsilon^2}{G + \hat{\sigma}_\epsilon^2}</span><span class="co">]</span></span>
<span id="cb23-86"><a href="#cb23-86" aria-hidden="true" tabindex="-1"></a>        } \sim \chi^2</span>
<span id="cb23-87"><a href="#cb23-87" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb23-88"><a href="#cb23-88" aria-hidden="true" tabindex="-1"></a>with</span>
<span id="cb23-89"><a href="#cb23-89" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb23-90"><a href="#cb23-90" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb23-91"><a href="#cb23-91" aria-hidden="true" tabindex="-1"></a>     G &amp;= (\bm{WX\hat{\beta}})^\intercal (\bm I - \bm X (\bm X^\intercal\bm X)^{-1} \bm X^\intercal) (\bm{WX\hat{\beta}})   <span class="sc">\\</span></span>
<span id="cb23-92"><a href="#cb23-92" aria-hidden="true" tabindex="-1"></a>     T &amp;= \tr<span class="co">[</span><span class="ot">(\bm W^\intercal + \bm W)\bm W</span><span class="co">]</span>, </span>
<span id="cb23-93"><a href="#cb23-93" aria-hidden="true" tabindex="-1"></a>\end{split}     </span>
<span id="cb23-94"><a href="#cb23-94" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb23-95"><a href="#cb23-95" aria-hidden="true" tabindex="-1"></a>where $\tr(\bm A)$ is the sum of the main diagonal of any square matrix $\bm A$.</span>
<span id="cb23-96"><a href="#cb23-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-97"><a href="#cb23-97" aria-hidden="true" tabindex="-1"></a>To perform the test, we first need to run a conventional OLS model. We take yesterdays example.</span>
<span id="cb23-98"><a href="#cb23-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-99"><a href="#cb23-99" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message = FALSE, warning = FALSE, results = 'hide'}</span></span>
<span id="cb23-100"><a href="#cb23-100" aria-hidden="true" tabindex="-1"></a><span class="do">### Load data</span></span>
<span id="cb23-101"><a href="#cb23-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-102"><a href="#cb23-102" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"_data/msoa2_spatial.RData"</span>)</span>
<span id="cb23-103"><a href="#cb23-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-104"><a href="#cb23-104" aria-hidden="true" tabindex="-1"></a><span class="do">### Generate weights</span></span>
<span id="cb23-105"><a href="#cb23-105" aria-hidden="true" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">st_centroid</span>(msoa.spdf)</span>
<span id="cb23-106"><a href="#cb23-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-107"><a href="#cb23-107" aria-hidden="true" tabindex="-1"></a><span class="co"># Neighbours within 3km distance</span></span>
<span id="cb23-108"><a href="#cb23-108" aria-hidden="true" tabindex="-1"></a>dist_15.nb <span class="ot">&lt;-</span> <span class="fu">dnearneigh</span>(coords, <span class="at">d1 =</span> <span class="dv">0</span>, <span class="at">d2 =</span> <span class="dv">2500</span>)</span>
<span id="cb23-109"><a href="#cb23-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-110"><a href="#cb23-110" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dist_15.nb)</span>
<span id="cb23-111"><a href="#cb23-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-112"><a href="#cb23-112" aria-hidden="true" tabindex="-1"></a><span class="co"># There are some empty neighbour sets. Lets impute those with the nearest neighbour.</span></span>
<span id="cb23-113"><a href="#cb23-113" aria-hidden="true" tabindex="-1"></a>k2.nb <span class="ot">&lt;-</span> <span class="fu">knearneigh</span>(coords, <span class="at">k =</span> <span class="dv">1</span>)</span>
<span id="cb23-114"><a href="#cb23-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-115"><a href="#cb23-115" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace zero</span></span>
<span id="cb23-116"><a href="#cb23-116" aria-hidden="true" tabindex="-1"></a>nolink_ids <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">card</span>(dist_15.nb) <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb23-117"><a href="#cb23-117" aria-hidden="true" tabindex="-1"></a>dist_15.nb[<span class="fu">card</span>(dist_15.nb) <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> k2.nb<span class="sc">$</span>nn[nolink_ids, ]</span>
<span id="cb23-118"><a href="#cb23-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-119"><a href="#cb23-119" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dist_15.nb)</span>
<span id="cb23-120"><a href="#cb23-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-121"><a href="#cb23-121" aria-hidden="true" tabindex="-1"></a><span class="co"># listw object with row-normalization</span></span>
<span id="cb23-122"><a href="#cb23-122" aria-hidden="true" tabindex="-1"></a>dist_15.lw <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(dist_15.nb, <span class="at">style =</span> <span class="st">"W"</span>)</span>
<span id="cb23-123"><a href="#cb23-123" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb23-124"><a href="#cb23-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-127"><a href="#cb23-127" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb23-128"><a href="#cb23-128" aria-hidden="true" tabindex="-1"></a>mod_1.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(no2) <span class="sc">~</span> per_mixed <span class="sc">+</span> per_asian <span class="sc">+</span> per_black <span class="sc">+</span> per_other</span>
<span id="cb23-129"><a href="#cb23-129" aria-hidden="true" tabindex="-1"></a>                      <span class="sc">+</span> per_nonUK_EU <span class="sc">+</span> per_nonEU  <span class="sc">+</span> <span class="fu">log</span>(POPDEN),  </span>
<span id="cb23-130"><a href="#cb23-130" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> msoa.spdf)</span>
<span id="cb23-131"><a href="#cb23-131" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_1.lm)</span>
<span id="cb23-132"><a href="#cb23-132" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb23-133"><a href="#cb23-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-134"><a href="#cb23-134" aria-hidden="true" tabindex="-1"></a>Subsequently, we run the robust LM test for Lag dependence:</span>
<span id="cb23-135"><a href="#cb23-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-138"><a href="#cb23-138" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb23-139"><a href="#cb23-139" aria-hidden="true" tabindex="-1"></a>test.lag <span class="ot">&lt;-</span> <span class="fu">lm.RStests</span>(mod_1.lm, </span>
<span id="cb23-140"><a href="#cb23-140" aria-hidden="true" tabindex="-1"></a>                       <span class="at">listw =</span> dist_15.lw, </span>
<span id="cb23-141"><a href="#cb23-141" aria-hidden="true" tabindex="-1"></a>                       <span class="at">test =</span> <span class="st">"adjRSlag"</span>)</span>
<span id="cb23-142"><a href="#cb23-142" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(test.lag)</span>
<span id="cb23-143"><a href="#cb23-143" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb23-144"><a href="#cb23-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-145"><a href="#cb23-145" aria-hidden="true" tabindex="-1"></a>For the robust LM test on spatial error dependence, we run:</span>
<span id="cb23-146"><a href="#cb23-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-149"><a href="#cb23-149" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb23-150"><a href="#cb23-150" aria-hidden="true" tabindex="-1"></a>test.err <span class="ot">&lt;-</span> <span class="fu">lm.RStests</span>(mod_1.lm, </span>
<span id="cb23-151"><a href="#cb23-151" aria-hidden="true" tabindex="-1"></a>                       <span class="at">listw =</span> dist_15.lw, </span>
<span id="cb23-152"><a href="#cb23-152" aria-hidden="true" tabindex="-1"></a>                       <span class="at">test =</span> <span class="st">"adjRSerr"</span>)</span>
<span id="cb23-153"><a href="#cb23-153" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(test.err)</span>
<span id="cb23-154"><a href="#cb23-154" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb23-155"><a href="#cb23-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-156"><a href="#cb23-156" aria-hidden="true" tabindex="-1"></a>In fact, you can compare them all at once:</span>
<span id="cb23-157"><a href="#cb23-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-160"><a href="#cb23-160" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb23-161"><a href="#cb23-161" aria-hidden="true" tabindex="-1"></a>test.all <span class="ot">&lt;-</span> <span class="fu">lm.RStests</span>(mod_1.lm, </span>
<span id="cb23-162"><a href="#cb23-162" aria-hidden="true" tabindex="-1"></a>                       <span class="at">listw =</span> dist_15.lw, </span>
<span id="cb23-163"><a href="#cb23-163" aria-hidden="true" tabindex="-1"></a>                       <span class="at">test =</span> <span class="st">"all"</span>)</span>
<span id="cb23-164"><a href="#cb23-164" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(test.all)</span>
<span id="cb23-165"><a href="#cb23-165" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb23-166"><a href="#cb23-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-167"><a href="#cb23-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-168"><a href="#cb23-168" aria-hidden="true" tabindex="-1"></a>In both cases, the LM test indicates the presence of significance lag dependence and significance error dependence. </span>
<span id="cb23-169"><a href="#cb23-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-170"><a href="#cb23-170" aria-hidden="true" tabindex="-1"></a>::: callout-warning</span>
<span id="cb23-171"><a href="#cb23-171" aria-hidden="true" tabindex="-1"></a><span class="fu">### Take the LM test with a grain of salt</span></span>
<span id="cb23-172"><a href="#cb23-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-173"><a href="#cb23-173" aria-hidden="true" tabindex="-1"></a>**DO NOT** use the above results as a reason to say: "well, there is Lag dependence and there is Error dependence. So, I will use a SAC-like specification". This would usually be a bad choice, as the LM tests assume the absence od any SLX terms.</span>
<span id="cb23-174"><a href="#cb23-174" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb23-175"><a href="#cb23-175" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-176"><a href="#cb23-176" aria-hidden="true" tabindex="-1"></a><span class="fu">### Problem</span></span>
<span id="cb23-177"><a href="#cb23-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-178"><a href="#cb23-178" aria-hidden="true" tabindex="-1"></a>The specific-to-general approach based on the robust LM test offers a good performance in distinguishing between SAR, SEM, and non-spatial OLS <span class="co">[</span><span class="ot">@Florax.2003</span><span class="co">]</span>. </span>
<span id="cb23-179"><a href="#cb23-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-180"><a href="#cb23-180" aria-hidden="true" tabindex="-1"></a>Still, in their original paper, @Anselin.1996 already note the declining power of the robust LM$_\lambda$ test for spatial error dependence with increasing autocorrelation in the dependent variable (indicating some uncertainty under a SAC-like DGP).</span>
<span id="cb23-181"><a href="#cb23-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-182"><a href="#cb23-182" aria-hidden="true" tabindex="-1"></a>@Mur.2009 demonstrate strong drawbacks of the specific-to-general approach under non-optimal conditions like heteroscedasticity or endogeneity.</span>
<span id="cb23-183"><a href="#cb23-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-184"><a href="#cb23-184" aria-hidden="true" tabindex="-1"></a>Moreover, the test disregard the presence of spatial dependence from local spillover effects ($\theta$ is assumed to be zero), as resulting from an SLX-like process. @Cook.2020, for instance, show theoretically that an SLX-like dependence structure leads to the rejection of both hypotheses $H_0$: $\lambda=0$ and $H_0$: $\rho=0$, though no autocorrelation is present <span class="co">[</span><span class="ot">@Elhorst.2017; @Ruttenauer.2022a</span><span class="co">]</span>.</span>
<span id="cb23-185"><a href="#cb23-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-186"><a href="#cb23-186" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip}</span>
<span id="cb23-187"><a href="#cb23-187" aria-hidden="true" tabindex="-1"></a><span class="fu">### Potential solution?</span></span>
<span id="cb23-188"><a href="#cb23-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-189"><a href="#cb23-189" aria-hidden="true" tabindex="-1"></a>In a recent preprint, @Anselin.2024 proposed a two-step test approach ("STGE-Pre"). First, we need to test the presence of any SLX ($\bm W \bm X$) term. If we can omit those terms, we proceed with the robust LM lag test and the robust LM error test.</span>
<span id="cb23-190"><a href="#cb23-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-191"><a href="#cb23-191" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb23-192"><a href="#cb23-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-193"><a href="#cb23-193" aria-hidden="true" tabindex="-1"></a><span class="fu">## General-to-specific approach</span></span>
<span id="cb23-194"><a href="#cb23-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-195"><a href="#cb23-195" aria-hidden="true" tabindex="-1"></a>The general-to-specific approach depicts the opposite method of specification search. This approach starts with the most general model and stepwise imposes restrictions on the parameters of this general model. </span>
<span id="cb23-196"><a href="#cb23-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-197"><a href="#cb23-197" aria-hidden="true" tabindex="-1"></a><span class="al">![@HalleckVega.2015: Nesting of different Spatial Econometric Model Specifications](fig/Vega.png)</span></span>
<span id="cb23-198"><a href="#cb23-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-199"><a href="#cb23-199" aria-hidden="true" tabindex="-1"></a>In theory, we would </span>
<span id="cb23-200"><a href="#cb23-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-201"><a href="#cb23-201" aria-hidden="true" tabindex="-1"></a>1) start with a GNS specification and </span>
<span id="cb23-202"><a href="#cb23-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-203"><a href="#cb23-203" aria-hidden="true" tabindex="-1"></a>2) subsequently restrict the model to simplified specifications based on the significance of parameters in the GNS. </span>
<span id="cb23-204"><a href="#cb23-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-205"><a href="#cb23-205" aria-hidden="true" tabindex="-1"></a>The problem with this strategy is that the GNS is only weakly identified and, thus, is of little help in selecting the correct restrictions <span class="co">[</span><span class="ot">@Burridge.2016</span><span class="co">]</span>. </span>
<span id="cb23-206"><a href="#cb23-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-207"><a href="#cb23-207" aria-hidden="true" tabindex="-1"></a>The most intuitive alternative would be to start with one of the two-source models SDM, SDEM, or SAC. This, however, bears the risk of imposing the wrong restriction in the first place <span class="co">[</span><span class="ot">@Cook.2020</span><span class="co">]</span>. Furthermore, @Cook.2020 show that more complicated restrictions are necessary to derive all single-source models from SDEM or SAC specifications. @Anselin.2024 argue that the Ge</span>
<span id="cb23-208"><a href="#cb23-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-209"><a href="#cb23-209" aria-hidden="true" tabindex="-1"></a><span class="fu">## General advice?</span></span>
<span id="cb23-210"><a href="#cb23-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-211"><a href="#cb23-211" aria-hidden="true" tabindex="-1"></a>@LeSage.2009, @LeSage.2014, @Elhorst.2014 argue that there are strong analytical reasons to restrict the model specifications to a subset, as the SDM subsumes the SLX and SAR model, and the SDEM subsumes SLX and SEM. </span>
<span id="cb23-212"><a href="#cb23-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-213"><a href="#cb23-213" aria-hidden="true" tabindex="-1"></a>It is easily observed that SDM reduces to SLX if $\rho=0$ and to SAR if ${\bm \theta}=0$, while the SDEM reduces to SLX if $\lambda=0$ and to SEM if ${\bm \theta}=0$. Less intuitively, <span class="co">[</span><span class="ot">@Anselin.1988</span><span class="co">]</span> has also shown that the SDM subsumes the SEM. Therefore, we can express the reduced form and rearrange terms:</span>
<span id="cb23-214"><a href="#cb23-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-215"><a href="#cb23-215" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb23-216"><a href="#cb23-216" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb23-217"><a href="#cb23-217" aria-hidden="true" tabindex="-1"></a>{\bm y}&amp;= {\bm X}{\bm \beta} + ({\bm I_N}-\lambda {\bm W})^{-1}{\bm \varepsilon} <span class="sc">\\</span></span>
<span id="cb23-218"><a href="#cb23-218" aria-hidden="true" tabindex="-1"></a>({\bm I_N}-\lambda {\bm W}){\bm y}&amp;= ({\bm I_N}-\lambda {\bm W}){\bm X}{\bm \beta} + {\bm \varepsilon} <span class="sc">\\</span></span>
<span id="cb23-219"><a href="#cb23-219" aria-hidden="true" tabindex="-1"></a>({\bm I_N}-\lambda {\bm W}){\bm y}&amp;={\bm X}{\bm \beta} -\lambda{\bm W}{\bm X}{\bm \beta} + {\bm \varepsilon} <span class="sc">\\</span></span>
<span id="cb23-220"><a href="#cb23-220" aria-hidden="true" tabindex="-1"></a>{\bm y}&amp;=({\bm I_N}-\lambda {\bm W})^{-1}({\bm X}{\bm \beta} + {\bm W}{\bm X}{\bm \theta} + {\bm \varepsilon}). </span>
<span id="cb23-221"><a href="#cb23-221" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb23-222"><a href="#cb23-222" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb23-223"><a href="#cb23-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-224"><a href="#cb23-224" aria-hidden="true" tabindex="-1"></a>Thus, the SEM constitutes a special case of an SDM with the relative simple restriction ${\bm \theta}=-\lambda{\bm \beta}$, meaning direct and indirect effects are constrained to a common factor <span class="co">[</span><span class="ot">@Anselin.1988; @Anselin.2003</span><span class="co">]</span>. </span>
<span id="cb23-225"><a href="#cb23-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-226"><a href="#cb23-226" aria-hidden="true" tabindex="-1"></a>The fact that SDM subsumes SAR, SLX, and SEM leads to the conclusion that applied research should only consider SDM and SDEM as model specifications <span class="co">[</span><span class="ot">@LeSage.2014</span><span class="co">]</span>. Especially in the case of a likely omitted variable bias, <span class="co">[</span><span class="ot">@LeSage.2009, p.~68</span><span class="co">]</span> argue in favour of using the SDM.</span>
<span id="cb23-227"><a href="#cb23-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-228"><a href="#cb23-228" aria-hidden="true" tabindex="-1"></a>Nonetheless, others propose to use the SLX specification as point of departure <span class="co">[</span><span class="ot">@Gibbons.2012; @HalleckVega.2015</span><span class="co">]</span>. First, scholars have argued that SAC and SDM models are only weakly identified in practice <span class="co">[</span><span class="ot">@Gibbons.2012; @Pinkse.2010</span><span class="co">]</span>. Second, the global spillover specification in SAR, SAC, and SDM often seems to be theoretically implausible.</span>
<span id="cb23-229"><a href="#cb23-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-230"><a href="#cb23-230" aria-hidden="true" tabindex="-1"></a>And finally:  </span>
<span id="cb23-231"><a href="#cb23-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-232"><a href="#cb23-232" aria-hidden="true" tabindex="-1"></a>!<span class="co">[</span><span class="ot">"I will use spatial lags of X, not spatial lags of Y", J. [Wooldridge on twitter]( https://twitter.com/jmwooldridge/status/1369460526770753537)</span><span class="co">](fig/wooldridge_tweet.png)</span></span>
<span id="cb23-233"><a href="#cb23-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-234"><a href="#cb23-234" aria-hidden="true" tabindex="-1"></a><span class="fu">## Design and Theory</span></span>
<span id="cb23-235"><a href="#cb23-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-236"><a href="#cb23-236" aria-hidden="true" tabindex="-1"></a>Some argue that the best way of choosing the appropriate model specification is to exclude one or more sources of spatial dependence -- autocorrelation in the dependent variable, autocorrelation in the disturbances, or spatial spillover effects of the covariates -- by design <span class="co">[</span><span class="ot">@Gibbons.2012, @Gibbons.2015</span><span class="co">]</span>. </span>
<span id="cb23-237"><a href="#cb23-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-238"><a href="#cb23-238" aria-hidden="true" tabindex="-1"></a>**Natural experiments** are probably the best way of making one or more sources of spatial dependence unlikely, thereby restricting the model alternatives to a subset of all available models. However, the opportunities to use natural experiments are restricted in social sciences, making it a favourable but often impractical way of model selection.</span>
<span id="cb23-239"><a href="#cb23-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-240"><a href="#cb23-240" aria-hidden="true" tabindex="-1"></a>@Cook.2020 and @Ruttenauer.2022a argue that theoretical considerations should guide the model selection.</span>
<span id="cb23-241"><a href="#cb23-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-242"><a href="#cb23-242" aria-hidden="true" tabindex="-1"></a>1) Rule out some sources of spatial dependence by theory, and thus restrict the specifications to a subset ( _Where does the spatial dependence come from?_ ),</span>
<span id="cb23-243"><a href="#cb23-243" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-244"><a href="#cb23-244" aria-hidden="true" tabindex="-1"></a>2) Theoretical mechanisms may guide the choice of either global or local spillover effects.</span>
<span id="cb23-245"><a href="#cb23-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-246"><a href="#cb23-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-247"><a href="#cb23-247" aria-hidden="true" tabindex="-1"></a><span class="fu">## Monte Carlo simulation</span></span>
<span id="cb23-248"><a href="#cb23-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-249"><a href="#cb23-249" aria-hidden="true" tabindex="-1"></a>This section discusses results from @Ruttenauer.2022a. The aim: how do different spatial models perform under different scenarios?</span>
<span id="cb23-250"><a href="#cb23-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-251"><a href="#cb23-251" aria-hidden="true" tabindex="-1"></a>The DGP of the Monte Carlo simulation follows a GNS, where ${\bm \upsilon}_k$ and ${\bm \varepsilon}$ are independent and randomly distributed $\mathcal{N}(0,\sigma^{2}_\upsilon)$ and $\mathcal{N}(0,\sigma^{2}_\varepsilon)$ with a mean of zero, and ${\bm x}_k$ is the $k$th column-vector of ${\bm X}$ for $k=1,...,K$ covariates ($K$ is fixed at $2$ in the simulations). The parameter $\rho$ represents the autocorrelation in the dependent variable, $\lambda$ the autocorrelation in the disturbances, and $\delta_k$ the autocorrelation in covariate $k$.</span>
<span id="cb23-252"><a href="#cb23-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-253"><a href="#cb23-253" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb23-254"><a href="#cb23-254" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb23-255"><a href="#cb23-255" aria-hidden="true" tabindex="-1"></a>{\bm y}&amp;=\rho{\bm W}{\bm y}+{\bm X}{\bm \beta}+{\bm W}{\bm X}{\bm \theta}+ {\bm u},<span class="sc">\\</span> </span>
<span id="cb23-256"><a href="#cb23-256" aria-hidden="true" tabindex="-1"></a>{\bm u}&amp;=\lambda{\bm W}{\bm u}+{\bm X}{\bm\gamma}+{\bm \varepsilon},<span class="sc">\\</span></span>
<span id="cb23-257"><a href="#cb23-257" aria-hidden="true" tabindex="-1"></a>{\bm x}_k&amp;=\delta_k{\bm W}{\bm x}_k+{\bm \upsilon}_k.</span>
<span id="cb23-258"><a href="#cb23-258" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb23-259"><a href="#cb23-259" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb23-260"><a href="#cb23-260" aria-hidden="true" tabindex="-1"></a>The parameter-vector ${\bm \gamma}$ specifies the correlation between ${\bm x}$ and the disturbance vector ${\bm u}$, thereby defining the strength of an omitted variable bias. In reduced form, this DGP can be written as</span>
<span id="cb23-261"><a href="#cb23-261" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb23-262"><a href="#cb23-262" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb23-263"><a href="#cb23-263" aria-hidden="true" tabindex="-1"></a>{\bm y}=&amp;({\bm I_N}-\rho {\bm W})^{-1}\big[({\bm I_N}-\delta_k {\bm W})^{-1}{\bm \upsilon_k}\beta_k <span class="sc">\\</span></span>
<span id="cb23-264"><a href="#cb23-264" aria-hidden="true" tabindex="-1"></a>&amp;+{\bm W}({\bm I_N}-\delta_k {\bm W})^{-1}{\bm \upsilon_k}\theta_k <span class="sc">\\</span></span>
<span id="cb23-265"><a href="#cb23-265" aria-hidden="true" tabindex="-1"></a>&amp;+({\bm I_N}-\lambda {\bm W})^{-1}(({\bm I_N}-\delta_k {\bm W})^{-1}{\bm \upsilon_k}\gamma_k+{\bm \varepsilon})\big].</span>
<span id="cb23-266"><a href="#cb23-266" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb23-267"><a href="#cb23-267" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb23-268"><a href="#cb23-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-269"><a href="#cb23-269" aria-hidden="true" tabindex="-1"></a>The parameter vector ${\bm \beta}$ was fixed at ${\bm \beta}=\irow{0.2&amp;0.5}^\intercal$, and the noise parameters were fixed at $\sigma^{2}_\upsilon$, $\sigma^{2}_\varepsilon=1$ for all trials. All other parameters vary between the following two options for each parameter (vector):</span>
<span id="cb23-270"><a href="#cb23-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-271"><a href="#cb23-271" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\rho \in \left<span class="sc">\{</span> 0, 0.5\right<span class="sc">\}</span>$,</span>
<span id="cb23-272"><a href="#cb23-272" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\lambda \in <span class="sc">\{</span>0, 0.5<span class="sc">\}</span>$,</span>
<span id="cb23-273"><a href="#cb23-273" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>${\bm \delta} \in \left<span class="sc">\{</span> \irow{0&amp;0}^\intercal, \irow{0.4&amp;0.7}^\intercal\right<span class="sc">\}</span>$,</span>
<span id="cb23-274"><a href="#cb23-274" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>${\bm \theta} \in \left<span class="sc">\{</span>\irow{0&amp;0}^\intercal, \irow{0.1&amp;0.8}^\intercal\right<span class="sc">\}</span>$,</span>
<span id="cb23-275"><a href="#cb23-275" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>${\bm \gamma} \in \left<span class="sc">\{</span>\irow{0&amp;0}^\intercal, \irow{0.3&amp;0}^\intercal\right<span class="sc">\}</span>$,</span>
<span id="cb23-276"><a href="#cb23-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-277"><a href="#cb23-277" aria-hidden="true" tabindex="-1"></a>leading to a total of 32 distinct combinations. Note that this selection of parameters intentionally violates the common ratio assumption between direct and indirect effects, as this should be a more common case in practical research. All combinations were simulated in 1000 trials, with the same starting seed for each combination. If youre, interested in the simulations, see <span class="co">[</span><span class="ot">replication code on Github</span><span class="co">](https://github.com/ruettenauer/Reproduction-Material-Spatial-Monte-Carlo-Experiments)</span>.</span>
<span id="cb23-278"><a href="#cb23-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-279"><a href="#cb23-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-280"><a href="#cb23-280" aria-hidden="true" tabindex="-1"></a><span class="fu">### Without omitted variable bias</span></span>
<span id="cb23-281"><a href="#cb23-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-282"><a href="#cb23-282" aria-hidden="true" tabindex="-1"></a><span class="al">![Bias of impacts and 95\% confidence interval of empirical standard deviation without omv: ${\bm \beta}=(0.2, 0.5)^\intercal$, ${\bm \gamma}=(0, 0)^\intercal$. $\rho=$ autocorrelation in the dependent variable ($\bm W \bm y$); $\bm \delta=$ autocorrelation in the covariates ($\bm x_k = f(\bm W \bm  x_k)$); $\lambda=$ autocorrelation in the disturbances ($\bm W \bm u$); $\bm \theta=$ spatial spillover effects of covariates ($\bm W \bm X$); $\bm\gamma=$ strength of omv.](fig/sim4_combined_1.png)</span></span>
<span id="cb23-283"><a href="#cb23-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-284"><a href="#cb23-284" aria-hidden="true" tabindex="-1"></a>SLX, SDM, and SDEM all provide quite accurate estimates of the direct impacts (most visible in column 2). SAR, SEM, and SAC, in contrast, yield some drawbacks: especially in the presence of local spillover effects, these three specifications are biased (see lower part). Furthermore, SAR and SEM suffer from bias if autocorrelation in the disturbance and autocorrelation in the dependent variable are present simultaneously (see line 6 and 8). Though SLX is downwardly biased in case of autocorrelation in the dependent variable and the covariates (e.g. line 12 and 16), and SDM as well as SDEM yield some bias in case of a GNS-like process (line 14 and 16), those biases are rather moderate. This indicates that SLX, SDM, and SDEM are most robust against misspecification regarding the direct impacts.</span>
<span id="cb23-285"><a href="#cb23-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-286"><a href="#cb23-286" aria-hidden="true" tabindex="-1"></a>Several differences exist regarding the indirect impacts. Most obviously, the often used SAR specification suffers from considerable bias: it overestimates indirect impacts in case of autocorrelation in the disturbances, and offers biased estimates if local spillover effects exist (which are not restricted to a common ratio). The latter also applies to SAC: though SAC offers relatively accurate estimates for ${\bm x}_2$, it overestimates indirect impacts for ${\bm x}_1$. </span>
<span id="cb23-287"><a href="#cb23-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-288"><a href="#cb23-288" aria-hidden="true" tabindex="-1"></a>Regarding the remaining three specifications -- SLX, SDM, and SDEM -- conclusions are less obvious. SDM and SDEM suffer from large bias for high values of ${\bm \theta}$ (see $\bm{x}_2$) if the DGP follows a GNS-like process (line 14 and 16): SDM overestimates the indirect impacts, while SDEM underestimates the indirect impacts. In addition, SDM performs badly if the true DGP is SDEM (line 13), and SDEM performs badly if the true DGP is SDM (line 10), whereas the bias increases with higher values of $\theta_k$ in both cases. Similar to SDEM, SLX underestimates the indirect impacts in presence of global spillovers / autocorrelation in the dependent variable.</span>
<span id="cb23-289"><a href="#cb23-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-290"><a href="#cb23-290" aria-hidden="true" tabindex="-1"></a><span class="fu">### With omitted variable bias</span></span>
<span id="cb23-291"><a href="#cb23-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-292"><a href="#cb23-292" aria-hidden="true" tabindex="-1"></a><span class="al">![Bias of impacts and 95\% confidence interval of empirical standard deviation with omv: ${\bm \beta}=(0.2, 0.5)^\intercal$, ${\bm \gamma}=(0.3, 0)^\intercal$. $\rho=$ autocorrelation in the dependent variable ($\bm W \bm y$); $\bm \delta=$ autocorrelation in the covariates ($\bm x_k = f(\bm W \bm  x_k)$); $\lambda=$ autocorrelation in the disturbances ($\bm W \bm u$); $\bm \theta=$ spatial spillover effects of covariates ($\bm W \bm X$); $\bm\gamma=$ strength of omv.](fig/sim4_combined_2.png)</span></span>
<span id="cb23-293"><a href="#cb23-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-294"><a href="#cb23-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-295"><a href="#cb23-295" aria-hidden="true" tabindex="-1"></a><span class="fu">### Indirect impacts if DGP = GNS</span></span>
<span id="cb23-296"><a href="#cb23-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-297"><a href="#cb23-297" aria-hidden="true" tabindex="-1"></a>Below an illustration about the indirect impacts, if the spatial process is a combination of</span>
<span id="cb23-298"><a href="#cb23-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-299"><a href="#cb23-299" aria-hidden="true" tabindex="-1"></a>1) Clustering on Unobservables</span>
<span id="cb23-300"><a href="#cb23-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-301"><a href="#cb23-301" aria-hidden="true" tabindex="-1"></a>2) Interdependence (in the outcome)</span>
<span id="cb23-302"><a href="#cb23-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-303"><a href="#cb23-303" aria-hidden="true" tabindex="-1"></a>3) Spillovers in Covariates</span>
<span id="cb23-304"><a href="#cb23-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-305"><a href="#cb23-305" aria-hidden="true" tabindex="-1"></a><span class="al">![Bias of indirect impacts and 95\% confidence interval of empirical standard deviation for different strengths of autocorrelation: ${\bm \beta}=(0.2, 0.5)^\intercal$, ${\bm \gamma}=(0, 0)^\intercal$, ${\bm\delta}=(0, 0)^\intercal$, ${\bm\theta}=(0.1, 0.8)^\intercal$. $\rho=$ autocorrelation in the dependent variable ($\bm W \bm y$); $\bm \delta=$ autocorrelation in the covariates ($\bm x_k = f(\bm W \bm  x_k)$); $\lambda=$ autocorrelation in the disturbances ($\bm W \bm u$); $\bm \theta=$ spatial spillover effects of covariates ($\bm W \bm X$); $\bm\gamma=$ strength of omv.](fig/sim11_combined_1.png)</span></span>
<span id="cb23-306"><a href="#cb23-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-307"><a href="#cb23-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-308"><a href="#cb23-308" aria-hidden="true" tabindex="-1"></a>First, in a GNS-like situation, the bias in SDM grows with increasing autocorrelation in ${\bm y}$ ($\rho$) and increasing autocorrelation in the disturbances ($\lambda$). </span>
<span id="cb23-309"><a href="#cb23-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-310"><a href="#cb23-310" aria-hidden="true" tabindex="-1"></a>Second, the bias in SLX and SDEM increases with higher values of $\rho$, but is unaffected from the strength of $\lambda$. </span>
<span id="cb23-311"><a href="#cb23-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-312"><a href="#cb23-312" aria-hidden="true" tabindex="-1"></a>Third, though SLX and SDEM suffer from the same problem, the bias from omitting global autocorrelation is less severe in SLX than in SDEM. </span>
<span id="cb23-313"><a href="#cb23-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-314"><a href="#cb23-314" aria-hidden="true" tabindex="-1"></a>Thus, the SLX outperforms SDEM. Furthermore, SLX outperforms SDM in most situations; only if the autocorrelation in the dependent variable is much stronger than the autocorrelation in the disturbances ($\rho=0.9$, $\lambda=0.3$), SDM yields lower bias than SLX. Note that the SAC yields relatively low biases for the indirect impacts in GNS-like processes, but at the same time produces relative large biases in the direct impacts.</span>
<span id="cb23-315"><a href="#cb23-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-316"><a href="#cb23-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-317"><a href="#cb23-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-318"><a href="#cb23-318" aria-hidden="true" tabindex="-1"></a><span class="fu">## Example: House prices in London</span></span>
<span id="cb23-319"><a href="#cb23-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-320"><a href="#cb23-320" aria-hidden="true" tabindex="-1"></a>The example is taken from @Ruttenauer.2024b.</span>
<span id="cb23-321"><a href="#cb23-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-322"><a href="#cb23-322" aria-hidden="true" tabindex="-1"></a>As an example to compare the different spatial model specifications, we estimate the effect of local characteristics such as green space and public transport connectivity on the median house price. The relation between environmental characteristics and housing choice and prices has been investigated in several studies <span class="co">[</span><span class="ot">@Anselin.2008; @Kley.2021; @Liebe.2023</span><span class="co">]</span>. The data for the current example was retrieved from the London Datastore<span class="ot">[^03_article-4]</span>, the 2011 Census<span class="ot">[^03_article-5]</span> and OpenStreetMaps and combined at the Middle Layer Super Output Areas (MSOA). There are 983 MSOAs in London with an average population size of around 8,000 residents. The script for compiling and preparing the data can be found in the Supplementary Materials. All data preparation and analysis were performed with the statistical software R. For a comprehensive overview of spatial software see @Bivand.2021 or @Pebesma.2023.</span>
<span id="cb23-323"><a href="#cb23-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-324"><a href="#cb23-324" aria-hidden="true" tabindex="-1"></a><span class="ot">[^03_article-4]: </span>For house prices, see: <span class="ot">&lt;https://data.london.gov.uk/dataset/average-house-prices&gt;</span>. For London accessibility scores see: <span class="ot">&lt;https://data.london.gov.uk/dataset/public-transport-accessibility-levels&gt;</span></span>
<span id="cb23-325"><a href="#cb23-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-326"><a href="#cb23-326" aria-hidden="true" tabindex="-1"></a><span class="ot">[^03_article-5]: </span>For UK demographics, see: <span class="ot">&lt;https://www.nomisweb.co.uk/sources/census_2011&gt;</span></span>
<span id="cb23-327"><a href="#cb23-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-328"><a href="#cb23-328" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message = FALSE, warning = FALSE, results = 'hide'}</span></span>
<span id="cb23-329"><a href="#cb23-329" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the packages</span></span>
<span id="cb23-330"><a href="#cb23-330" aria-hidden="true" tabindex="-1"></a>pkgs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"sf"</span>, <span class="st">"mapview"</span>, <span class="st">"spdep"</span>, <span class="st">"spatialreg"</span>, <span class="st">"texreg"</span>, </span>
<span id="cb23-331"><a href="#cb23-331" aria-hidden="true" tabindex="-1"></a>          <span class="st">"ggplot2"</span>, <span class="st">"ggthemes"</span>, <span class="st">"rmapshaper"</span>, <span class="st">"viridis"</span>, <span class="st">"gridExtra"</span>) <span class="co"># note: load spdep first, then spatialreg</span></span>
<span id="cb23-332"><a href="#cb23-332" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(pkgs, require, <span class="at">character.only =</span> <span class="cn">TRUE</span>)</span>
<span id="cb23-333"><a href="#cb23-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-334"><a href="#cb23-334" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the data</span></span>
<span id="cb23-335"><a href="#cb23-335" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"_data/msoa3_spatial.RData"</span>)</span>
<span id="cb23-336"><a href="#cb23-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-337"><a href="#cb23-337" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Contiguity (Queens) neighbours weights</span></span>
<span id="cb23-338"><a href="#cb23-338" aria-hidden="true" tabindex="-1"></a>queens.nb <span class="ot">&lt;-</span> <span class="fu">poly2nb</span>(msoa.spdf, </span>
<span id="cb23-339"><a href="#cb23-339" aria-hidden="true" tabindex="-1"></a>                     <span class="at">queen =</span> <span class="cn">TRUE</span>, </span>
<span id="cb23-340"><a href="#cb23-340" aria-hidden="true" tabindex="-1"></a>                     <span class="at">snap =</span> <span class="dv">1</span>) <span class="co"># we consider points in 1m distance as 'touching'</span></span>
<span id="cb23-341"><a href="#cb23-341" aria-hidden="true" tabindex="-1"></a>queens.lw <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(queens.nb,</span>
<span id="cb23-342"><a href="#cb23-342" aria-hidden="true" tabindex="-1"></a>                      <span class="at">style =</span> <span class="st">"W"</span>)</span>
<span id="cb23-343"><a href="#cb23-343" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb23-344"><a href="#cb23-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-345"><a href="#cb23-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-346"><a href="#cb23-346" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message = FALSE, warning = FALSE, results = 'hide'}</span></span>
<span id="cb23-347"><a href="#cb23-347" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot house prices</span></span>
<span id="cb23-348"><a href="#cb23-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-349"><a href="#cb23-349" aria-hidden="true" tabindex="-1"></a><span class="co"># Get some larger scale boundaries</span></span>
<span id="cb23-350"><a href="#cb23-350" aria-hidden="true" tabindex="-1"></a>borough.spdf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="fu">paste0</span>(<span class="st">"_data"</span>, <span class="st">"/statistical-gis-boundaries-london/ESRI"</span>),</span>
<span id="cb23-351"><a href="#cb23-351" aria-hidden="true" tabindex="-1"></a>                     <span class="at">layer =</span> <span class="st">"London_Borough_Excluding_MHW"</span> <span class="co"># Note: no file ending</span></span>
<span id="cb23-352"><a href="#cb23-352" aria-hidden="true" tabindex="-1"></a>                     )</span>
<span id="cb23-353"><a href="#cb23-353" aria-hidden="true" tabindex="-1"></a><span class="co"># transform to only inner lines</span></span>
<span id="cb23-354"><a href="#cb23-354" aria-hidden="true" tabindex="-1"></a>borough_inner <span class="ot">&lt;-</span> rmapshaper<span class="sc">::</span><span class="fu">ms_innerlines</span>(borough.spdf)</span>
<span id="cb23-355"><a href="#cb23-355" aria-hidden="true" tabindex="-1"></a>borough_inner <span class="ot">&lt;-</span> borough.spdf</span>
<span id="cb23-356"><a href="#cb23-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-357"><a href="#cb23-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-358"><a href="#cb23-358" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot with inner lines</span></span>
<span id="cb23-359"><a href="#cb23-359" aria-hidden="true" tabindex="-1"></a>msoa.spdf<span class="sc">$</span>med_house_price_ln <span class="ot">&lt;-</span> <span class="fu">log</span>(msoa.spdf<span class="sc">$</span>med_house_price)</span>
<span id="cb23-360"><a href="#cb23-360" aria-hidden="true" tabindex="-1"></a>msoa.spdf<span class="sc">$</span>pt_access_index_ln <span class="ot">&lt;-</span> <span class="fu">log</span>(msoa.spdf<span class="sc">$</span>pt_access_index)</span>
<span id="cb23-361"><a href="#cb23-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-362"><a href="#cb23-362" aria-hidden="true" tabindex="-1"></a>gp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(msoa.spdf)<span class="sc">+</span></span>
<span id="cb23-363"><a href="#cb23-363" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> med_house_price_ln))<span class="sc">+</span></span>
<span id="cb23-364"><a href="#cb23-364" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">"A"</span>)<span class="sc">+</span></span>
<span id="cb23-365"><a href="#cb23-365" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> borough_inner, <span class="at">color =</span> <span class="st">"gray92"</span>, <span class="at">fill =</span> <span class="cn">NA</span>)<span class="sc">+</span></span>
<span id="cb23-366"><a href="#cb23-366" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>(<span class="at">datum =</span> <span class="cn">NA</span>)<span class="sc">+</span></span>
<span id="cb23-367"><a href="#cb23-367" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_map</span>()<span class="sc">+</span></span>
<span id="cb23-368"><a href="#cb23-368" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"log price"</span>)<span class="sc">+</span></span>
<span id="cb23-369"><a href="#cb23-369" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))<span class="sc">+</span></span>
<span id="cb23-370"><a href="#cb23-370" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Median house price"</span>)</span>
<span id="cb23-371"><a href="#cb23-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-372"><a href="#cb23-372" aria-hidden="true" tabindex="-1"></a>gp2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(msoa.spdf)<span class="sc">+</span></span>
<span id="cb23-373"><a href="#cb23-373" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> pt_access_index_ln))<span class="sc">+</span></span>
<span id="cb23-374"><a href="#cb23-374" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">"D"</span>)<span class="sc">+</span></span>
<span id="cb23-375"><a href="#cb23-375" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> borough_inner, <span class="at">color =</span> <span class="st">"gray92"</span>, <span class="at">fill =</span> <span class="cn">NA</span>)<span class="sc">+</span></span>
<span id="cb23-376"><a href="#cb23-376" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>(<span class="at">datum =</span> <span class="cn">NA</span>)<span class="sc">+</span></span>
<span id="cb23-377"><a href="#cb23-377" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_map</span>()<span class="sc">+</span></span>
<span id="cb23-378"><a href="#cb23-378" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"log index"</span>)<span class="sc">+</span></span>
<span id="cb23-379"><a href="#cb23-379" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))<span class="sc">+</span></span>
<span id="cb23-380"><a href="#cb23-380" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Public transport access"</span>)</span>
<span id="cb23-381"><a href="#cb23-381" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb23-382"><a href="#cb23-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-383"><a href="#cb23-383" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message = FALSE, warning = FALSE, results = 'hide'}</span></span>
<span id="cb23-384"><a href="#cb23-384" aria-hidden="true" tabindex="-1"></a><span class="fu">cairo_ps</span>(<span class="at">file =</span> <span class="fu">paste</span>(<span class="st">"fig/"</span>, <span class="st">"Maps.eps"</span>, <span class="at">sep=</span><span class="st">""</span>), <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">4</span>, </span>
<span id="cb23-385"><a href="#cb23-385" aria-hidden="true" tabindex="-1"></a>          <span class="at">bg =</span> <span class="st">"white"</span>, <span class="at">family =</span> <span class="st">"Times New Roman"</span>)</span>
<span id="cb23-386"><a href="#cb23-386" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb23-387"><a href="#cb23-387" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb23-388"><a href="#cb23-388" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(gp, gp2, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb23-389"><a href="#cb23-389" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb23-390"><a href="#cb23-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-391"><a href="#cb23-391" aria-hidden="true" tabindex="-1"></a><span class="fu">jpeg</span>(<span class="at">file =</span> <span class="fu">paste</span>(<span class="st">"fig/"</span>, <span class="st">"Maps.jpeg"</span>, <span class="at">sep=</span><span class="st">""</span>), <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">4</span>, </span>
<span id="cb23-392"><a href="#cb23-392" aria-hidden="true" tabindex="-1"></a>    <span class="at">units =</span> <span class="st">"in"</span>, <span class="at">res =</span> <span class="dv">300</span>, <span class="at">type =</span> <span class="st">"cairo"</span>,</span>
<span id="cb23-393"><a href="#cb23-393" aria-hidden="true" tabindex="-1"></a>          <span class="at">bg =</span> <span class="st">"white"</span>, <span class="at">family =</span> <span class="st">"Times New Roman"</span>)</span>
<span id="cb23-394"><a href="#cb23-394" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb23-395"><a href="#cb23-395" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb23-396"><a href="#cb23-396" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(gp, gp2, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb23-397"><a href="#cb23-397" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb23-398"><a href="#cb23-398" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb23-399"><a href="#cb23-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-400"><a href="#cb23-400" aria-hidden="true" tabindex="-1"></a><span class="al">![Spatial distribution of log-transformed median house prices and transport accessibility across London.](fig/Maps.jpeg)</span>{#fig-map}</span>
<span id="cb23-401"><a href="#cb23-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-402"><a href="#cb23-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-403"><a href="#cb23-403" aria-hidden="true" tabindex="-1"></a>Figure @fig-map shows an unclassified choropleth map of house prices and public transport access across London, both log-scaled for mapping. As we would expect, both indicators follow a relatively strong spatial of positive autocorrelation: house prices first decrease with increasing distance to the centre, and then seem to increase again in suburban areas. Moreover, there seems to be a pattern of higher prices towards the west and particularly high prices around Hyde Park. Public transport accessibility steadily decreases with distance to the city centre. Spatial regression models thus seem to be important here for two reasons: a) observations are not independent of each other but follow clear spatial patterns, and b) surrounding / adjacent urban characteristics likely play a role for housing demand and prices in the focal unit as well.</span>
<span id="cb23-404"><a href="#cb23-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-405"><a href="#cb23-405" aria-hidden="true" tabindex="-1"></a>In Table 1, we regress the median house price in 2011 on the area (in km\^2) covered by green space according to OpenStreetMaps, an index of public transport access (ranging from 0-low accessibility to 100-high accessibility), and several population characteristics from the 2011 census such as population density, the percent of non-UK residents and the percent of social housing. Reported are results form (1) non-spatial OLS, (2) Spatial Autoregressive (SAR), (3) Spatial Error Model (SEM), (4) Spatial Lag of X (SLX), (5) Spatial Durbin Model (SDM), (6) and Spatial Durbin Error Model (SDEM). All variables were standardized before estimation, and we thus interpret coefficients in standard deviations. Note that we do not estimate results for Spatial Autoregressive Combined (SAC) models because of its severe drawbacks for applied research <span class="co">[</span><span class="ot">@LeSage.2014</span><span class="co">]</span>.</span>
<span id="cb23-406"><a href="#cb23-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-409"><a href="#cb23-409" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb23-410"><a href="#cb23-410" aria-hidden="true" tabindex="-1"></a><span class="co"># Specifcy variables and formula</span></span>
<span id="cb23-411"><a href="#cb23-411" aria-hidden="true" tabindex="-1"></a>fm <span class="ot">&lt;-</span> med_house_price <span class="sc">~</span> park_kmsq <span class="sc">+</span> pt_access_index <span class="sc">+</span> POPDEN <span class="sc">+</span> per_nonUK <span class="sc">+</span> per_social</span>
<span id="cb23-412"><a href="#cb23-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-413"><a href="#cb23-413" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardize variables</span></span>
<span id="cb23-414"><a href="#cb23-414" aria-hidden="true" tabindex="-1"></a>vars <span class="ot">&lt;-</span> <span class="fu">all.vars</span>(fm)</span>
<span id="cb23-415"><a href="#cb23-415" aria-hidden="true" tabindex="-1"></a>msoa_sd.spdf <span class="ot">&lt;-</span> msoa.spdf</span>
<span id="cb23-416"><a href="#cb23-416" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(v <span class="cf">in</span> vars){</span>
<span id="cb23-417"><a href="#cb23-417" aria-hidden="true" tabindex="-1"></a>  msoa_sd.spdf[, v] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">scale</span>(msoa_sd.spdf[, v, <span class="at">drop =</span> <span class="cn">TRUE</span>]))</span>
<span id="cb23-418"><a href="#cb23-418" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-419"><a href="#cb23-419" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb23-420"><a href="#cb23-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-423"><a href="#cb23-423" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb23-424"><a href="#cb23-424" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate the models</span></span>
<span id="cb23-425"><a href="#cb23-425" aria-hidden="true" tabindex="-1"></a>mod_1.ols <span class="ot">&lt;-</span> <span class="fu">lm</span>(fm, <span class="at">data =</span> msoa_sd.spdf)</span>
<span id="cb23-426"><a href="#cb23-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-427"><a href="#cb23-427" aria-hidden="true" tabindex="-1"></a><span class="co"># Spatial autoregressive model</span></span>
<span id="cb23-428"><a href="#cb23-428" aria-hidden="true" tabindex="-1"></a>mod_1.sar <span class="ot">&lt;-</span> <span class="fu">lagsarlm</span>(fm,  </span>
<span id="cb23-429"><a href="#cb23-429" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> msoa_sd.spdf, </span>
<span id="cb23-430"><a href="#cb23-430" aria-hidden="true" tabindex="-1"></a>                      <span class="at">listw =</span> queens.lw,</span>
<span id="cb23-431"><a href="#cb23-431" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Durbin =</span> <span class="cn">FALSE</span>) <span class="co"># we could here extend to SDM</span></span>
<span id="cb23-432"><a href="#cb23-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-433"><a href="#cb23-433" aria-hidden="true" tabindex="-1"></a><span class="co"># Spatial error model</span></span>
<span id="cb23-434"><a href="#cb23-434" aria-hidden="true" tabindex="-1"></a>mod_1.sem <span class="ot">&lt;-</span> <span class="fu">errorsarlm</span>(fm,  </span>
<span id="cb23-435"><a href="#cb23-435" aria-hidden="true" tabindex="-1"></a>                        <span class="at">data =</span> msoa_sd.spdf, </span>
<span id="cb23-436"><a href="#cb23-436" aria-hidden="true" tabindex="-1"></a>                        <span class="at">listw =</span> queens.lw,</span>
<span id="cb23-437"><a href="#cb23-437" aria-hidden="true" tabindex="-1"></a>                        <span class="at">Durbin =</span> <span class="cn">FALSE</span>) <span class="co"># we could here extend to SDEM</span></span>
<span id="cb23-438"><a href="#cb23-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-439"><a href="#cb23-439" aria-hidden="true" tabindex="-1"></a><span class="co"># SLX</span></span>
<span id="cb23-440"><a href="#cb23-440" aria-hidden="true" tabindex="-1"></a>mod_1.slx <span class="ot">&lt;-</span> <span class="fu">lmSLX</span>(fm,  </span>
<span id="cb23-441"><a href="#cb23-441" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> msoa_sd.spdf, </span>
<span id="cb23-442"><a href="#cb23-442" aria-hidden="true" tabindex="-1"></a>                   <span class="at">listw =</span> queens.lw, </span>
<span id="cb23-443"><a href="#cb23-443" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Durbin =</span> <span class="cn">TRUE</span>) <span class="co"># use a formula to lag only specific covariates</span></span>
<span id="cb23-444"><a href="#cb23-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-445"><a href="#cb23-445" aria-hidden="true" tabindex="-1"></a><span class="co"># Spatial Durbin</span></span>
<span id="cb23-446"><a href="#cb23-446" aria-hidden="true" tabindex="-1"></a>mod_1.sdm <span class="ot">&lt;-</span> <span class="fu">lagsarlm</span>(fm,  </span>
<span id="cb23-447"><a href="#cb23-447" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> msoa_sd.spdf, </span>
<span id="cb23-448"><a href="#cb23-448" aria-hidden="true" tabindex="-1"></a>                      <span class="at">listw =</span> queens.lw,</span>
<span id="cb23-449"><a href="#cb23-449" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Durbin =</span> <span class="cn">TRUE</span>) <span class="co"># we could here extend to SDM</span></span>
<span id="cb23-450"><a href="#cb23-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-451"><a href="#cb23-451" aria-hidden="true" tabindex="-1"></a><span class="co"># Spatial Durbun Error</span></span>
<span id="cb23-452"><a href="#cb23-452" aria-hidden="true" tabindex="-1"></a>mod_1.sdem <span class="ot">&lt;-</span> <span class="fu">errorsarlm</span>(fm,  </span>
<span id="cb23-453"><a href="#cb23-453" aria-hidden="true" tabindex="-1"></a>                        <span class="at">data =</span> msoa_sd.spdf, </span>
<span id="cb23-454"><a href="#cb23-454" aria-hidden="true" tabindex="-1"></a>                        <span class="at">listw =</span> queens.lw,</span>
<span id="cb23-455"><a href="#cb23-455" aria-hidden="true" tabindex="-1"></a>                        <span class="at">Durbin =</span> <span class="cn">TRUE</span>) <span class="co"># we could here extend to SDEM</span></span>
<span id="cb23-456"><a href="#cb23-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-457"><a href="#cb23-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-458"><a href="#cb23-458" aria-hidden="true" tabindex="-1"></a><span class="do">### Coefficient Output</span></span>
<span id="cb23-459"><a href="#cb23-459" aria-hidden="true" tabindex="-1"></a><span class="co"># Get AIC and N for all models to get common gof stats</span></span>
<span id="cb23-460"><a href="#cb23-460" aria-hidden="true" tabindex="-1"></a>aic.l <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">list</span>(mod_1.ols, mod_1.sar, mod_1.sem, mod_1.slx, mod_1.sdm, mod_1.sdem),</span>
<span id="cb23-461"><a href="#cb23-461" aria-hidden="true" tabindex="-1"></a>       <span class="at">FUN =</span> <span class="cf">function</span>(x) <span class="fu">AIC</span>(x))</span>
<span id="cb23-462"><a href="#cb23-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-463"><a href="#cb23-463" aria-hidden="true" tabindex="-1"></a>n.l <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">list</span>(mod_1.ols, mod_1.sar, mod_1.sem, mod_1.slx, mod_1.sdm, mod_1.sdem),</span>
<span id="cb23-464"><a href="#cb23-464" aria-hidden="true" tabindex="-1"></a>       <span class="at">FUN =</span> <span class="cf">function</span>(x) <span class="fu">length</span>(<span class="fu">residuals</span>(x)))</span>
<span id="cb23-465"><a href="#cb23-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-466"><a href="#cb23-466" aria-hidden="true" tabindex="-1"></a><span class="co"># Create table</span></span>
<span id="cb23-467"><a href="#cb23-467" aria-hidden="true" tabindex="-1"></a>mod_1.slx.lm <span class="ot">&lt;-</span> mod_1.slx</span>
<span id="cb23-468"><a href="#cb23-468" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(mod_1.slx.lm) <span class="ot">&lt;-</span> <span class="st">"lm"</span> <span class="co"># only for gofs</span></span>
<span id="cb23-469"><a href="#cb23-469" aria-hidden="true" tabindex="-1"></a><span class="co"># screenreg(list(mod_1.ols, mod_1.sar, mod_1.sem, mod_1.slx.lm, mod_1.sdm, mod_1.sdem),</span></span>
<span id="cb23-470"><a href="#cb23-470" aria-hidden="true" tabindex="-1"></a><span class="co">#           custom.coef.map = list('(Intercept)' =  '(Intercept)',</span></span>
<span id="cb23-471"><a href="#cb23-471" aria-hidden="true" tabindex="-1"></a><span class="co">#                                  'park_kmsq' =  'Green space',</span></span>
<span id="cb23-472"><a href="#cb23-472" aria-hidden="true" tabindex="-1"></a><span class="co">#                                  'pt_access_index' =  'Public transport access',</span></span>
<span id="cb23-473"><a href="#cb23-473" aria-hidden="true" tabindex="-1"></a><span class="co">#                                  'POPDEN' =  'Population density',</span></span>
<span id="cb23-474"><a href="#cb23-474" aria-hidden="true" tabindex="-1"></a><span class="co">#                                  'per_nonUK' =  '% non-UK',</span></span>
<span id="cb23-475"><a href="#cb23-475" aria-hidden="true" tabindex="-1"></a><span class="co">#                                  'per_social' = '% social housing',</span></span>
<span id="cb23-476"><a href="#cb23-476" aria-hidden="true" tabindex="-1"></a><span class="co">#                                  'lag.park_kmsq' =  'W Green space',</span></span>
<span id="cb23-477"><a href="#cb23-477" aria-hidden="true" tabindex="-1"></a><span class="co">#                                  'lag.pt_access_index' =  'W Public transport access',</span></span>
<span id="cb23-478"><a href="#cb23-478" aria-hidden="true" tabindex="-1"></a><span class="co">#                                  'lag.POPDEN' =  'W Population density',</span></span>
<span id="cb23-479"><a href="#cb23-479" aria-hidden="true" tabindex="-1"></a><span class="co">#                                  'lag.per_nonUK' =  'W % non-UK',</span></span>
<span id="cb23-480"><a href="#cb23-480" aria-hidden="true" tabindex="-1"></a><span class="co">#                                  'lag.per_social' = 'W % social housing',</span></span>
<span id="cb23-481"><a href="#cb23-481" aria-hidden="true" tabindex="-1"></a><span class="co">#                                  'rho' = 'rho',</span></span>
<span id="cb23-482"><a href="#cb23-482" aria-hidden="true" tabindex="-1"></a><span class="co">#                                  'lambda' = 'lambda'),</span></span>
<span id="cb23-483"><a href="#cb23-483" aria-hidden="true" tabindex="-1"></a><span class="co">#           custom.model.names = c("OLS", "SAR", "SEM", "SLX", "SDM", "SDEM"),</span></span>
<span id="cb23-484"><a href="#cb23-484" aria-hidden="true" tabindex="-1"></a><span class="co">#           dcolumn = TRUE, caption.above = TRUE, digits = 3,</span></span>
<span id="cb23-485"><a href="#cb23-485" aria-hidden="true" tabindex="-1"></a><span class="co">#           caption = "Spatial regression models. Outcome variable: median house price.",</span></span>
<span id="cb23-486"><a href="#cb23-486" aria-hidden="true" tabindex="-1"></a><span class="co">#           include.nobs = FALSE,</span></span>
<span id="cb23-487"><a href="#cb23-487" aria-hidden="true" tabindex="-1"></a><span class="co">#   include.loglik = FALSE,</span></span>
<span id="cb23-488"><a href="#cb23-488" aria-hidden="true" tabindex="-1"></a><span class="co">#   include.aic = FALSE,</span></span>
<span id="cb23-489"><a href="#cb23-489" aria-hidden="true" tabindex="-1"></a><span class="co">#   include.lr = TRUE,</span></span>
<span id="cb23-490"><a href="#cb23-490" aria-hidden="true" tabindex="-1"></a><span class="co">#   include.wald = FALSE,</span></span>
<span id="cb23-491"><a href="#cb23-491" aria-hidden="true" tabindex="-1"></a><span class="co">#   include.fstatistic = FALSE,</span></span>
<span id="cb23-492"><a href="#cb23-492" aria-hidden="true" tabindex="-1"></a><span class="co">#   include.rmse = FALSE,</span></span>
<span id="cb23-493"><a href="#cb23-493" aria-hidden="true" tabindex="-1"></a><span class="co">#   custom.gof.rows = list('Num. obs.' = n.l, </span></span>
<span id="cb23-494"><a href="#cb23-494" aria-hidden="true" tabindex="-1"></a><span class="co">#                          'AIC' = aic.l), </span></span>
<span id="cb23-495"><a href="#cb23-495" aria-hidden="true" tabindex="-1"></a><span class="co">#   reorder.gof = c(1, 3:6, 2))</span></span>
<span id="cb23-496"><a href="#cb23-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-497"><a href="#cb23-497" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb23-498"><a href="#cb23-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-499"><a href="#cb23-499" aria-hidden="true" tabindex="-1"></a><span class="in">```{r message = FALSE, warning = FALSE, results = 'hide'}</span></span>
<span id="cb23-500"><a href="#cb23-500" aria-hidden="true" tabindex="-1"></a><span class="fu">wordreg</span>(<span class="fu">list</span>(mod_1.ols, mod_1.sar, mod_1.sem, mod_1.slx.lm, mod_1.sdm, mod_1.sdem),</span>
<span id="cb23-501"><a href="#cb23-501" aria-hidden="true" tabindex="-1"></a>        <span class="at">file =</span> <span class="st">"fig/Regression.doc"</span>,</span>
<span id="cb23-502"><a href="#cb23-502" aria-hidden="true" tabindex="-1"></a>          <span class="at">custom.coef.map =</span> <span class="fu">list</span>(<span class="st">'(Intercept)'</span> <span class="ot">=</span>  <span class="st">'(Intercept)'</span>,</span>
<span id="cb23-503"><a href="#cb23-503" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">'park_kmsq'</span> <span class="ot">=</span>  <span class="st">'Green space'</span>,</span>
<span id="cb23-504"><a href="#cb23-504" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">'pt_access_index'</span> <span class="ot">=</span>  <span class="st">'Public transport access'</span>,</span>
<span id="cb23-505"><a href="#cb23-505" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">'POPDEN'</span> <span class="ot">=</span>  <span class="st">'Population density'</span>,</span>
<span id="cb23-506"><a href="#cb23-506" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">'per_nonUK'</span> <span class="ot">=</span>  <span class="st">'Percent non-UK'</span>,</span>
<span id="cb23-507"><a href="#cb23-507" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">'per_social'</span> <span class="ot">=</span> <span class="st">'Percent social housing'</span>,</span>
<span id="cb23-508"><a href="#cb23-508" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">'lag.park_kmsq'</span> <span class="ot">=</span>  <span class="st">'W Green space'</span>,</span>
<span id="cb23-509"><a href="#cb23-509" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">'lag.pt_access_index'</span> <span class="ot">=</span>  <span class="st">'W Public transport access'</span>,</span>
<span id="cb23-510"><a href="#cb23-510" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">'lag.POPDEN'</span> <span class="ot">=</span>  <span class="st">'W Population density'</span>,</span>
<span id="cb23-511"><a href="#cb23-511" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">'lag.per_nonUK'</span> <span class="ot">=</span>  <span class="st">'W Percent non-UK'</span>,</span>
<span id="cb23-512"><a href="#cb23-512" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">'lag.per_social'</span> <span class="ot">=</span> <span class="st">'W Percent social housing'</span>,</span>
<span id="cb23-513"><a href="#cb23-513" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">'rho'</span> <span class="ot">=</span> <span class="st">'rho'</span>,</span>
<span id="cb23-514"><a href="#cb23-514" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">'lambda'</span> <span class="ot">=</span> <span class="st">'lambda'</span>),</span>
<span id="cb23-515"><a href="#cb23-515" aria-hidden="true" tabindex="-1"></a>          <span class="at">custom.model.names =</span> <span class="fu">c</span>(<span class="st">"OLS"</span>, <span class="st">"SAR"</span>, <span class="st">"SEM"</span>, <span class="st">"SLX"</span>, <span class="st">"SDM"</span>, <span class="st">"SDEM"</span>),</span>
<span id="cb23-516"><a href="#cb23-516" aria-hidden="true" tabindex="-1"></a>          <span class="at">dcolumn =</span> <span class="cn">TRUE</span>, <span class="at">caption.above =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb23-517"><a href="#cb23-517" aria-hidden="true" tabindex="-1"></a>          <span class="at">caption =</span> <span class="st">"Spatial regression models. Outcome variable: median house price."</span>,</span>
<span id="cb23-518"><a href="#cb23-518" aria-hidden="true" tabindex="-1"></a>          <span class="at">include.nobs =</span> <span class="cn">FALSE</span>,</span>
<span id="cb23-519"><a href="#cb23-519" aria-hidden="true" tabindex="-1"></a>  <span class="at">include.loglik =</span> <span class="cn">FALSE</span>,</span>
<span id="cb23-520"><a href="#cb23-520" aria-hidden="true" tabindex="-1"></a>  <span class="at">include.aic =</span> <span class="cn">FALSE</span>,</span>
<span id="cb23-521"><a href="#cb23-521" aria-hidden="true" tabindex="-1"></a>  <span class="at">include.lr =</span> <span class="cn">TRUE</span>,</span>
<span id="cb23-522"><a href="#cb23-522" aria-hidden="true" tabindex="-1"></a>  <span class="at">include.wald =</span> <span class="cn">FALSE</span>,</span>
<span id="cb23-523"><a href="#cb23-523" aria-hidden="true" tabindex="-1"></a>  <span class="at">include.fstatistic =</span> <span class="cn">FALSE</span>,</span>
<span id="cb23-524"><a href="#cb23-524" aria-hidden="true" tabindex="-1"></a>  <span class="at">include.rmse =</span> <span class="cn">FALSE</span>,</span>
<span id="cb23-525"><a href="#cb23-525" aria-hidden="true" tabindex="-1"></a>  <span class="at">custom.gof.rows =</span> <span class="fu">list</span>(<span class="st">'Num. obs.'</span> <span class="ot">=</span> n.l, </span>
<span id="cb23-526"><a href="#cb23-526" aria-hidden="true" tabindex="-1"></a>                         <span class="st">'AIC'</span> <span class="ot">=</span> aic.l), </span>
<span id="cb23-527"><a href="#cb23-527" aria-hidden="true" tabindex="-1"></a>  <span class="at">reorder.gof =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>, <span class="dv">2</span>))</span>
<span id="cb23-528"><a href="#cb23-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-529"><a href="#cb23-529" aria-hidden="true" tabindex="-1"></a><span class="fu">texreg</span>(<span class="fu">list</span>(mod_1.ols, mod_1.sar, mod_1.sem, mod_1.slx.lm, mod_1.sdm, mod_1.sdem),</span>
<span id="cb23-530"><a href="#cb23-530" aria-hidden="true" tabindex="-1"></a>        <span class="at">file =</span> <span class="st">"fig/Regression.tex"</span>,</span>
<span id="cb23-531"><a href="#cb23-531" aria-hidden="true" tabindex="-1"></a>          <span class="at">custom.coef.map =</span> <span class="fu">list</span>(<span class="st">'(Intercept)'</span> <span class="ot">=</span>  <span class="st">'(Intercept)'</span>,</span>
<span id="cb23-532"><a href="#cb23-532" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">'park_kmsq'</span> <span class="ot">=</span>  <span class="st">'Green space'</span>,</span>
<span id="cb23-533"><a href="#cb23-533" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">'pt_access_index'</span> <span class="ot">=</span>  <span class="st">'Public transport access'</span>,</span>
<span id="cb23-534"><a href="#cb23-534" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">'POPDEN'</span> <span class="ot">=</span>  <span class="st">'Population density'</span>,</span>
<span id="cb23-535"><a href="#cb23-535" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">'per_nonUK'</span> <span class="ot">=</span>  <span class="st">'Percent non-UK'</span>,</span>
<span id="cb23-536"><a href="#cb23-536" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">'per_social'</span> <span class="ot">=</span> <span class="st">'Percent social housing'</span>,</span>
<span id="cb23-537"><a href="#cb23-537" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">'lag.park_kmsq'</span> <span class="ot">=</span>  <span class="st">'W Green space'</span>,</span>
<span id="cb23-538"><a href="#cb23-538" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">'lag.pt_access_index'</span> <span class="ot">=</span>  <span class="st">'W Public transport access'</span>,</span>
<span id="cb23-539"><a href="#cb23-539" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">'lag.POPDEN'</span> <span class="ot">=</span>  <span class="st">'W Population density'</span>,</span>
<span id="cb23-540"><a href="#cb23-540" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">'lag.per_nonUK'</span> <span class="ot">=</span>  <span class="st">'W Percent non-UK'</span>,</span>
<span id="cb23-541"><a href="#cb23-541" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">'lag.per_social'</span> <span class="ot">=</span> <span class="st">'W Percent social housing'</span>,</span>
<span id="cb23-542"><a href="#cb23-542" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">'rho'</span> <span class="ot">=</span> <span class="st">'rho'</span>,</span>
<span id="cb23-543"><a href="#cb23-543" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">'lambda'</span> <span class="ot">=</span> <span class="st">'lambda'</span>),</span>
<span id="cb23-544"><a href="#cb23-544" aria-hidden="true" tabindex="-1"></a>          <span class="at">custom.model.names =</span> <span class="fu">c</span>(<span class="st">"OLS"</span>, <span class="st">"SAR"</span>, <span class="st">"SEM"</span>, <span class="st">"SLX"</span>, <span class="st">"SDM"</span>, <span class="st">"SDEM"</span>),</span>
<span id="cb23-545"><a href="#cb23-545" aria-hidden="true" tabindex="-1"></a>          <span class="at">dcolumn =</span> <span class="cn">TRUE</span>, <span class="at">caption.above =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">3</span>, <span class="at">use.packages =</span> <span class="cn">FALSE</span>,</span>
<span id="cb23-546"><a href="#cb23-546" aria-hidden="true" tabindex="-1"></a>          <span class="at">caption =</span> <span class="st">"Spatial regression models. Outcome variable: median house price."</span>,</span>
<span id="cb23-547"><a href="#cb23-547" aria-hidden="true" tabindex="-1"></a>          <span class="at">include.nobs =</span> <span class="cn">FALSE</span>, <span class="at">fontsize =</span> <span class="st">"scriptsize"</span>,</span>
<span id="cb23-548"><a href="#cb23-548" aria-hidden="true" tabindex="-1"></a>  <span class="at">include.loglik =</span> <span class="cn">FALSE</span>,</span>
<span id="cb23-549"><a href="#cb23-549" aria-hidden="true" tabindex="-1"></a>  <span class="at">include.aic =</span> <span class="cn">FALSE</span>,</span>
<span id="cb23-550"><a href="#cb23-550" aria-hidden="true" tabindex="-1"></a>  <span class="at">include.lr =</span> <span class="cn">TRUE</span>,</span>
<span id="cb23-551"><a href="#cb23-551" aria-hidden="true" tabindex="-1"></a>  <span class="at">include.wald =</span> <span class="cn">FALSE</span>,</span>
<span id="cb23-552"><a href="#cb23-552" aria-hidden="true" tabindex="-1"></a>  <span class="at">include.fstatistic =</span> <span class="cn">FALSE</span>,</span>
<span id="cb23-553"><a href="#cb23-553" aria-hidden="true" tabindex="-1"></a>  <span class="at">include.rmse =</span> <span class="cn">FALSE</span>,</span>
<span id="cb23-554"><a href="#cb23-554" aria-hidden="true" tabindex="-1"></a>  <span class="at">custom.gof.rows =</span> <span class="fu">list</span>(<span class="st">'Num. obs.'</span> <span class="ot">=</span> n.l, </span>
<span id="cb23-555"><a href="#cb23-555" aria-hidden="true" tabindex="-1"></a>                         <span class="st">'AIC'</span> <span class="ot">=</span> aic.l), </span>
<span id="cb23-556"><a href="#cb23-556" aria-hidden="true" tabindex="-1"></a>  <span class="at">reorder.gof =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>, <span class="dv">2</span>))</span>
<span id="cb23-557"><a href="#cb23-557" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb23-558"><a href="#cb23-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-559"><a href="#cb23-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-560"><a href="#cb23-560" aria-hidden="true" tabindex="-1"></a>::: {.content-hidden unless-format="html"}</span>
<span id="cb23-561"><a href="#cb23-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-564"><a href="#cb23-564" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb23-565"><a href="#cb23-565" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-results</span></span>
<span id="cb23-566"><a href="#cb23-566" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Regression Coefficients Dependent variable: Median house prices."</span></span>
<span id="cb23-567"><a href="#cb23-567" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb23-568"><a href="#cb23-568" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: asis</span></span>
<span id="cb23-569"><a href="#cb23-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-570"><a href="#cb23-570" aria-hidden="true" tabindex="-1"></a><span class="fu">knitreg</span>(<span class="fu">list</span>(mod_1.ols, mod_1.sar, mod_1.sem, mod_1.slx.lm, mod_1.sdm, mod_1.sdem),</span>
<span id="cb23-571"><a href="#cb23-571" aria-hidden="true" tabindex="-1"></a>          <span class="at">custom.coef.map =</span> <span class="fu">list</span>(<span class="st">'(Intercept)'</span> <span class="ot">=</span>  <span class="st">'(Intercept)'</span>,</span>
<span id="cb23-572"><a href="#cb23-572" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">'park_kmsq'</span> <span class="ot">=</span>  <span class="st">'Green space'</span>,</span>
<span id="cb23-573"><a href="#cb23-573" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">'pt_access_index'</span> <span class="ot">=</span>  <span class="st">'Public transport access'</span>,</span>
<span id="cb23-574"><a href="#cb23-574" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">'POPDEN'</span> <span class="ot">=</span>  <span class="st">'Population density'</span>,</span>
<span id="cb23-575"><a href="#cb23-575" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">'per_nonUK'</span> <span class="ot">=</span>  <span class="st">'Percent non-UK'</span>,</span>
<span id="cb23-576"><a href="#cb23-576" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">'per_social'</span> <span class="ot">=</span> <span class="st">'Percent social housing'</span>,</span>
<span id="cb23-577"><a href="#cb23-577" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">'lag.park_kmsq'</span> <span class="ot">=</span>  <span class="st">'W Green space'</span>,</span>
<span id="cb23-578"><a href="#cb23-578" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">'lag.pt_access_index'</span> <span class="ot">=</span>  <span class="st">'W Public transport access'</span>,</span>
<span id="cb23-579"><a href="#cb23-579" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">'lag.POPDEN'</span> <span class="ot">=</span>  <span class="st">'W Population density'</span>,</span>
<span id="cb23-580"><a href="#cb23-580" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">'lag.per_nonUK'</span> <span class="ot">=</span>  <span class="st">'W Percent non-UK'</span>,</span>
<span id="cb23-581"><a href="#cb23-581" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">'lag.per_social'</span> <span class="ot">=</span> <span class="st">'W Percent social housing'</span>,</span>
<span id="cb23-582"><a href="#cb23-582" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">'rho'</span> <span class="ot">=</span> <span class="st">'rho'</span>,</span>
<span id="cb23-583"><a href="#cb23-583" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">'lambda'</span> <span class="ot">=</span> <span class="st">'lambda'</span>),</span>
<span id="cb23-584"><a href="#cb23-584" aria-hidden="true" tabindex="-1"></a>          <span class="at">custom.model.names =</span> <span class="fu">c</span>(<span class="st">"OLS"</span>, <span class="st">"SAR"</span>, <span class="st">"SEM"</span>, <span class="st">"SLX"</span>, <span class="st">"SDM"</span>, <span class="st">"SDEM"</span>),</span>
<span id="cb23-585"><a href="#cb23-585" aria-hidden="true" tabindex="-1"></a>          <span class="at">dcolumn =</span> <span class="cn">TRUE</span>, <span class="at">caption.above =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">3</span>, <span class="at">use.packages =</span> <span class="cn">FALSE</span>,</span>
<span id="cb23-586"><a href="#cb23-586" aria-hidden="true" tabindex="-1"></a>          <span class="at">caption =</span> <span class="st">"Spatial regression models. Outcome variable: median house price."</span>,</span>
<span id="cb23-587"><a href="#cb23-587" aria-hidden="true" tabindex="-1"></a>          <span class="at">include.nobs =</span> <span class="cn">FALSE</span>, <span class="at">fontsize =</span> <span class="st">"scriptsize"</span>,</span>
<span id="cb23-588"><a href="#cb23-588" aria-hidden="true" tabindex="-1"></a>  <span class="at">include.loglik =</span> <span class="cn">FALSE</span>,</span>
<span id="cb23-589"><a href="#cb23-589" aria-hidden="true" tabindex="-1"></a>  <span class="at">include.aic =</span> <span class="cn">FALSE</span>,</span>
<span id="cb23-590"><a href="#cb23-590" aria-hidden="true" tabindex="-1"></a>  <span class="at">include.lr =</span> <span class="cn">TRUE</span>,</span>
<span id="cb23-591"><a href="#cb23-591" aria-hidden="true" tabindex="-1"></a>  <span class="at">include.wald =</span> <span class="cn">FALSE</span>,</span>
<span id="cb23-592"><a href="#cb23-592" aria-hidden="true" tabindex="-1"></a>  <span class="at">include.fstatistic =</span> <span class="cn">FALSE</span>,</span>
<span id="cb23-593"><a href="#cb23-593" aria-hidden="true" tabindex="-1"></a>  <span class="at">include.rmse =</span> <span class="cn">FALSE</span>,</span>
<span id="cb23-594"><a href="#cb23-594" aria-hidden="true" tabindex="-1"></a>  <span class="at">custom.gof.rows =</span> <span class="fu">list</span>(<span class="st">'Num. obs.'</span> <span class="ot">=</span> n.l, </span>
<span id="cb23-595"><a href="#cb23-595" aria-hidden="true" tabindex="-1"></a>                         <span class="st">'AIC'</span> <span class="ot">=</span> aic.l), </span>
<span id="cb23-596"><a href="#cb23-596" aria-hidden="true" tabindex="-1"></a>  <span class="at">reorder.gof =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>, <span class="dv">2</span>))</span>
<span id="cb23-597"><a href="#cb23-597" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb23-598"><a href="#cb23-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-599"><a href="#cb23-599" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb23-600"><a href="#cb23-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-601"><a href="#cb23-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-602"><a href="#cb23-602" aria-hidden="true" tabindex="-1"></a>::: {.content-hidden unless-format="pdf"}</span>
<span id="cb23-603"><a href="#cb23-603" aria-hidden="true" tabindex="-1"></a><span class="in">```{=latex}</span></span>
<span id="cb23-604"><a href="#cb23-604" aria-hidden="true" tabindex="-1"></a><span class="in">\input{fig/Regression.tex}</span></span>
<span id="cb23-605"><a href="#cb23-605" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb23-606"><a href="#cb23-606" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb23-607"><a href="#cb23-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-608"><a href="#cb23-608" aria-hidden="true" tabindex="-1"></a>Compared to results from conventional non-spatial models, Table 1 comes with several additions: First, variables starting with a "W" (or "lag") indicate the spatially lagged variable or in the case of row-normalized weights matrices the average value of the respective variable across the local neighbours. Moreover, there are two auto-regressive parameters: "rho" for the estimated auto-correlation in the dependent variable and "lambda" for the estimated auto-correlation in the error term. In case of the SAR, a highly significant $\hat\rho$ coefficient of <span class="in">`r round(mod_1.sar$rho, 3)`</span> indicates strong positive spatial auto-correlation in the median house price: the house price in adjacent areas positively impacts the focal house prices. A $\hat\lambda$ of <span class="in">`r round(mod_1.sem$lambda, 3)`</span> in the SEM however indicates that there is very strong spatial auto-correlation among the (remaining) error variance. The likelihood ratio test in the goodness-of-fit statistics are highly significant in both cases, rejecting the NULL of no spatial auto-autocorrelation.</span>
<span id="cb23-609"><a href="#cb23-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-610"><a href="#cb23-610" aria-hidden="true" tabindex="-1"></a>Given the strong positive auto-correlation in the dependent variable in SAR and SDM, we cannot directly interpret the coefficients as marginal effects. Similar to auto-regressive temporal models, we need to account for the spatial multiplier effect. For SEM, SLX and SDEM, we could directly interpret the coefficients of Table 1. However, we plot the impacts of all five models in Figure @fig-coefs for reasons of comparison. Note that SEM only has direct and no indirect impacts.</span>
<span id="cb23-611"><a href="#cb23-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-614"><a href="#cb23-614" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb23-615"><a href="#cb23-615" aria-hidden="true" tabindex="-1"></a><span class="co"># Get direct and indirect impacts</span></span>
<span id="cb23-616"><a href="#cb23-616" aria-hidden="true" tabindex="-1"></a>mod.l <span class="ot">&lt;-</span> <span class="fu">list</span>(mod_1.sar, mod_1.slx, mod_1.sdm, mod_1.sdem)</span>
<span id="cb23-617"><a href="#cb23-617" aria-hidden="true" tabindex="-1"></a>imp.l <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">"list"</span>, <span class="at">length =</span> <span class="fu">length</span>(mod.l))</span>
<span id="cb23-618"><a href="#cb23-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-619"><a href="#cb23-619" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(mod.l)){</span>
<span id="cb23-620"><a href="#cb23-620" aria-hidden="true" tabindex="-1"></a>  imp.l[[i]] <span class="ot">&lt;-</span> spatialreg<span class="sc">::</span><span class="fu">impacts</span>(mod.l[[i]], <span class="at">listw =</span> queens.lw, <span class="at">R =</span> <span class="dv">600</span>)</span>
<span id="cb23-621"><a href="#cb23-621" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-622"><a href="#cb23-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-623"><a href="#cb23-623" aria-hidden="true" tabindex="-1"></a><span class="co"># Add SEM</span></span>
<span id="cb23-624"><a href="#cb23-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-625"><a href="#cb23-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-626"><a href="#cb23-626" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract summary measures</span></span>
<span id="cb23-627"><a href="#cb23-627" aria-hidden="true" tabindex="-1"></a>extract.imp <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb23-628"><a href="#cb23-628" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="fu">summary</span>(x, <span class="at">zstats =</span> <span class="cn">TRUE</span>, <span class="at">short =</span> <span class="cn">TRUE</span>)</span>
<span id="cb23-629"><a href="#cb23-629" aria-hidden="true" tabindex="-1"></a>  names <span class="ot">&lt;-</span> <span class="fu">attr</span>(x, <span class="st">"bnames"</span>)</span>
<span id="cb23-630"><a href="#cb23-630" aria-hidden="true" tabindex="-1"></a>  l <span class="ot">&lt;-</span> <span class="fu">length</span>(names)</span>
<span id="cb23-631"><a href="#cb23-631" aria-hidden="true" tabindex="-1"></a>  effs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Direct"</span>, <span class="st">"Indirect"</span>, <span class="st">"Total"</span>)</span>
<span id="cb23-632"><a href="#cb23-632" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">attr</span>(x, <span class="st">"type"</span>) <span class="sc">==</span> <span class="st">"lag"</span> <span class="sc">|</span> <span class="fu">attr</span>(x, <span class="st">"type"</span>) <span class="sc">==</span> <span class="st">"mixed"</span>){</span>
<span id="cb23-633"><a href="#cb23-633" aria-hidden="true" tabindex="-1"></a>    coefs <span class="ot">=</span> <span class="fu">c</span>(s<span class="sc">$</span>res<span class="sc">$</span>direct, s<span class="sc">$</span>res<span class="sc">$</span>indirect, s<span class="sc">$</span>res<span class="sc">$</span>total)</span>
<span id="cb23-634"><a href="#cb23-634" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb23-635"><a href="#cb23-635" aria-hidden="true" tabindex="-1"></a>    coefs <span class="ot">=</span> <span class="fu">c</span>(s<span class="sc">$</span>impacts<span class="sc">$</span>direct, s<span class="sc">$</span>impacts<span class="sc">$</span>indirect, s<span class="sc">$</span>impacts<span class="sc">$</span>total)</span>
<span id="cb23-636"><a href="#cb23-636" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb23-637"><a href="#cb23-637" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span>  <span class="fu">data.frame</span>(<span class="at">var =</span> <span class="fu">rep</span>(names, <span class="dv">3</span>), </span>
<span id="cb23-638"><a href="#cb23-638" aria-hidden="true" tabindex="-1"></a>                    <span class="at">eff =</span> <span class="fu">rep</span>(effs, <span class="at">each =</span> l),</span>
<span id="cb23-639"><a href="#cb23-639" aria-hidden="true" tabindex="-1"></a>                    <span class="at">coef =</span> coefs,</span>
<span id="cb23-640"><a href="#cb23-640" aria-hidden="true" tabindex="-1"></a>                    <span class="at">se =</span> <span class="fu">c</span>(s<span class="sc">$</span>semat[, <span class="dv">1</span>], s<span class="sc">$</span>semat[, <span class="dv">2</span>], s<span class="sc">$</span>semat[, <span class="dv">3</span>]),</span>
<span id="cb23-641"><a href="#cb23-641" aria-hidden="true" tabindex="-1"></a>                    <span class="at">pval =</span> <span class="fu">c</span>(s<span class="sc">$</span>pzmat[, <span class="dv">1</span>], s<span class="sc">$</span>pzmat[, <span class="dv">2</span>], s<span class="sc">$</span>pzmat[, <span class="dv">3</span>])</span>
<span id="cb23-642"><a href="#cb23-642" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb23-643"><a href="#cb23-643" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-644"><a href="#cb23-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-645"><a href="#cb23-645" aria-hidden="true" tabindex="-1"></a>mods <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"SAR"</span>, <span class="st">"SLX"</span>, <span class="st">"SDM"</span>, <span class="st">"SDEM"</span>)</span>
<span id="cb23-646"><a href="#cb23-646" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(imp.l)){</span>
<span id="cb23-647"><a href="#cb23-647" aria-hidden="true" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> <span class="fu">extract.imp</span>(imp.l[[i]])</span>
<span id="cb23-648"><a href="#cb23-648" aria-hidden="true" tabindex="-1"></a>  tmp<span class="sc">$</span>mod <span class="ot">&lt;-</span> mods[i]</span>
<span id="cb23-649"><a href="#cb23-649" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(i <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb23-650"><a href="#cb23-650" aria-hidden="true" tabindex="-1"></a>    imp.res <span class="ot">&lt;-</span> tmp</span>
<span id="cb23-651"><a href="#cb23-651" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb23-652"><a href="#cb23-652" aria-hidden="true" tabindex="-1"></a>    imp.res <span class="ot">&lt;-</span> <span class="fu">rbind</span>(imp.res, tmp)</span>
<span id="cb23-653"><a href="#cb23-653" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb23-654"><a href="#cb23-654" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-655"><a href="#cb23-655" aria-hidden="true" tabindex="-1"></a>} </span>
<span id="cb23-656"><a href="#cb23-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-657"><a href="#cb23-657" aria-hidden="true" tabindex="-1"></a><span class="co"># Add SEM</span></span>
<span id="cb23-658"><a href="#cb23-658" aria-hidden="true" tabindex="-1"></a>sem.coefs <span class="ot">&lt;-</span> <span class="fu">summary</span>(mod_1.sem)<span class="sc">$</span>Coef[,<span class="sc">-</span><span class="dv">3</span>]</span>
<span id="cb23-659"><a href="#cb23-659" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(sem.coefs) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"coef"</span>, <span class="st">"se"</span>, <span class="st">"pval"</span>)</span>
<span id="cb23-660"><a href="#cb23-660" aria-hidden="true" tabindex="-1"></a>sem.df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">var =</span> <span class="fu">rownames</span>(sem.coefs),</span>
<span id="cb23-661"><a href="#cb23-661" aria-hidden="true" tabindex="-1"></a>                     <span class="at">eff =</span> <span class="st">"Direct"</span>,</span>
<span id="cb23-662"><a href="#cb23-662" aria-hidden="true" tabindex="-1"></a>                     sem.coefs,</span>
<span id="cb23-663"><a href="#cb23-663" aria-hidden="true" tabindex="-1"></a>                     <span class="at">mod =</span> <span class="st">"SEM"</span>)</span>
<span id="cb23-664"><a href="#cb23-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-665"><a href="#cb23-665" aria-hidden="true" tabindex="-1"></a>imp.res <span class="ot">&lt;-</span> <span class="fu">rbind</span>(imp.res, sem.df[<span class="sc">-</span><span class="dv">1</span>, ])</span>
<span id="cb23-666"><a href="#cb23-666" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb23-667"><a href="#cb23-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-670"><a href="#cb23-670" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb23-671"><a href="#cb23-671" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot the effects</span></span>
<span id="cb23-672"><a href="#cb23-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-673"><a href="#cb23-673" aria-hidden="true" tabindex="-1"></a><span class="co"># Coef Labels</span></span>
<span id="cb23-674"><a href="#cb23-674" aria-hidden="true" tabindex="-1"></a>imp.res<span class="sc">$</span>lab <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, <span class="fu">round</span>(imp.res<span class="sc">$</span>coef, <span class="dv">3</span>)))</span>
<span id="cb23-675"><a href="#cb23-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-676"><a href="#cb23-676" aria-hidden="true" tabindex="-1"></a><span class="co"># # Add stars</span></span>
<span id="cb23-677"><a href="#cb23-677" aria-hidden="true" tabindex="-1"></a><span class="co"># imp.res$lab[imp.res$pval &lt;= 0.1 &amp; imp.res$pval &gt; 0.05] &lt;- paste0(imp.res$lab[imp.res$pval &lt;= 0.1 &amp; imp.res$pval &gt; 0.05], expression("\u2020"))</span></span>
<span id="cb23-678"><a href="#cb23-678" aria-hidden="true" tabindex="-1"></a><span class="co"># imp.res$lab[imp.res$pval &lt;= 0.05 &amp; imp.res$pval &gt; 0.01] &lt;- paste0(imp.res$lab[imp.res$pval &lt;= 0.05 &amp; imp.res$pval &gt; 0.01], "*")</span></span>
<span id="cb23-679"><a href="#cb23-679" aria-hidden="true" tabindex="-1"></a><span class="co"># imp.res$lab[imp.res$pval &lt;= 0.01 &amp; imp.res$pval &gt; 0.001] &lt;- paste0(imp.res$lab[imp.res$pval &lt;= 0.01 &amp; imp.res$pval &gt; 0.001], "**")</span></span>
<span id="cb23-680"><a href="#cb23-680" aria-hidden="true" tabindex="-1"></a><span class="co"># imp.res$lab[imp.res$pval &lt;= 0.001] &lt;- paste0(imp.res$lab[imp.res$pval &lt;= 0.001], "***")</span></span>
<span id="cb23-681"><a href="#cb23-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-682"><a href="#cb23-682" aria-hidden="true" tabindex="-1"></a><span class="co"># # Get rid of leading zero</span></span>
<span id="cb23-683"><a href="#cb23-683" aria-hidden="true" tabindex="-1"></a><span class="co"># imp.res$lab &lt;- gsub("0\\.", " \\.", imp.res$lab)</span></span>
<span id="cb23-684"><a href="#cb23-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-685"><a href="#cb23-685" aria-hidden="true" tabindex="-1"></a><span class="co"># Confidence intervals</span></span>
<span id="cb23-686"><a href="#cb23-686" aria-hidden="true" tabindex="-1"></a>interval2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">qnorm</span>((<span class="dv">1</span><span class="fl">-0.95</span>)<span class="sc">/</span><span class="dv">2</span>)  <span class="co"># 95% multiplier</span></span>
<span id="cb23-687"><a href="#cb23-687" aria-hidden="true" tabindex="-1"></a>imp.res<span class="sc">$</span>lb <span class="ot">&lt;-</span> imp.res<span class="sc">$</span>coef <span class="sc">-</span> imp.res<span class="sc">$</span>se <span class="sc">*</span> interval2</span>
<span id="cb23-688"><a href="#cb23-688" aria-hidden="true" tabindex="-1"></a>imp.res<span class="sc">$</span>ub <span class="ot">&lt;-</span> imp.res<span class="sc">$</span>coef <span class="sc">+</span> imp.res<span class="sc">$</span>se <span class="sc">*</span> interval2</span>
<span id="cb23-689"><a href="#cb23-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-690"><a href="#cb23-690" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename variables</span></span>
<span id="cb23-691"><a href="#cb23-691" aria-hidden="true" tabindex="-1"></a>names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">'park_kmsq'</span> <span class="ot">=</span>  <span class="st">'Green space'</span>,</span>
<span id="cb23-692"><a href="#cb23-692" aria-hidden="true" tabindex="-1"></a>               <span class="st">'pt_access_index'</span> <span class="ot">=</span>  <span class="st">'Public transport access'</span>,</span>
<span id="cb23-693"><a href="#cb23-693" aria-hidden="true" tabindex="-1"></a>               <span class="st">'POPDEN'</span> <span class="ot">=</span>  <span class="st">'Population density'</span>,</span>
<span id="cb23-694"><a href="#cb23-694" aria-hidden="true" tabindex="-1"></a>               <span class="st">'per_nonUK'</span> <span class="ot">=</span>  <span class="st">'Percent non-UK'</span>,</span>
<span id="cb23-695"><a href="#cb23-695" aria-hidden="true" tabindex="-1"></a>               <span class="st">'per_social'</span> <span class="ot">=</span> <span class="st">'Percent social housing'</span>)</span>
<span id="cb23-696"><a href="#cb23-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-697"><a href="#cb23-697" aria-hidden="true" tabindex="-1"></a>imp.res<span class="sc">$</span>var <span class="ot">&lt;-</span> <span class="fu">factor</span>(imp.res<span class="sc">$</span>var, <span class="at">levels =</span> <span class="fu">rev</span>(<span class="fu">names</span>(names)), <span class="at">labels =</span> <span class="fu">rev</span>(names))</span>
<span id="cb23-698"><a href="#cb23-698" aria-hidden="true" tabindex="-1"></a>imp.res<span class="sc">$</span>mod <span class="ot">&lt;-</span> <span class="fu">factor</span>(imp.res<span class="sc">$</span>mod, <span class="at">levels =</span> <span class="fu">rev</span>(<span class="fu">c</span>(<span class="st">"SAR"</span>, <span class="st">"SEM"</span>, <span class="st">"SLX"</span>, <span class="st">"SDM"</span>, <span class="st">"SDEM"</span>)))</span>
<span id="cb23-699"><a href="#cb23-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-700"><a href="#cb23-700" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb23-701"><a href="#cb23-701" aria-hidden="true" tabindex="-1"></a>zp_all <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(imp.res[imp.res<span class="sc">$</span>eff <span class="sc">!=</span> <span class="st">"Total"</span>, ], <span class="fu">aes</span>(<span class="at">colour =</span> mod, <span class="at">shape =</span> mod, <span class="at">fill =</span> mod)) <span class="sc">+</span></span>
<span id="cb23-702"><a href="#cb23-702" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> eff, <span class="at">scales =</span> <span class="st">"free_x"</span>) <span class="sc">+</span></span>
<span id="cb23-703"><a href="#cb23-703" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">colour =</span> scales<span class="sc">::</span><span class="fu">alpha</span>(<span class="st">"black"</span>, <span class="fl">0.3</span>), <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb23-704"><a href="#cb23-704" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">x =</span> var, <span class="at">y =</span> coef, <span class="at">ymin =</span> lb, <span class="at">ymax =</span> ub),</span>
<span id="cb23-705"><a href="#cb23-705" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">lwd =</span> <span class="fl">0.7</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="dv">1</span><span class="sc">/</span><span class="fl">1.4</span>),</span>
<span id="cb23-706"><a href="#cb23-706" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">fill =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb23-707"><a href="#cb23-707" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> lab,</span>
<span id="cb23-708"><a href="#cb23-708" aria-hidden="true" tabindex="-1"></a>                <span class="at">x =</span> var, </span>
<span id="cb23-709"><a href="#cb23-709" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> coef), </span>
<span id="cb23-710"><a href="#cb23-710" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">3.0</span>, <span class="at">show.legend  =</span> <span class="cn">FALSE</span>, </span>
<span id="cb23-711"><a href="#cb23-711" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.35</span>, <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.035</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="dv">1</span><span class="sc">/</span><span class="fl">1.4</span>)) <span class="sc">+</span></span>
<span id="cb23-712"><a href="#cb23-712" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb23-713"><a href="#cb23-713" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.1</span>) ) <span class="sc">+</span></span>
<span id="cb23-714"><a href="#cb23-714" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb23-715"><a href="#cb23-715" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Impacts on house price"</span>, <span class="at">x =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb23-716"><a href="#cb23-716" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">rev</span>(<span class="fu">c</span>(<span class="dv">18</span>, <span class="dv">19</span>, <span class="dv">17</span>, <span class="dv">15</span>, <span class="dv">25</span>))) <span class="sc">+</span></span>
<span id="cb23-717"><a href="#cb23-717" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb23-718"><a href="#cb23-718" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb23-719"><a href="#cb23-719" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb23-720"><a href="#cb23-720" aria-hidden="true" tabindex="-1"></a>                         <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb23-721"><a href="#cb23-721" aria-hidden="true" tabindex="-1"></a>                         <span class="at">legend.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb23-722"><a href="#cb23-722" aria-hidden="true" tabindex="-1"></a>                         <span class="at">legend.box.background =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>),</span>
<span id="cb23-723"><a href="#cb23-723" aria-hidden="true" tabindex="-1"></a>                         <span class="at">legend.key =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb23-724"><a href="#cb23-724" aria-hidden="true" tabindex="-1"></a>                         <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb23-725"><a href="#cb23-725" aria-hidden="true" tabindex="-1"></a>                         <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">"black"</span>),</span>
<span id="cb23-726"><a href="#cb23-726" aria-hidden="true" tabindex="-1"></a>                         <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">"black"</span>),</span>
<span id="cb23-727"><a href="#cb23-727" aria-hidden="true" tabindex="-1"></a>                         <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb23-728"><a href="#cb23-728" aria-hidden="true" tabindex="-1"></a>                         <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>, <span class="at">colour =</span> <span class="st">"black"</span>),</span>
<span id="cb23-729"><a href="#cb23-729" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb23-730"><a href="#cb23-730" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb23-731"><a href="#cb23-731" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="dv">0</span>), <span class="at">reverse =</span> T),</span>
<span id="cb23-732"><a href="#cb23-732" aria-hidden="true" tabindex="-1"></a>                          <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> T))</span>
<span id="cb23-733"><a href="#cb23-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-734"><a href="#cb23-734" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb23-735"><a href="#cb23-735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-736"><a href="#cb23-736" aria-hidden="true" tabindex="-1"></a><span class="in">```{r message = FALSE, warning = FALSE, results = 'hide'}</span></span>
<span id="cb23-737"><a href="#cb23-737" aria-hidden="true" tabindex="-1"></a><span class="fu">cairo_ps</span>(<span class="at">file =</span> <span class="fu">paste</span>(<span class="st">"fig/"</span>, <span class="st">"Coefplot.eps"</span>, <span class="at">sep=</span><span class="st">""</span>), <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">6</span>, </span>
<span id="cb23-738"><a href="#cb23-738" aria-hidden="true" tabindex="-1"></a>          <span class="at">bg =</span> <span class="st">"white"</span>, <span class="at">family =</span> <span class="st">"Times New Roman"</span>)</span>
<span id="cb23-739"><a href="#cb23-739" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb23-740"><a href="#cb23-740" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb23-741"><a href="#cb23-741" aria-hidden="true" tabindex="-1"></a>zp_all</span>
<span id="cb23-742"><a href="#cb23-742" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb23-743"><a href="#cb23-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-744"><a href="#cb23-744" aria-hidden="true" tabindex="-1"></a><span class="fu">jpeg</span>(<span class="at">file =</span> <span class="fu">paste</span>(<span class="st">"fig/"</span>, <span class="st">"Coefplot.jpeg"</span>, <span class="at">sep=</span><span class="st">""</span>), <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">6</span>, </span>
<span id="cb23-745"><a href="#cb23-745" aria-hidden="true" tabindex="-1"></a>    <span class="at">units =</span> <span class="st">"in"</span>, <span class="at">res =</span> <span class="dv">300</span>, <span class="at">type =</span> <span class="st">"cairo"</span>,</span>
<span id="cb23-746"><a href="#cb23-746" aria-hidden="true" tabindex="-1"></a>          <span class="at">bg =</span> <span class="st">"white"</span>, <span class="at">family =</span> <span class="st">"Times New Roman"</span>)</span>
<span id="cb23-747"><a href="#cb23-747" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb23-748"><a href="#cb23-748" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb23-749"><a href="#cb23-749" aria-hidden="true" tabindex="-1"></a>zp_all</span>
<span id="cb23-750"><a href="#cb23-750" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb23-751"><a href="#cb23-751" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb23-752"><a href="#cb23-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-753"><a href="#cb23-753" aria-hidden="true" tabindex="-1"></a><span class="al">![Direct and indirect impacts from spatial regression models. Dependent variable: mean house prices. All vairables are standardised.](fig/Coefplot.jpeg)</span>{#fig-coefs}</span>
<span id="cb23-754"><a href="#cb23-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-755"><a href="#cb23-755" aria-hidden="true" tabindex="-1"></a>We start with the results of the SAR model in Figure @fig-coefs. A one standard-deviation increase of green space in the focal unit is associated with a <span class="in">`r round(imp.res$coef[which(imp.res$var == "Green space" &amp; imp.res$mod == "SAR" &amp; imp.res$eff == "Direct")], 3)`</span> standard deviation increase in house prices within the same spatial unit. However, there are also highly significant diffusion processes. This increase in green space in the focal unit will also increase house prices in neighbouring units and the neighbours of these neighbours. This indirect impact will add up to a <span class="in">`r round(imp.res$coef[which(imp.res$var == "Green space" &amp; imp.res$mod == "SAR" &amp; imp.res$eff == "Indirect")], 3)`</span> standard deviation increase in house prices across neighbouring units connected through the spatial weights system. Similarly, an increase in public transport accessibility is associated with a <span class="in">`r round(imp.res$coef[which(imp.res$var == "Public transport access" &amp; imp.res$mod == "SAR" &amp; imp.res$eff == "Direct")], 3)`</span> standard-deviation higher median house price in the unit itself and an additional <span class="in">`r round(imp.res$coef[which(imp.res$var == "Green space" &amp; imp.res$mod == "SAR" &amp; imp.res$eff == "Indirect")], 3)`</span> deviation increase diffusing though the neighbouring regions. Note that direct and indirect effects are bound to a common ration, as SAR only estimates one single spatial parameter $\hat\rho$. In our case, every indirect impact equals approximately <span class="in">`r round(imp.res$coef[which(imp.res$var == "Public transport access" &amp; imp.res$mod == "SAR" &amp; imp.res$eff == "Indirect")] /imp.res$coef[which(imp.res$var == "Public transport access" &amp; imp.res$mod == "SAR" &amp; imp.res$eff == "Direct")], 2)`</span> times the direct impact. This is a very restrictive conditions and a severe drawback of the SAR model.</span>
<span id="cb23-756"><a href="#cb23-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-757"><a href="#cb23-757" aria-hidden="true" tabindex="-1"></a>The SLX - similar to SAR - estimates a positive impact of green space in the focal but also in adjacent neighbourhoods on house prices in the focal unit. A one standard deviation in the focal unit is associated with <span class="in">`r round(imp.res$coef[which(imp.res$var == "Green space" &amp; imp.res$mod == "SLX" &amp; imp.res$eff == "Direct")], 3)`</span> standard-deviations higher house price in the focal unit. If green spaces in adjacent neighbourhoods increase on average by one standard deviation, this would increase house prices in the focal unit by <span class="in">`r round(imp.res$coef[which(imp.res$var == "Green space" &amp; imp.res$mod == "SLX" &amp; imp.res$eff == "Indirect")], 3)`</span> standard deviations. Note that the SLX tells a different story about the effect of public transport access than SAR: there is a negative direct and a very strong and positive indirect effect. A one standard deviation increase in public transport access in the focal unit is associated with <span class="in">`r round(imp.res$coef[which(imp.res$var == "Public transport access" &amp; imp.res$mod == "SLX" &amp; imp.res$eff == "Direct")], 3)`</span> standard deviations lower house prices. In contrast, more public transport in the local surrounding (the average neighbours) is associated with <span class="in">`r round(imp.res$coef[which(imp.res$var == "Public transport access" &amp; imp.res$mod == "SLX" &amp; imp.res$eff == "Indirect")], 3)`</span> standard deviations higher prices. This is in line with the idea that public transport facilities are usually not particularly attractive: it is good to have them close but not too close. The same is true for population density: it is good to live in a broader area with high population density as indicated by the indirect impacts (probability indicating high centrality), but the local neighbourhood should have a low population density as indicated by the negative direct impact.</span>
<span id="cb23-758"><a href="#cb23-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-759"><a href="#cb23-759" aria-hidden="true" tabindex="-1"></a>We could go further with the other models. However, interpretation in SDM follows the same logic as SAR, and interpretation in SDEM aligns to SLX. Interpretation in SEM is analogous to non-spatial OLS, as there are no indirect impacts. Moreover, it is important to keep in mind that the indirect impacts are summary measures which sum over all impacts from or onto neighbouring regions. The indirect public transport effect of <span class="in">`r round(imp.res$coef[which(imp.res$var == "Public transport access" &amp; imp.res$mod == "SLX" &amp; imp.res$eff == "Indirect")], 3)`</span> in SLX would occur if the average public transport access across neighbours would increase by one standard deviation. This only occurs if all neighbours would simultaneously increase public transport access by one standard deviation.</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>